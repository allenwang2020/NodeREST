/*
  filename: angular.integralui.grid.min.js
  version : 3.1.5
  Copyright © 2014-2016 Lidor Systems. All rights reserved.

  This file is part of the "IntegralUI" Library. 
                                                                   
  The contents of this file are subject to the IntegralUI Studio for Web License, and may not be used except in compliance with the License.
  A copy of the License should have been installed in the product's root installation directory or it can be found at
  http://www.lidorsystems.com/products/web/studio/license-agreement.aspx.
                                                            
  This SOFTWARE is provided "AS IS", WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License for the specific language 
  governing rights and limitations under the License. Any infringement will be prosecuted under applicable laws.                           
*/
angular.module("integralui").factory("IntegralUIGridService",["$rootScope",function(c){var d=null;return{addColumn:function(l,m){c.$broadcast(l+"-add-column",m)},clearColumns:function(l){c.$broadcast(l+"-clear-columns")},insertColumnAt:function(l,m,d){c.$broadcast(l+"-insert-column-at",m,d)},insertColumnBefore:function(l,m,d){c.$broadcast(l+"-insert-column-before",m,d)},insertColumnAfter:function(l,m,d){c.$broadcast(l+"-insert-column-after",m,d)},removeColumn:function(l,m){c.$broadcast(l+"-remove-column",
m)},removeColumnAt:function(l,m){c.$broadcast(l+"-remove-column-at",m)},addRow:function(l,m){c.$broadcast(l+"-add-row",m)},clearRows:function(l){c.$broadcast(l+"-clear-rows")},insertRowAt:function(l,m,d){c.$broadcast(l+"-insert-row-at",m,d)},insertRowBefore:function(l,m,d){c.$broadcast(l+"-insert-row-before",m,d)},insertRowAfter:function(l,m,d){c.$broadcast(l+"-insert-row-after",m,d)},removeRow:function(l,m){c.$broadcast(l+"-remove-row",m)},removeRowAt:function(l,m){c.$broadcast(l+"-remove-row-at",
m)},exportToJSON:function(l,m,d,f){c.$broadcast(l+"-export-json",m,d,f);l=this.getTempData();this.clearTempData();return l?l:""},loadData:function(l,m,d){c.$broadcast(l+"-load-data",m,d)},openEditor:function(l,m){c.$broadcast(l+"-open-editor",m)},closeEditor:function(l,m){c.$broadcast(l+"-close-editor",m)},filter:function(l,m,d){c.$broadcast(l+"-filter",m,d)},findRowById:function(l,m){c.$broadcast(l+"-find-row-by-id",m);var d=this.getTempData();this.clearTempData();return d?d:null},findRowByText:function(l,
m){c.$broadcast(l+"-find-row-by-text",m);var d=this.getTempData();this.clearTempData();return d?d:null},getCellAt:function(l,m){c.$broadcast(l+"-get-cell-at",m);var d=this.getTempData();this.clearTempData();return d?d:null},getRowAt:function(l,d){c.$broadcast(l+"-get-row-at",d);var r=this.getTempData();this.clearTempData();return r?r:null},focus:function(l,d){c.$broadcast(l+"-focus",d)},clearTempData:function(){d=null},ensureVisible:function(l,d){c.$broadcast(l+"-ensure-visible",d)},getTempData:function(){return d},
getHoverColumn:function(l,d){c.$broadcast(l+"-get-hover-column",d);var r=this.getTempData();this.clearTempData();return r?r:null},getList:function(l){c.$broadcast(l+"-get-list");l=this.getTempData();this.clearTempData();return l?l:[]},setTempData:function(c){d=c},topRow:function(l,d){if(d)c.$broadcast(l+"-set-top-row",d);else return c.$broadcast(l+"-get-top-row"),d=this.getTempData(),this.clearTempData(),d?d:null},beginLoad:function(l,d){c.$broadcast(l+"-begin-load",d)},endLoad:function(l){c.$broadcast(l+
"-end-load")},moveColumn:function(l,d,r){c.$broadcast(l+"-move-column",d,r)},moveRow:function(l,d,r,f,na){c.$broadcast(l+"-move-row",d,r,f,na)},getScrollPos:function(d){c.$broadcast(d+"-get-scroll-pos");d=this.getTempData();this.clearTempData();return d?d:{x:0,y:0}},getMaxScrollPos:function(d){c.$broadcast(d+"-get-max-scroll-pos");d=this.getTempData();this.clearTempData();return d?d:{x:0,y:0}},setScrollPos:function(d,m){c.$broadcast(d+"-set-scroll-pos",m)},scrollTo:function(d,m,r){c.$broadcast(d+
"-scroll-to",m,r)},currentPage:function(d,m){if(void 0!=m&&null!=m)c.$broadcast(d+"-set-current-page",m);else{c.$broadcast(d+"-get-current-page");var r=this.getTempData();this.clearTempData();return void 0!=r?r:-1}},firstPage:function(d){c.$broadcast(d+"-first-page")},lastPage:function(d){c.$broadcast(d+"-last-page")},nextPage:function(d){c.$broadcast(d+"-next-page")},prevPage:function(d){c.$broadcast(d+"-prev-page")},clearSelection:function(d){c.$broadcast(d+"-clear-selection")},selectedColumn:function(d,
m){if(m)c.$broadcast(d+"-set-selected-column",m);else{c.$broadcast(d+"-get-selected-column");var r=this.getTempData();this.clearTempData();return r?r:null}},selectedRow:function(d,m){if(m)c.$broadcast(d+"-set-selected-row",m);else{c.$broadcast(d+"-get-selected-row");var r=this.getTempData();this.clearTempData();return r?r:null}},selectedRows:function(d,m){if(m)c.$broadcast(d+"-set-selected-rows",m);else{c.$broadcast(d+"-get-selected-rows");var r=this.getTempData();this.clearTempData();return r?r:
null}},sort:function(d,m,r,f){c.$broadcast(d+"-sort",m,r,f)},refresh:function(d,m,r){c.$broadcast(d+"-refresh",m,r)},resumeLayout:function(d,m){c.$broadcast(d+"-resume-layout",m)},suspendLayout:function(d,m){c.$broadcast(d+"-suspend-layout",m)},updateLayout:function(d,m){c.$broadcast(d+"-update-layout",m)},updateView:function(d){c.$broadcast(d+"-update-view")}}}]).controller("IntegralUIGridController",["$scope","$element","$timeout","$window","$interval","IntegralUIInternalService","IntegralUIDataService",
"IntegralUIGridService","IntegralUIDragDrop","IntegralUIFilter",function(c,d,l,m,r,f,na,g,h,fc){var a=this;this.suppressProcess=!1;this.hoverCell=this.hoverRow=this.hoverColumn=null;a.defaultCheckBoxStyle={general:"iui-checkbox",box:{general:"iui-checkbox-box",disabled:"iui-checkbox-box-disabled",checked:"iui-checkbox-checked",indeterminate:"iui-checkbox-indeterminate",unchecked:"iui-checkbox-unchecked"}};a.defaultStyle={general:"iui-grid",column:{general:{content:"iui-grid-column-cell-content",disabled:"iui-grid-column-disabled",
normal:"iui-grid-column",hovered:"iui-grid-column-hovered",selected:"iui-grid-column-selected"},header:{content:"iui-grid-column-header-cell-content",disabled:"iui-grid-column-header-disabled",normal:"iui-grid-column-header",hovered:"iui-grid-column-header-hovered",selected:"iui-grid-column-header-selected"},body:{content:"iui-grid-column-body-cell-content",disabled:"iui-grid-column-body-disabled",normal:"iui-grid-column-body",hovered:"iui-grid-column-body-hovered",selected:"iui-grid-column-body-selected"},
footer:{content:"iui-grid-column-footer-cell-content",disabled:"iui-grid-column-footer-disabled",normal:"iui-grid-column-footer",hovered:"iui-grid-column-footer-hovered",selected:"iui-grid-column-footer-selected"}},row:{general:{disabled:"iui-grid-row-disabled",focused:"iui-grid-row-focused",normal:"iui-grid-row",hovered:"iui-grid-row-hovered",selected:"iui-grid-row-selected"},checkBox:{general:"iui-checkbox",box:{general:"iui-checkbox-box",disabled:"iui-checkbox-box-disabled",checked:"iui-checkbox-checked",
indeterminate:"iui-checkbox-indeterminate",unchecked:"iui-checkbox-unchecked"}},expandBox:{general:"iui-grid-expand-box",animated:"iui-grid-expand-box-load",expanded:"iui-grid-expand-box-open",collapsed:"iui-grid-expand-box-close"},cell:{content:"iui-grid-row-cell-content",general:"iui-grid-row-cell",disabled:"iui-grid-row-cell-disabled",focused:"iui-grid-row-cell-focused",normal:"iui-grid-row-cell",hovered:"iui-grid-row-cell-hovered",selected:"iui-grid-row-cell-selected"}},cell:{content:"iui-grid-row-cell-content",
general:"iui-grid-row-cell",disabled:"iui-grid-row-cell-disabled",focused:"iui-grid-row-cell-focused",normal:"iui-grid-row-cell",hovered:"iui-grid-row-cell-hovered",selected:"iui-grid-row-cell-selected"}};this.updateGrouping=function(b){a.options.grouping=b?{enabled:f.isFieldAvailable(b.enabled,!1),showColumns:f.isFieldAvailable(b.showColumns,!1)}:{enabled:!1,showColumns:!1}};this.updatePaging=function(b){a.options.paging=b?{enabled:f.isFieldAvailable(b.enabled,!1),showControlPanel:f.isFieldAvailable(b.showControlPanel,
!0),pageSize:f.isFieldAvailable(b.pageSize,100)}:{enabled:!1,showControlPanel:!0,pageSize:100}};this.updateOptions=function(b){b?(a.options={allowAnimation:f.isFieldAvailable(b.allowAnimation,!0),allowCellFocus:f.isFieldAvailable(b.allowCellFocus,!0),allowColumnReorder:f.isFieldAvailable(b.allowColumnReorder,!1),allowDrag:f.isFieldAvailable(b.allowDrag,!1),allowDrop:f.isFieldAvailable(b.allowDrop,!0),allowFilter:f.isFieldAvailable(b.allowFilter,!1),allowFocus:f.isFieldAvailable(b.allowFocus,!0),animationSpeed:200,
autoExpand:f.isFieldAvailable(b.autoExpand,!0),controlStyle:a.defaultStyle,editorSettings:{activate:"click"},enabled:f.isFieldAvailable(b.enabled,!0),expandColIndex:f.isFieldAvailable(b.expandColIndex,void 0!=a.options.expandColIndex?a.options.expandColIndex:0),fillSpace:f.isFieldAvailable(b.fillSpace,!1),gridLines:f.isFieldAvailable(b.gridLines,"both"),hoverSelection:f.isFieldAvailable(b.hoverSelection,!1),indent:f.isFieldAvailable(b.indent,15),labelEdit:f.isFieldAvailable(b.labelEdit,!1),loadRows:[],
pathSeparator:f.isFieldAvailable(b.pathSeparator,"\\"),rowHeight:f.isFieldAvailable(b.rowHeight,-1),rtl:f.isFieldAvailable(b.rtl,!1),selectedColumn:f.isFieldAvailable(b.selectedColumn,a.options.selectedColumn?a.options.selectedColumn:null),selectedIndex:-1,selectedRow:f.isFieldAvailable(b.selectedRow,a.options.selectedRow?a.options.selectedRow:null),selectedRows:a.options.selectedRows?a.options.selectedRows:[],selectionMode:f.isFieldAvailable(b.selectionMode,"one"),showFooter:f.isFieldAvailable(b.showFooter,
!0),showHeader:f.isFieldAvailable(b.showHeader,!0),showIcons:f.isFieldAvailable(b.showIcons,!0),sorting:f.isFieldAvailable(b.sorting,"none")},a.updateGrouping(b.grouping),a.updatePaging(b.paging),a.updateDataFields(b.dataFields),a.updateControlStyle(b.controlStyle)):(a.options={allowAnimation:!0,allowCellFocus:!0,allowColumnReorder:!1,allowDrag:!1,allowDrop:!0,allowFilter:!1,allowFocus:!0,animationSpeed:200,autoExpand:!0,controlStyle:a.defaultStyle,editorSettings:{activate:"click"},enabled:!0,expandColIndex:0,
fillSpace:!1,gridLines:"both",hoverSelection:!1,indent:15,labelEdit:!1,loadRows:[],pathSeparator:"\\",rowHeight:-1,rtl:!1,selectedColumn:null,selectedIndex:-1,selectedRow:null,selectedRows:[],selectionMode:"one",showFooter:!0,showHeader:!0,showIcons:!0,sorting:"none"},a.updateGrouping(),a.updatePaging(),a.updateDataFields())};a.options={};this.updateColumnFields=function(b){a.options.columnFields=b?{allowDrag:b.allowDrag?b.allowDrag:"allowDrag",allowDrop:b.allowDrop?b.allowDrop:"allowDrop",allowFilter:b.allowFilter?
b.allowFilter:"allowFilter",allowGrouping:b.allowGrouping?b.allowGrouping:"allowGrouping",cellTemplateUrl:b.cellTemplateUrl?b.cellTemplateUrl:"cellTemplateUrl",comparer:b.comparer?b.comparer:"comparer",contentAlignment:b.contentAlignment?b.contentAlignment:"contentAlignment",contextMenu:b.contextMenu?b.contextMenu:"contextMenu",editorType:b.editorType?b.editorType:"editorType",editorSettings:b.editorSettings?b.editorSettings:"editorSettings",editorTemplate:b.editorTemplate?b.editorTemplate:"editorTemplate",
filterParams:b.filterParams?b.filterParams:"filterParams",filterTemplate:b.filterTemplate?b.filterTemplate:"filterTemplate",fixed:b.fixed?b.fixed:"fixed",fixedWidth:b.fixedWidth?b.fixedWidth:"fixedWidth",footerAlignment:b.footerAlignment?b.footerAlignment:"footerAlignment",footerContent:b.footerContent?b.footerContent:"footerContent",footerTemplate:b.footerTemplate?b.footerTemplate:"footerTemplate",footerTemplateModel:b.footerTemplateModel?b.footerTemplateModel:"footerTemplateModel",footerText:b.footerText?
b.footerText:"footerText",footerTooltip:b.footerTooltip?b.footerTooltip:"footerTooltip",groupText:b.groupText?b.groupText:"groupText",headerAlignment:b.headerAlignment?b.headerAlignment:"headerAlignment",headerContent:b.headerContent?b.headerContent:"headerContent",headerTemplate:b.headerTemplate?b.headerTemplate:"headerTemplate",headerTemplateModel:b.headerTemplateModel?b.headerTemplateModel:"headerTemplateModel",headerText:b.headerText?b.headerText:"headerText",headerTooltip:b.headerTooltip?b.headerTooltip:
"headerTooltip",icon:b.icon?b.icon:"icon",id:b.id?b.id:"id",minWidth:b.minWidth?b.minWidth:"minWidth",maxWidth:b.maxWidth?b.maxWidth:"maxWidth",style:b.style?b.style:"style",templateSettings:b.templateSettings?b.templateSettings:"templateSettings",visible:b.visible?b.visible:"visible",width:b.width?b.width:"width"}:{allowDrag:"allowDrag",allowDrop:"allowDrop",allowFilter:"allowFilter",allowGrouping:"allowGrouping",cellTemplateUrl:"cellTemplateUrl",comparer:"comparer",contentAlignment:"contentAlignment",
contextMenu:"contextMenu",editorType:"editorType",editorSettings:"editorSettings",editorTemplate:"editorTemplate",filterParams:"filterParams",filterTemplate:"filterTemplate",footerTemplateModel:"footerTemplateModel",fixed:"fixed",fixedWidth:"fixedWidth",footerAlignment:"footerAlignment",footerContent:"footerContent",footerTemplate:"footerTemplate",footerText:"footerText",footerTooltip:"footerTooltip",groupText:"groupText",headerAlignment:"headerAlignment",headerContent:"headerContent",headerTemplate:"headerTemplate",
headerTemplateModel:"headerTemplateModel",headerText:"headerText",headerTooltip:"headerTooltip",icon:"icon",id:"id",minWidth:"minWidth",maxWidth:"maxWidth",style:"style",templateSettings:"templateSettings",visible:"visible",width:"width"};a.columnsObj&&a.columnsObj.updateDataFields(a.options.columnFields)};this.updateRowFields=function(b){a.options.rowFields=b?{allowDrag:b.allowDrag?b.allowDrag:"allowDrag",allowDrop:b.allowDrop?b.allowDrop:"allowDrop",allowFocus:b.allowFocus?b.allowFocus:"allowFocus",
cells:b.cells?b.cells:"cells",content:b.content?b.content:"content",contextMenu:b.contextMenu?b.contextMenu:"contextMenu",enabled:b.enabled?b.enabled:"enabled",expanded:b.expanded?b.expanded:"expanded",hasChildren:b.hasChildren?b.hasChildren:"hasChildren",icon:b.icon?b.icon:"icon",id:b.id?b.id:"id",objects:b.rows?b.rows:"rows",pid:b.pid?b.pid:"pid",rows:b.rows?b.rows:"rows",statusIcon:b.statusIcon?b.statusIcon:"statusIcon",style:b.style?b.style:"style",subobjects:b.cells?b.cells:"cells",text:b.text?
b.text:"text",tooltip:b.tooltip?b.tooltip:"tooltip"}:{allowDrag:"allowDrag",allowDrop:"allowDrop",allowFocus:"allowFocus",cells:"cells",content:"content",contextMenu:"contextMenu",enabled:"enabled",expanded:"expanded",hasChildren:"hasChildren",icon:"icon",id:"id",objects:"rows",pid:"pid",rows:"rows",statusIcon:"statusIcon",style:"style",subobjects:"cells",text:"text",tooltip:"tooltip"};a.rowsObj&&a.rowsObj.updateDataFields(a.options.rowFields)};this.updateCellFields=function(b){a.options.cellFields=
b?{allowEdit:b.allowEdit?b.allowEdit:"allowEdit",cid:b.cid?b.cid:"cid",content:b.content?b.content:"content",contextMenu:b.contextMenu?b.contextMenu:"contextMenu",enabled:b.enabled?b.enabled:"enabled",labelEdit:b.labelEdit?b.labelEdit:"labelEdit",rid:b.rid?b.rid:"rid",style:b.style?b.style:"style",templateObj:b.templateObj?b.templateObj:"templateObj",text:b.text?b.text:"text",tooltip:b.tooltip?b.tooltip:"tooltip",value:b.value?b.value:"value"}:{allowEdit:"allowEdit",cid:"cid",content:"content",contextMenu:"contextMenu",
enabled:"enabled",labelEdit:"labelEdit",rid:"rid",style:"style",templateObj:"templateObj",text:"text",tooltip:"tooltip",value:"value"}};this.updateDataFields=function(b){b?(a.updateColumnFields(b.column),a.updateRowFields(b.row),a.updateCellFields(b.cell)):(a.updateColumnFields(),a.updateRowFields(),a.updateCellFields())};a.updateOptions();c.$on(c.name+"-add-column",function(b,e){a.columnsObj.insertAt(e,-1,null,a.columnIsAdded)});c.$on(c.name+"-clear-columns",function(b){a.columnsObj.clear(null,a.columnsAreCleared)});
c.$on(c.name+"-insert-column-at",function(b,e,c){a.columnsObj.insertAt(e,c,null,a.columnIsAdded)});c.$on(c.name+"-insert-column-after",function(b,e,c){a.columnsObj.insertByRef(e,c,!0,a.columnIsAdded)});c.$on(c.name+"-insert-column-before",function(b,e,c){a.columnsObj.insertByRef(e,c,!1,a.columnIsAdded)});c.$on(c.name+"-remove-column",function(b,e){a.columnsObj.removeAt(e,-1,null,a.columnIsRemoved)});c.$on(c.name+"-remove-column-at",function(b,e){a.columnsObj.removeAt(null,e,null,a.columnIsRemoved)});
this.columnsAreCleared=function(b){a.options.selectedColumn&&(a.options.selectedColumn.selected=!1);a.options.selectedColumn=null;a.updateLayout()};a.columnIsAdded=function(){a.updateLayout()};a.columnIsRemoved=function(b,e){a.updateLayout()};c.$on(c.name+"-add-row",function(b,e){a.rowsObj.insertAt(e,-1,null,a.rowIsAdded)});c.$on(c.name+"-clear-rows",function(b){a.rowsObj.clear(null,a.rowsAreCleared)});c.$on(c.name+"-insert-row-at",function(b,e,c){a.rowsObj.insertAt(e,c,null,a.rowIsAdded)});c.$on(c.name+
"-insert-row-after",function(b,e,c){a.rowsObj.insertByRef(e,c,!0,a.rowIsAdded)});c.$on(c.name+"-insert-row-before",function(b,e,c){a.rowsObj.insertByRef(e,c,!1,a.rowIsAdded)});c.$on(c.name+"-remove-row",function(b,e){a.rowsObj.removeAt(e,-1,null,a.rowIsRemoved)});c.$on(c.name+"-remove-row-at",function(b,e){a.rowsObj.removeAt(null,e,null,a.rowIsRemoved)});this.rowsAreCleared=function(b){b||(a.clearPrevSelection(),a.options.selectedRow=null,a.setScrollPos({x:0,y:0}));a.updateCurrentLayout()};this.rowIsAdded=
function(){a.updateCurrentLayout()};this.rowIsRemoved=function(b,e){a.updateCurrentLayout()};this.objIsRemoved=function(b,e){a.updateCurrentLayout()};a.groups=[];a.groupList=[];a.groupLevel=-1;this.updateGroupList=function(){a.groupList.length=0;if(a.options.grouping.enabled&&0<a.groups.length){var b=a.rowsObj.getList();if(b)for(var e=0;e<b.length;e++){var c=b[e],q=c[a.options.rowFields.cells];if(q&&0<q.length){for(var d,f=null,h=0;h<a.groups.length;h++){d=a.groups[h];d=d[a.options.columnFields.id];
var g=h;d&&(g=a.getCellIndexById(q,h,d));if(0<=g&&g<q.length){(d=q[g][a.options.cellFields.text])&&""!=d||(d=void 0!=q[g][a.options.cellFields.value]?q[g][a.options.cellFields.value].toString():"undefined");var g=null,m=a.groupList;f&&(m=f[a.options.rowFields.rows]);if(m)for(var l=0;l<m.length;l++)if(m[l][a.options.rowFields.text]==d){g=m[l];break}g||(g={},g[a.options.rowFields.text]=d,g[a.options.rowFields.cells]=[{cid:a.columnList[a.options.expandColIndex][a.options.columnFields.id],text:d}],g.type=
"group",f?(f[a.options.rowFields.rows]||(f[a.options.rowFields.rows]=[]),f[a.options.rowFields.rows].push(g)):a.groupList.push(g));f=g}}f&&(f[a.options.rowFields.rows]||(f[a.options.rowFields.rows]=[]),f[a.options.rowFields.rows].push(c))}}}};a.columnList=[];a.columnFilterList=[];a.isThereLeftFixedColumns=!1;a.isThereRightFixedColumns=!1;this.updateColumnList=function(){a.columnList.length=0;a.columnFilterList.length=0;a.isThereLeftFixedColumns=!1;a.isThereRightFixedColumns=!1;var b=a.columnsObj.getList();
if(b)for(var e=0;e<b.length;e++){var c=b[e];c.type="column";c[a.options.columnFields.id]||(c[a.options.columnFields.id]=f.getUniqueId());if(0!=c[a.options.columnFields.visible]){var q=!0;a.options.grouping.enabled&&(q=0<=a.groups.indexOf(c)?a.options.grouping.showColumns:!0);if(q)switch(q=(q=c[a.options.columnFields.filterParams])?fc.createTree(q.conditions,q.formula):null,a.columnFilterList.push({cid:c[a.options.columnFields.id],tree:q}),a.columnList.push(c),c[a.options.columnFields.fixed]){case "left":a.isThereLeftFixedColumns||
(a.isThereLeftFixedColumns=!0);break;case "right":a.isThereRightFixedColumns||(a.isThereRightFixedColumns=!0)}}}};var Ec=function(b){for(var e=null,c=0;c<a.columnFilterList.length;c++)if(a.columnFilterList[c].cid==b){e=a.columnFilterList[c].tree;break}return e},E=function(b,e){if(0==a.options.allowFilter||"group"==b.type)return!0;var c=!0;if(b)for(var q,d,f,g=0;g<b[a.options.rowFields.cells].length&&(c=!0,f=b[a.options.rowFields.cells][g],q=f[a.options.cellFields.cid],d=a.getColumnById(q),!d&&g<a.columnList.length&&
(d=a.columnList[g]),d&&d[a.options.columnFields.filterParams]&&(c=d[a.options.columnFields.filterParams],d=f[a.options.cellFields.value]?f[a.options.cellFields.value]:f[a.options.cellFields.text],c=c.callback?c.callback(d,f,b):fc.match(d,c.conditions,c.formula,Ec(q))),c);g++);return c},W=a.options.indent;a.currentPageList=[];a.pageList=[];a.onlyCurrentPage=!1;a.currentList=[];a.fullIndentList=[];a.fullList=[];a.indentList=[];a.longestRow=null;a.isThereChildRows=!1;a.pageRowCount=0;a.pageNumber=0;
a.currentPageNumber=1;this.isThereVisibleChildren=function(b){var e=!1;if(b&&(b=b[a.options.rowFields.rows])&&0<b.length)for(var c=0;c<b.length;c++)if(E(b[c])){e=!0;break}return e};var J=function(b,e,c,q){b.type||(b.type="row");b[a.options.rowFields.id]||(b[a.options.rowFields.id]=f.getUniqueId());c&&(b[a.options.rowFields.pid]=c);c=!0;var d=b[a.options.rowFields.cells];if(d&&0<d.length){c=E(b,q);for(var g,h,m,l=0;l<a.columnList.length;l++){m=a.columnList[l];g=m[a.options.columnFields.id];h=m[a.options.columnFields.editorType];
m=m[a.options.columnFields.editorSettings];var r=l;g&&(r=a.getCellIndexById(d,l,g));0<=r&&r<d.length&&(d[r].type="cell",d[r][a.options.cellFields.rid]=b[a.options.rowFields.id],a.setDefaultCellValue(d[r],h,m))}}c&&(q?(a.fullList.push(b),a.fullIndentList.push(e)):a.options.paging.enabled?a.onlyCurrentPage?a.currentPageList.push({row:b,indent:e}):(b[a.options.rowFields.pid]||a.pageRowCount++,a.pageRowCount>a.options.paging.pageSize&&(a.pageRowCount=1,a.pageNumber++,a.pageList.push([])),a.pageList[a.pageNumber].push({row:b,
indent:e})):(a.currentList.push(b),a.indentList.push(e)));return c},x=function(b,e,c,q){if(!b[a.options.rowFields.rows])return c=J(b,e,c,q);if(c=J(b,e,c,q)){var d=0,f;if("group"==b.type&&(q||a.isRowExpanded(b))){var g=b[a.options.rowFields.rows];if(g){a.applySorting(g);for(var h=0;h<g.length;h++)(f=x(g[h],e+W,b[a.options.rowFields.id],q))&&d++}}q||a.isThereChildRows||!(0<d||!a.isRowExpanded(b)&&b[a.options.rowFields.rows]&&0<b[a.options.rowFields.rows].length&&a.isThereVisibleChildren(b))||(a.isThereChildRows=
!0)}return c};this.getFullList=function(){a.fullList.length=0;a.fullIndentList.length=0;for(var b=a.rowsObj.getList(),e=0;e<b.length;e++)x(b[e],0,null,!0);return a.fullList};this.getCurrentList=function(){return a.currentList};this.updateCurrentList=function(){a.currentList.length=0;a.indentList.length=0;W=a.options.indent;if(a.options.paging.enabled){if(1<=a.currentPageNumber&&a.currentPageNumber<=a.pageList.length)for(var b=0;b<a.pageList[a.currentPageNumber-1].length;b++)a.currentList.push(a.pageList[a.currentPageNumber-
1][b].row),a.indentList.push(a.pageList[a.currentPageNumber-1][b].indent)}else{a.isThereChildRows=!1;var e=a.rowsObj.getList();a.options.grouping.enabled&&0<a.groups.length&&(e=a.groupList);if(e)for(a.applySorting(e),b=0;b<e.length;b++)x(e[b],0,null,!1)}};this.updatePageList=function(){a.pageList.length=0;a.pageRowCount=0;a.pageNumber=0;a.isThereChildRows=!1;W=a.options.indent;var b=a.rowsObj.getList();a.options.grouping.enabled&&0<a.groups.length&&(b=a.groupList);if(b&&0<b.length){a.applySorting(b);
a.pageList.push([]);for(var e=0;e<b.length;e++)x(b[e],0,null,!1);0<a.pageList.length&&0==a.pageList[a.pageList.length-1].length&&a.pageList.splice(a.pageList.length-1,1)}};this.columnEvents={clear:function(a){return angular.isDefined(c.events)&&c.events.clearColumns?c.events.clearColumns():c.clearColumns(a)},objAdded:function(a){return angular.isDefined(c.events)&&c.events.columnAdded?c.events.columnAdded({column:a.e.column}):c.columnAdded(a)},objAdding:function(a){return angular.isDefined(c.events)&&
c.events.rowAdding?c.events.columnAdding({column:a.e.column}):c.columnAdding(a)},objRemoved:function(a){return angular.isDefined(c.events)&&c.events.rowRemoved?c.events.columnRemoved({column:a.e.column}):c.columnRemoved(a)},objRemoving:function(a){return angular.isDefined(c.events)&&c.events.rowRemoving?c.events.columnRemoving({column:a.e.column}):c.columnRemoving(a)}};this.rowEvents={clear:function(a){return angular.isDefined(c.events)&&c.events.clearRows?c.events.clearRows():c.clearRows(a)},objAdded:function(a){return angular.isDefined(c.events)&&
c.events.rowAdded?c.events.rowAdded({row:a.e.row}):c.rowAdded(a)},objAdding:function(a){return angular.isDefined(c.events)&&c.events.rowAdding?c.events.rowAdding({row:a.e.row}):c.rowAdding(a)},objRemoved:function(a){return angular.isDefined(c.events)&&c.events.rowRemoved?c.events.rowRemoved({row:a.e.row}):c.rowRemoved(a)},objRemoving:function(a){return angular.isDefined(c.events)&&c.events.rowRemoving?c.events.rowRemoving({row:a.e.row}):c.rowRemoving(a)}};this.getRowFields=function(a){return{content:a.content?
a.content:"content",icon:a.icon?a.icon:"icon",id:a.id?a.id:"id",pid:a.pid?a.pid:"pid",objects:a.rows?a.rows:"rows",subobjects:a.cells?a.cells:"cells",text:a.text?a.text:"text"}};a.columnsObj=new na({objects:c.columns,events:a.columnEvents,fields:a.options.columnFields});a.rowsObj=new na({objects:c.rows,events:a.rowEvents,fields:a.getRowFields(a.options.rowFields)});c.$on(c.name+"-load-data",function(b,e,c){a.loadData(e,c)});c.$on(c.name+"-export-json",function(b,e,c,q){g.setTempData(a.exportToJSON(e,
c,q))});this.exportToJSON=function(b,e,c){var q=c,q=q?q:null,d=a.columnsObj.getList();b=JSON.stringify(d,b?b:[a.options.columnFields.allowDrag,a.options.columnFields.allowDrop,a.options.columnFields.allowFilter,a.options.columnFields.allowGrouping,a.options.columnFields.cellTemplateUrl,a.options.columnFields.contentAlignment,a.options.columnFields.contextMenu,a.options.columnFields.editorType,a.options.columnFields.editorSettings,a.options.columnFields.editorTemplate,a.options.columnFields.filterParams,
a.options.columnFields.filterTemplate,a.options.columnFields.fixed,a.options.columnFields.fixedWidth,a.options.columnFields.footerAlignment,a.options.columnFields.footerContent,a.options.columnFields.footerTemplate,a.options.columnFields.footerText,a.options.columnFields.footerTooltip,a.options.columnFields.groupText,a.options.columnFields.headerAlignment,a.options.columnFields.headerContent,a.options.columnFields.headerTemplate,a.options.columnFields.headerText,a.options.columnFields.headerTooltip,
a.options.columnFields.icon,a.options.columnFields.id,a.options.columnFields.style,a.options.columnFields.templateSettings,a.options.columnFields.visible,a.options.columnFields.width],q);c=c?c:null;q=a.getFullList();e=JSON.stringify(q,e?e:[a.options.rowFields.allowCellFocus,a.options.rowFields.allowDrag,a.options.rowFields.allowDrop,a.options.rowFields.allowFocus,a.options.rowFields.cells,a.options.rowFields.content,a.options.rowFields.contextMenu,a.options.rowFields.enabled,a.options.rowFields.expanded,
a.options.rowFields.hasChildren,a.options.rowFields.icon,a.options.rowFields.id,a.options.rowFields.pid,a.options.rowFields.statusIcon,a.options.rowFields.style,a.options.rowFields.text,a.options.rowFields.tooltip,a.options.cellFields.rid],c);return'[\n{ "columns": '+b+' },\n{ "rows": '+e+" }\n]"};this.loadData=function(b,e){a.suspendLayout();a.updateDataFields(e);a.rowsObj.clear(null,a.rowsAreCleared);if(angular.isDefined(c.rows))for(var ga=c.rows.length=0;ga<b.length;ga++)c.rows.push(b[ga]);a.rowsObj=
new na({objects:c.rows,events:a.rowEvents,fields:a.getRowFields(a.options.rowFields)});a.resumeLayout()};this.updateData=function(){a.options.rowFields.dataSource&&(a.loadData(a.options.rowFields.dataSource),a.rowsObj=new na({objects:c.rows,events:a.rowEvents,fields:a.getRowFields(a.options.rowFields)}))};var Ba=!1;this.dragDropStatus=function(a){if(void 0!=a)Ba=a;else return Ba};this.getDnDSource=function(a){return{text:a.dataTransfer?a.dataTransfer.getData("text"):a.originalEvent.dataTransfer?a.originalEvent.dataTransfer.getData("text"):
""}};this.getTouchData=function(a){return a.changedTouches?a.changedTouches:a.originalEvent?a.originalEvent.changedTouches:null};var Ka=angular.element('<div class="iui-drop-marker" data-element="dropmark"></div>');this.getDropMarkLine=function(){return dropMarkLine};a.getMousePos=function(a){return{x:a.pageX?a.pageX:a.originalEvent?a.originalEvent.pageX:0,y:a.pageY?a.pageY:a.originalEvent?a.originalEvent.pageY:0}};this.getGridName=function(){return angular.isDefined(c.name)?c.name:""};d.bind("dragenter",
function(b){b.preventDefault();if(a.options.enabled){var e=h.getData();e.source||(e.source=a.getDnDSource(b));b={event:b,sourceCtrl:e.sourceCtrl?e.sourceCtrl.getGridName():"",dragRow:e.source,targetCtrl:a.getGridName(),targetRow:e.target,mousePos:a.getMousePos(b)};a.callDragEnter(b)}});d.bind("dragover",function(b){b.preventDefault();if(!a.options.enabled||!a.isDropInRange(b)||a.options.grouping.enabled&&0<a.groups.length)a.dropMark(),b.dataTransfer?b.dataTransfer.dropEffect="none":b.originalEvent&&
b.originalEvent.dataTransfer&&(b.originalEvent.dataTransfer.dropEffect="none");else{var e=!0;b.dataTransfer?e="none"===b.dataTransfer.effectAllowed?!1:!0:b.originalEvent&&b.originalEvent.dataTransfer&&(e="none"===b.originalEvent.dataTransfer.effectAllowed?!1:!0);if(e)if(b.dataTransfer?b.dataTransfer.dropEffect=a.options.allowDrop?"move":"none":b.originalEvent&&b.originalEvent.dataTransfer&&(b.originalEvent.dataTransfer.dropEffect=a.options.allowDrop?"move":"none"),e=h.getData(),e.source||(e.source=
a.getDnDSource(b)),h.setData({source:e.source,sourceCtrl:e.sourceCtrl,target:null,dropPos:-1}),e={event:b,sourceCtrl:e.sourceCtrl?e.sourceCtrl.getGridName():"",dragRow:e.source,targetCtrl:a.getGridName(),targetRow:null,isDropAllowed:a.options.allowDrop,dropPos:-1,mousePos:a.getMousePos(b)},0==a.callDragOver(e))b.dataTransfer?b.dataTransfer.dropEffect="none":b.originalEvent&&b.originalEvent.dataTransfer&&(b.originalEvent.dataTransfer.dropEffect="none"),a.dropMark();else{e=a.getMousePos(b);b=e.y+16;
var e=e.x+20,ga=a.getDropMarkWindow();ga.empty();ga.append("<span class='iui-drop-marker-move-end'></span><span class='iui-drop-marker-title'>"+(c.name?c.name:"Grid")+"</span>");a.updateDropMarkElem(a.getDropMarkWindow(),{top:b,left:e});a.dropMark(!0)}}});d.bind("drop",function(b){b.preventDefault();if(a.options.enabled){a.dropMark();if(a.isDropInRange(b)){var e=!0;b.dataTransfer?e="none"===b.dataTransfer.effectAllowed?!1:!0:b.originalEvent&&b.originalEvent.dataTransfer&&(e="none"===b.originalEvent.dataTransfer.effectAllowed?
!1:!0);if(e&&(e=h.getData(),e.source||(e.source=a.getDnDSource(b)),e.source)){var ga={event:b,sourceCtrl:e.sourceCtrl?e.sourceCtrl.getGridName():"",dragRow:e.source,targetCtrl:a.getGridName(),targetRow:null,isDropAllowed:a.options.allowDrop,dropPos:-1,mousePos:a.getMousePos(b)};!1!==a.callDragDrop(ga)&&(a.drop(e),c.$$phase||c.$apply())}}h.clearData()}b.stopPropagation()});d.bind("dragleave",function(b){b.preventDefault();if(a.options.enabled){a.dropMark();var e=h.getData();e.source||(e.source=a.getDnDSource(b));
b={event:b,sourceCtrl:e.sourceCtrl?e.sourceCtrl.getGridName():"",dragRow:e.source,targetCtrl:a.getGridName(),targetRow:e.target,mousePos:a.getMousePos(b)};a.callDragLeave(b);a.cancelScrollTimer()}});d.bind("dragend",function(b){b.preventDefault();a.options.enabled&&(a.dropMark(),h.getData().source||h.clearData(),a.dragDropStatus(!1))});d.bind("mouseleave",function(b){b.preventDefault();a.options.enabled&&(a.dropMark(),a.hoverColumn=null,a.hoverRow=null,a.hoverCell=null)});this.containsMousePos=function(a,
e){return h.hitTest(a,e,{left:0,top:0,right:d[0].clientWidth,bottom:d[0].clientHeight})};this.isPopupActive=function(){return!1};var Ca=function(b,e){var c=a.options.rowFields;if(!b[c.cells]){b[c.cells]=[];var q={};q[a.options.cellFields.text]=b[e.text];b[c.cells].push(q)}b[c.rows]||(b[c.rows]=[]);b[c.rows].length=0;if(b[e.items]&&0<b[e.items].length)for(q=0;q<b[e.items].length;q++)b[c.rows].push(Ca(b[e.items][q],e));return b},Da=function(b,e){var c=!1;e.sourceCtrl&&(c=e.sourceCollection.removeAt(b,
-1,null,e.sourceCtrl.objIsRemoved));c&&("item"==b.type&&(b=Ca(b,e.sourceCtrl.options.dataFields)),1===e.dropPos||2===e.dropPos?1===e.dropPos?a.rowsObj.insertByRef(b,e.target,!1,a.rowIsAdded):a.rowsObj.insertByRef(b,e.target,!0,a.rowIsAdded):a.rowsObj.insertAt(b,-1,null,a.rowIsAdded))};this.setDropSelection=function(b,e){var c=b;!c&&0<=e&&e<a.currentList.length&&(c=a.currentList[e]);a.clearPrevSelection(c);a.rowSelection(c)};this.drop=function(b){if(b&&b.sourceCtrl){b.sourceCtrl.suppressProcess=!0;
a.allowUpdate=!1;b.sourceCtrl.allowUpdate=!1;var e=b.source,c=-1;if(Array.isArray(b.source)){0<b.source.length&&(c=b.sourceCtrl.getObjCurrentIndex(b.source[b.source.length-1]));for(var q=[],d=0;d<b.source.length;d++){for(var f=!1,g=b.sourceCollection.getParent(b.source[d]);g;){if(b.sourceCtrl.isObjInSelList(g)){f=!0;break}g=b.sourceCollection.getParent(g)}f||q.push(b.source[d])}if(0<q.length)if(e=q[q.length-1],d=b.sourceCtrl.getObjCurrentIndex(q[0]),f=b.sourceCtrl.getObjCurrentIndex(e),d<=f)for(d=
0;d<q.length;d++)Da(q[d],b);else for(d=q.length-1;0<=d;d--)Da(q[d],b)}else c=b.sourceCtrl.getObjCurrentIndex(b.source),Da(b.source,b);b.sourceCtrl!==a?(a.allowUpdate=!0,b.sourceCtrl.allowUpdate=!0,a.updateCurrentLayout(),b.sourceCtrl.updateCurrentLayout()):(a.allowUpdate=!0,a.updateCurrentLayout());b.sourceCtrl.multiSelection(!1);var h=l(function(){b.sourceCtrl!==a&&b.sourceCtrl.setDropSelection(null,c);a.setDropSelection(e);a.updateFocus(a.getObjCurrentIndex(e),0);l.cancel(h)},1);b.sourceCtrl.suppressProcess=
!1}};this.isDragAllowed=function(b){return a.options.allowDrag?b&&"row"==b.type&&(b[a.options.rowFields.allowDrag]||void 0===b[a.options.rowFields.allowDrag])?!0:!1:!1};this.isDropAllowed=function(b,e,c){if((c=a.options.allowDrop)&&b&&e&&(c="row"!=e.type||!e[a.options.rowFields.allowDrop]&&void 0!==e[a.options.rowFields.allowDrop]?!1:!0))if(Array.isArray(b))for(var d=0;d<b.length;d++){if(b[d][a.options.rowFields.pid]&&e[a.options.rowFields.pid]&&!f.isEqual(b[d][a.options.rowFields.pid],e[a.options.rowFields.pid])){c=
!1;break}else if(f.isEqual(b[d][a.options.rowFields.id],e[a.options.rowFields.id])){c=!1;break}if(!c)break}else b[a.options.rowFields.pid]&&e[a.options.rowFields.pid]&&!f.isEqual(b[a.options.rowFields.pid],e[a.options.rowFields.pid])?c=!1:f.isEqual(b[a.options.rowFields.id],e[a.options.rowFields.id])&&(c=!1);return c};this.getDropMarkWindow=function(){for(var a=Ka,e=angular.element(document.body).children(),c=0;c<e.length;c++){var d=angular.element(e[c]);if(d[0].attributes&&d[0].attributes["data-element"]&&
"dropmark"===d[0].attributes["data-element"].value){a=d;break}}return a};this.dropMark=function(b,e){e||(e=a.getDropMarkWindow());if(e){var c="none";this.options.allowDrop&&(c=b?"block":"none");angular.element(e).css("display",c)}};this.updateDropMarkElem=function(a,e){a&&e&&(a.css("top",e.top+"px"),a.css("left",e.left+"px"),a.css("width",e.width+"px"))};c.$on(c.name+"-open-editor",function(b,e){a.openEditor(e)});c.$on(c.name+"-close-editor",function(b,e){a.closeEditor(e)});this.updateEditorSettings=
function(b){a.options.editorSettings=b?{activate:f.isFieldAvailable(b.activate,"click")}:{activate:"click"}};this.allowEvents=!0;this.callAfterEdit=function(a){angular.isDefined(c.events)&&c.events.afterEdit&&c.events.afterEdit({cell:a});c.afterEdit({e:{cell:a}})};this.callAfterLabelEdit=function(a){angular.isDefined(c.events)&&c.events.afterLabelEdit&&c.events.afterLabelEdit({cell:a});c.afterLabelEdit({e:{cell:a}})};this.callAfterSelect=function(a){angular.isDefined(c.events)&&c.events.afterSelect?
c.events.afterSelect({object:a}):c.afterSelect({e:{object:a}});angular.isDefined(c.events)&&c.events.selectionChanged?c.events.selectionChanged({object:a}):c.selectionChanged({e:{object:a}})};this.callBeforeEdit=function(a){return angular.isDefined(c.events)&&c.events.beforeEdit?c.events.beforeEdit({cell:a}):c.beforeEdit({e:{cell:a}})};this.callBeforeLabelEdit=function(a){return angular.isDefined(c.events)&&c.events.beforeLabelEdit?c.events.beforeLabelEdit({cell:a}):c.beforeLabelEdit({e:{cell:a}})};
this.callCellValueChanging=function(b,e,d){var q=!0;a.allowEvents&&(q=angular.isDefined(c.events)&&c.events.cellvalueChanging?c.events.cellvalueChanging({row:b,cell:e,value:d}):c.cellvalueChanging({e:{row:b,cell:e,value:d}}));return q};this.callCellValueChanged=function(b,e,d){a.allowEvents&&(angular.isDefined(c.events)&&c.events.cellvalueChanged?c.events.cellvalueChanged({row:b,cell:e,value:d}):c.cellvalueChanged({e:{row:b,cell:e,value:d}}))};this.callChange=function(){angular.isDefined(c.events)&&
c.events.change?c.events.change():c.change()};this.callColumnClick=function(a,e){angular.isDefined(c.events)&&c.events.columnClick&&c.events.columnClick({column:a,mousePos:e});c.columnClick({e:{column:a,mousePos:e}})};this.callColumnDblClick=function(a,e){angular.isDefined(c.events)&&c.events.columnDblclick&&c.events.columnDblclick({column:a,mousePos:e});c.columnDblclick({e:{column:a,mousePos:e}})};this.callColumnHover=function(a){angular.isDefined(c.events)&&c.events.columnHover&&c.events.columnHover({column:a});
c.columnHover({e:{column:a}})};this.callColumnPosChanging=function(a,e){return angular.isDefined(c.events)&&c.events.columnPoschanging?c.events.columnPoschanging({sourceColumn:a,targetColumn:e}):c.columnPoschanging({e:{sourceColumn:a,targetColumn:e}})};this.callColumnPosChanged=function(a,e){angular.isDefined(c.events)&&c.events.columnPoschanged&&c.events.columnPoschanged({sourceColumn:a,targetColumn:e});c.columnPoschanged({e:{sourceColumn:a,targetColumn:e}})};this.callColumnRightClick=function(a,
e){angular.isDefined(c.events)&&c.events.columnRightclick&&c.events.columnRightclick({column:a,mousePos:e});c.columnRightclick({e:{column:a,mousePos:e}})};this.callColumnSizeChanged=function(a,e){angular.isDefined(c.events)&&c.events.columnSizechanged&&c.events.columnSizechanged({column:a});c.columnSizechanged({e:{column:a}})};this.callDragEnter=function(a){angular.isDefined(c.events)&&c.events.dragEnter?c.events.dragEnter({event:a.event,sourceCtrl:a.sourceCtrl,dragRow:a.dragRow,targetCtrl:a.targetCtrl,
targetRow:a.targetRow,mousePos:a.mousePos}):c.dragEnter({e:{event:a.event,sourceCtrl:a.sourceCtrl,dragRow:a.dragRow,targetCtrl:a.targetCtrl,targetRow:a.targetRow,mousePos:a.mousePos}})};this.callDragOver=function(b){var e=a.getCellAt(b.mousePos.x,b.mousePos.y);return angular.isDefined(c.events)&&c.events.dragOver?c.events.dragOver({event:b.event,sourceTree:b.sourceTree,dragRow:b.dragRow,targetTree:b.targetTree,targetRow:b.targetRow,targetCell:e,isDropAllowed:b.isDropAllowed,dropPos:b.dropPos,mousePos:b.mousePos}):
c.dragOver({e:{event:b.event,sourceTree:b.sourceTree,dragRow:b.dragRow,targetTree:b.targetTree,targetRow:b.targetRow,targetCell:e,isDropAllowed:b.isDropAllowed,dropPos:b.dropPos,mousePos:b.mousePos}})};this.callDragDrop=function(b){var e=a.getCellAt(b.mousePos.x,b.mousePos.y);return angular.isDefined(c.events)&&c.events.dragDrop?c.events.dragDrop({event:b.event,sourceTree:b.sourceTree,dragRow:b.dragRow,targetTree:b.targetTree,targetRow:b.targetRow,targetCell:e,isDropAllowed:b.isDropAllowed,dropPos:b.dropPos,
mousePos:b.mousePos}):c.dragDrop({e:{event:b.event,sourceTree:b.sourceTree,dragRow:b.dragRow,targetTree:b.targetTree,targetRow:b.targetRow,targetCell:e,isDropAllowed:b.isDropAllowed,dropPos:b.dropPos,mousePos:b.mousePos}})};this.callDragLeave=function(a){angular.isDefined(c.events)&&c.events.dragLeave?c.events.dragLeave({event:a.event,sourceCtrl:a.sourceCtrl,dragRow:a.dragRow,targetCtrl:a.targetCtrl,targetRow:a.targetRow,mousePos:a.mousePos}):c.dragLeave({e:{event:a.event,sourceCtrl:a.sourceCtrl,
dragRow:a.dragRow,targetCtrl:a.targetCtrl,targetRow:a.targetRow,mousePos:a.mousePos}})};this.callCellClick=function(a,e,d,q){angular.isDefined(c.events)&&c.events.cellClick&&c.events.cellClick({event:a,row:e,cell:d,mousePos:q});c.cellClick({e:{event:a,row:e,cell:d,mousePos:q}})};this.callCellHover=function(a,e){angular.isDefined(c.events)&&c.events.cellHover?c.events.cellHover({event:a,cell:e}):c.cellHover({e:{event:a,cell:e}})};this.callEnabledChanged=function(a){angular.isDefined(c.events)&&c.events.enabledChanged?
c.events.enabledChanged({enabled:a}):c.enabledChanged({e:{enabled:a}})};this.callRowClick=function(a,e,d){angular.isDefined(c.events)&&c.events.rowClick?c.events.rowClick({event:a,row:e,mousePos:d}):c.rowClick({e:{event:a,row:e,mousePos:d}})};this.callRowDblClick=function(a,e){return angular.isDefined(c.events)&&c.events.rowDblClick?c.events.rowDblClick({row:a,mousePos:e}):c.rowDblclick({e:{row:a,mousePos:e}})};this.callRowHover=function(a,e){angular.isDefined(c.events)&&c.events.rowHover?c.events.rowHover({event:a,
row:e}):c.rowHover({e:{event:a,row:e}})};this.callRowRightClick=function(a,e){angular.isDefined(c.events)&&c.events.rowRightClick&&c.events.rowRightClick({row:a,mousePos:e});c.rowRightclick({e:{row:a,mousePos:e}})};this.callKeyDown=function(a,e){angular.isDefined(c.events)&&c.events.keyDown?c.events.keyDown({event:a,row:e}):c.keyDown({e:{event:a,row:e}})};this.callKeyPress=function(a,e){angular.isDefined(c.events)&&c.events.keyPress?c.events.keyPress({event:a,row:e}):c.keyPress({e:{event:a,row:e}})};
this.callKeyUp=function(a,e){angular.isDefined(c.events)&&c.events.keyUp?c.events.keyUp({event:a,row:e}):c.keyUp({e:{event:a,row:e}})};this.callScrollPosChanged=function(){angular.isDefined(c.events)&&c.events.scrollPosChanged?c.events.scrollPosChanged({scrollPos:a.scrollPos}):c.scrollposChanged({e:{scrollPos:a.scrollPos}})};d.bind("click",function(b){a.options.enabled&&1===b.which&&a.callRowClick(b,null,a.getMousePos(b))});d.bind("dblclick",function(b){b.preventDefault();a.options.enabled&&1===b.which&&
a.callRowDblClick(null,a.getMousePos(b));b.stopPropagation()});d.bind("mousedown",function(b){a.options.enabled&&3===b.which&&a.callRowRightClick(null,a.getMousePos(b));a.removeDropDownList();a.closeFilterWindow();a.closeEditor();b.stopPropagation()});this.expandList=[];this.expandIndentList=[];var zb=function(b,e,c){b.type||(b.type="row");b[a.options.rowFields.id]||(b[a.options.rowFields.id]=f.getUniqueId());c&&(b[a.options.rowFields.pid]=c);c=!0;var d=b[a.options.rowFields.cells];if(d&&0<d.length){c=
E(b);for(var g,h,m,l=0;l<a.columnList.length;l++){m=a.columnList[l];g=m[a.options.columnFields.id];h=m[a.options.columnFields.editorType];m=m[a.options.columnFields.editorSettings];var r=l;g&&(r=a.getCellIndexById(d,l,g));0<=r&&r<d.length&&(d[r].type="cell",a.setDefaultCellValue(d[r],h,m))}}c&&(a.expandList.push(b),a.expandIndentList.push(e));return c},y=function(b,e,c){if(!b[a.options.rowFields.rows])return c=zb(b,e+W,c);if(c=zb(b,e+W,c)){var d=0,f;if("group"==b.type&&a.isRowExpanded(b)){var g=b[a.options.rowFields.rows];
if(g){a.applySorting(g);for(var h=0;h<g.length;h++)(f=y(g[h],e+W,b[a.options.rowFields.id]))&&d++}}!a.isThereChildRows&&(0<d||!a.isRowExpanded(b)&&b[a.options.rowFields.rows]&&0<b[a.options.rowFields.rows].length&&a.isThereVisibleChildren(b))&&(a.isThereChildRows=!0)}return c};this.expand=function(b){a.expandList.length=[];a.expandIndentList.length=[];if(!a.isRowExpanded(b)){var e=a.getRowCurrentIndex(b);if(b=a.getList(b)){a.applySorting(b);for(var c=0;c<b.length;c++)y(b[c],a.indentList[e],null)}if(0<
a.expandList.length){a.allowEvents=!1;e++;Array.prototype.splice.apply(a.currentList,[e,0].concat(a.expandList));Array.prototype.splice.apply(a.indentList,[e,0].concat(a.expandIndentList));a.getRowScope()?a.updateView():a.updateLayout();var d=l(function(){a.updateViewSize();a.updateViewSize();a.updateScrollVisibility();a.updateScrollView();l.cancel(d);a.allowEvents=!0},1)}}};this.collapse=function(b){a.expandList.length=[];a.expandIndentList.length=[];if(a.isRowExpanded(b)){var e=null,c=!1,d=b,f=
-1,g=a.getRowCurrentIndex(b);for(b=a.getParent(b);b&&!c;){e=a.getList(b);for(f=e.indexOf(d)+1;!c&&f<e.length;)d=e[f],0<a.getRowCurrentIndex(d)&&(c=!0),f++;c||(d=b);b=a.getParent(b)}if(!c&&d)for(e=a.getList(),a.options.grouping.enabled&&0<a.groups.length&&(e=a.groupList),f=e.indexOf(d)+1;f<e.length;)if(d=e[f],0<a.getRowCurrentIndex(d)){c=!0;break}else f++;g++;e=a.currentList.length-g;c&&(e=a.getRowCurrentIndex(d)-g);if(0<e){a.currentList.splice(g,e);a.indentList.splice(g,e);a.getRowScope()?a.updateView():
a.updateLayout();var h=l(function(){a.updateViewSize();a.updateViewSize();a.updateScrollVisibility();a.updateScrollView();l.cancel(h);a.allowEvents=!0},1)}}};this.toggle=function(b,e){if(b){if(b[a.options.rowFields.hasChildren]||b[a.options.rowFields.rows]&&0!=b[a.options.rowFields.rows].length)if(!e||0==b[a.options.rowFields.expanded])if(!1!==e||0!=b[a.options.rowFields.expanded]){a.updateType="view";var c=void 0!==e?e:!1!==b[a.options.rowFields.expanded]?!0:!1,c=void 0!=e?e:!c;c!=b[a.options.rowFields.expanded]&&
(0!=c?a.expand(b):a.collapse(b),b[a.options.rowFields.expanded]=c)}}else{for(var c=a.getFullList(),d=0;d<c.length;d++)c[d][a.options.rowFields.expanded]=e;a.updateCurrentLayout()}};this.isFilteringAllowed=function(b){return b&&b[a.options.columnFields.allowFilter]};c.$on(c.name+"-filter",function(b,e,c){a.filter(e,c)});this.filter=function(b,e){if(b)b[a.options.columnFields.filterParams]=e;else for(var c=0;c<a.columnList.length;c++)a.columnList[c][a.options.columnFields.filterParams]=null;a.closeFilterWindow();
a.updateCurrentLayout();a.callChange()};this.callGotFocus=function(a,e,d,q,f){angular.isDefined(c.events)&&c.events.gotFocus?c.events.gotFocus({event:a,row:e,cell:d,edit:void 0!=q?!0:!1,editValue:f}):c.gotFocus({e:{event:a,row:e,cell:d,edit:void 0!=q?!0:!1,editValue:f}})};this.callLostFocus=function(a,e,d,q,f){angular.isDefined(c.events)&&c.events.lostFocus?c.events.lostFocus({event:a,row:e,cell:d,edit:void 0!=q?!0:!1,editValue:f}):c.lostFocus({e:{event:a,row:e,cell:d,edit:void 0!=q?!0:!1,editValue:f}})};
this.getTabIndex=function(){return d[0].attributes&&d[0].attributes.tabindex?d[0].attributes.tabindex.value:""};this.updateFocus=function(b,e){if(1==a.options.allowFocus)var c=l(function(){if(a.isRowIndexInRange(b)){var q="none";0<=e&&e<a.columnList.length&&(q=a.columnList[e][a.options.columnFields.fixed]);var f=a.getElemFromRow(a.currentList[b],q);f&&(1==a.options.allowCellFocus&&0<=e&&e<a.columnList.length?(q=a.getElemFromCell(b,e,q))&&q[0].focus():f[0].focus())}else d[0].focus();l.cancel(c)},5)};
c.$on(c.name+"-focus",function(b,e){if(e){var c,d;switch(e.type){case "group":c=a.getRowCurrentIndex(e);a.updateFocus(c);break;case "row":c=a.getRowCurrentIndex(e);a.updateFocus(c);break;case "cell":c=a.getCellRowIndex(e),d=a.getCellColumnIndex(e),a.updateFocus(c,d)}}else a.updateFocus()});var eb=!1;this.getCell=function(b,e){if(0<=b&&b<a.currentList.length){var c=a.currentList[b],d=a.getColumnRealIndex(e);0<=e&&e<a.columnList.length&&(d=a.getCellIndexById(c[a.options.rowFields.cells],e,a.columnList[e].id));
if(c[a.options.rowFields.cells]&&0<=d&&d<c[a.options.rowFields.cells].length)return c[a.options.rowFields.cells][d]}return null};this.getCellObject=function(b,e){if(0<=b&&b<a.currentList.length){var c=a.currentList[b],d=a.getColumnRealIndex(e);0<=e&&e<a.columnList.length&&(d=a.getCellIndexById(c[a.options.rowFields.cells],e,a.columnList[e].id));if(c[a.options.rowFields.cells]&&0<=d&&d<c[a.options.rowFields.cells].length)return c[a.options.rowFields.cells][d]}return null};this.getCellIndexById=function(b,
c,d){var q=-1;if(b){c=a.getColumnRealIndex(c);for(var f=0;f<b.length;f++)if(void 0==b[f][a.options.cellFields.cid]){q=c;break}else if(b[f][a.options.cellFields.cid]==d){q=f;break}}return q};this.getCellIndexFromRow=function(b,c){var d=-1;if(b&&c&&c[a.options.rowFields.cells])for(var q=0;q<c[a.options.rowFields.cells].length;q++)if(c[a.options.rowFields.cells][q]==b){d=q;break}return d};this.getCellColumnIndex=function(b){if(b)if(b[a.options.cellFields.cid]){if(b=a.getColumnById(b[a.options.cellFields.cid]))return a.getColumnCurrentIndex(b)}else return a.getCellColumnIndexFromRow(b);
return-1};this.getCellColumnIndexFromRow=function(b){if(b&&b[a.options.cellFields.rid]){var c=a.findRowById(b[a.options.cellFields.rid]);if(c&&(c=c[a.options.rowFields.cells])&&0<c.length)return c.indexOf(b)}return-1};this.getCellRowIndex=function(b){return b&&b[a.options.cellFields.rid]&&(b=a.findRowById(b[a.options.cellFields.rid]))?a.getRowCurrentIndex(b):-1};this.getColumnById=function(b){for(var c=null,d=0;d<a.columnList.length;d++)if(a.columnList[d][a.options.columnFields.id]==b){c=a.columnList[d];
break}return c};this.getColumnObject=function(b){return 0<=b&&b<a.columnList.length?a.columnList[b]:null};this.getRowObject=function(b){return 0<=b&&b<a.currentList.length?a.currentList[b]:null};this.isRowExpanded=function(b){return b?b[a.options.rowFields.expanded]||void 0===b[a.options.rowFields.expanded]?!0:!1:!0};this.getContentElement=function(a,c){var d=null;c||(c="cell-content");if(a&&0<a.children().length)for(var q=a.children(),f=0;f<q.length;f++){var g=angular.element(q.eq(f));if(g[0].attributes&&
g[0].attributes["data-element"]&&g[0].attributes["data-element"].value==c){d=g;break}}return d};this.getElement=function(a,c){var d=null;c||(c="cell-content");if(a&&0<a.children().length){a=a.children().eq(0);for(var q=a.children(),f=0;f<q.length;f++){var g=angular.element(q.eq(f));if(g[0].attributes&&g[0].attributes["data-element"]&&g[0].attributes["data-element"].value==c){d=g;break}}}return d};this.getChildElement=function(a,c){var d=null;c||(c="content");if(a&&0<a.children().length)for(var f=
a.children(),g=0;g<f.length;g++){var h=angular.element(f.eq(g));if(h[0].attributes&&h[0].attributes["data-element"]&&h[0].attributes["data-element"].value==c){d=h;break}}return d};this.getElemFromColumn=function(b,c,d){var f=null;if(b){b=a.getColumnCurrentIndex(b);var g=a.getHeaderElem(c);"footer"==d&&(g=a.getFooterElem(c));if(g&&(c=g.find("td"))&&0<c.length)for(d=0;d<c.length;d++)if(g=angular.element(c[d]),g[0].attributes["data-index"]&&g[0].attributes["data-index"].value.toString()===b.toString()){f=
g;break}}return f};this.getElemFromRow=function(b,c){var d=null;if(b){var f=a.getRowCurrentIndex(b),g=a.getRowElems(c);if(g&&0<g.length)for(var h=0;h<g.length;h++){var m=angular.element(g[h]);if(m[0].attributes["data-index"]&&m[0].attributes["data-index"].value.toString()===f.toString()){d=m;break}}}return d};this.getElemFromCell=function(b,c,d){var f=null;if(0<=b&&b<a.currentList.length&&(b=a.getElemFromRow(a.currentList[b],d))&&(b=b.find("td"))&&0<b.length)for(d=0;d<b.length;d++){var g=angular.element(b[d]);
if(g[0].attributes["data-index"]&&g[0].attributes["data-index"].value.toString()===c.toString()){f=g;break}}return f};this.getElemFromColumnCell=function(b,c,d){var f=null;if((c=d?a.getFooterElem(c):a.getHeaderElem(c))&&(c=c.find("td"))&&0<c.length)for(d=0;d<c.length;d++){var g=angular.element(c[d]);if(g[0].attributes["data-index"]&&g[0].attributes["data-index"].value.toString()===b.toString()){f=g;break}}return f};this.getIndent=function(b){var c=0;if(b)for(parent=a.rowsObj.getParent(b);parent;)c+=
a.options.indent,parent=a.rowsObj.getParent(parent);return c};this.getObjState=function(b){if(b)switch(b.type){case "column":if(0==a.options.enabled)return"disabled";if(1==b.selected)return"selected";if(b==a.hoverColumn)return"hovered";break;case "group":if(0==a.options.enabled||0==b[a.options.rowFields.enabled])return"disabled";if(1==b.selected)return"selected";if(b==a.hoverRow)return"hovered";break;case "row":if(0==a.options.enabled||0==b[a.options.rowFields.enabled])return"disabled";if(1==b.selected)return"selected";
if(b==a.hoverRow)return"hovered";break;case "cell":if(0==a.options.enabled||0==b[a.options.cellFields.enabled])return"disabled";if(1==b.selected)return"selected";if(b==a.hoverCell)return"hovered"}return"normal"};this.getColumnAt=function(b,c){if(void 0==b||void 0==c)return a.hoverColumn;var d,g,h=null;d="left";for(var m=0;!h&&3>m;){if(d=a.getHeaderElem(d)){var l=d.find("td");if(l&&0<l.length)for(var r=0;r<l.length;r++)if(d=angular.element(l[r]),g=f.getPageRect(d),f.checkHit(b,c,g)){h=a.getColumnFromElem(d);
break}}m++;d=1==m?"right":"none"}return h};this.getCellAt=function(b,c){var d=null,g=a.getRowAt(b,c);if(g){var h,m,l=a.getElemFromRow(g).find("td");if(l&&0<l.length)for(var r=0;r<l.length&&!(h=angular.element(l[r]),m=f.getPageRect(h),f.checkHit(b,c,m)&&(d=a.getRowCurrentIndex(g),h=a.getIndexFromElem(h),d=a.getCellObject(d,h)));r++);}return d};this.getRowAt=function(b,c){var d,g,h=null;d="none";for(var m=0;!h&&3>m;){var l=a.getRowElems(d);if(l&&0<l.length)for(var r=0;r<l.length;r++)if(d=angular.element(l[r]),
g=f.getPageRect(d),f.checkHit(b,c,g)){h=a.getRowFromElem(d);break}m++;d=1==m?"left":"right"}return h};this.getRowCurrentIndex=function(b){return b&&a.currentList?a.currentList.indexOf(b):-1};this.getObjCurrentIndex=function(b){return a.getRowCurrentIndex(b)};this.getRowFromChildElem=function(b){if(b&&(b=angular.element(b))){for(b=b.parent();b&&b[0].tagName&&"tr"!==b[0].tagName.toLowerCase();)b=b.parent();return b?a.getRowFromElem(b):null}return null};this.getColumnCurrentIndex=function(b){return b&&
a.columnList?a.columnList.indexOf(b):-1};this.getColumnRealIndex=function(b){var c=a.columnsObj.getList();return 0<=b&&b<c.length&&b<a.columnList.length?c.indexOf(a.columnList[b]):-1};this.getColumnFromChildElem=function(b){return b?a.getColumnFromElem(b):null};this.getColumnFromElem=function(b){return b&&(b=angular.element(b))&&b[0].attributes["data-index"]&&(b=b[0].attributes["data-index"].value,0<=b&&b<a.columnList.length)?a.columnList[b]:null};this.getIndexFromElem=function(a){return a&&(a=angular.element(a))&&
a[0].attributes["data-index"]?a[0].attributes["data-index"].value:-1};this.getRowFromElem=function(b){if(b&&(b=angular.element(b))&&b[0].attributes["data-index"]&&(b=b[0].attributes["data-index"].value,a.isRowIndexInRange(b)))return a.currentList[b]};this.isRowIndexInRange=function(b){return 0<=b&&b<a.currentList.length};this.isColIndexInRange=function(b){return 0<=b&&b<a.columnList.length};this.isRowEnabled=function(b){return b&&1==a.options.enabled&&f.isEnabled(b[a.options.rowFields.enabled])};
this.mouseButtonStatus=function(a){eb=a};c.$on(c.name+"-ensure-visible",function(b,c){a.ensureVisible(c)});c.$on(c.name+"-find-row-by-id",function(b,c){g.setTempData(a.findRowById(c))});c.$on(c.name+"-find-row-by-text",function(b,c){g.setTempData(a.findRowByText(c))});c.$on(c.name+"-get-list",function(b,c){g.setTempData(a.getList(c))});c.$on(c.name+"-get-top-row",function(b){g.setTempData(a.getTopRow())});c.$on(c.name+"-set-top-row",function(b,c){a.ensureVisible(c)});this.ensureVisible=function(b,
c){if(b){for(var d=[],f=a.getParent(b);f;)d.push(f),f=a.getParent(f);for(f=d.length-1;0<=f;f--)d[f][a.options.rowFields.expanded]=!0;a.updateCurrentLayout();var g=l(function(){c=void 0!=c?c:"center";a.scrollTo(b,c);l.cancel(g)},100)}};this.findRowById=function(b){return a.rowsObj.findObjectById(b)};this.findRowByText=function(b){return a.rowsObj.findObjectByText(b)};this.getLevel=function(a){var c=0;for(a=this.getParent(a);a;)c++,a=this.getParent(a);return c};this.findParent=function(b,c){var d=null;
if(b&&c)for(var f=0;!d&&f<c.length;)d=c[f][a.options.rowFields.id]&&b[a.options.rowFields.pid]&&c[f][a.options.rowFields.id].toString()===b[a.options.rowFields.pid].toString()?c[f]:a.findParent(b,c[f][a.options.rowFields.rows]),f++;return d};this.getParent=function(b){return b?a.findParent(b,a.groupList):null};this.getList=function(b){return a.rowsObj.getList(b)};this.getFirstRow=function(){for(var b=null,c=0;c<a.currentList.length;c++)if(f.isEnabled(a.currentList[c][a.options.rowFields.enabled])){b=
a.currentList[c];break}return b};this.getPrevRow=function(b){var c=null;if(0<=b&&b<a.currentList.length)for(--b;0<=b;b--)if(f.isEnabled(a.currentList[b][a.options.rowFields.enabled])){c=a.currentList[b];break}return c};this.getNextRow=function(b){var c=null;for(b+=1;b<a.currentList.length;b++)if(f.isEnabled(a.currentList[b][a.options.rowFields.enabled])){c=a.currentList[b];break}return c};this.getLastRow=function(){for(var b=null,c=a.currentList.length-1;0<=c;c--)if(f.isEnabled(a.currentList[c][a.options.rowFields.enabled])){b=
a.currentList[c];break}return b};this.updateSelectionStatus=function(b){switch(b){case "shift":switch(a.options.selectionMode){case "multi-simple":a.multiSelection(!0);break;case "multi-extended":a.multiSelection(!0);break;default:a.multiSelection(!1)}break;case "ctrl":switch(a.options.selectionMode){case "multi-simple":a.multiSelection(!0);break;case "multi-extended":a.multiSelection(!0);break;default:a.multiSelection(!1)}}};d.bind("keydown",function(b){if(a.options.enabled)switch(b.keyCode){case 16:a.updateSelectionStatus("shift");
break;case 17:a.updateSelectionStatus("ctrl");break;default:(b.ctrlKey||b.metaKey)&&a.updateSelectionStatus("ctrl"),b.shiftKey&&a.updateSelectionStatus("shift")}});this.allowUpdate=!0;this.updateType="all";this.suspendLayout=function(b){a.allowUpdate=!1};this.resumeLayout=function(b){a.allowUpdate=!0;b?a.updateCurrentLayout():a.updateLayout()};c.$on(c.name+"-refresh",function(b,c,d){a.refresh(c,d)});c.$on(c.name+"-resume-layout",function(b,c){a.resumeLayout(c)});c.$on(c.name+"-suspend-layout",function(b,
c){a.suspendLayout(c)});c.$on(c.name+"-update-layout",function(b,c){c?a.updateCurrentLayout():a.updateLayout()});c.$on(c.name+"-update-view",function(b){a.updateView()});c.$on(c.name+"-begin-load",function(b,c){a.beginLoad(c)});c.$on(c.name+"-end-load",function(b){a.endLoad()});this.callLoadComplete=function(){angular.isDefined(c.events)&&c.events.loadComplete?c.events.loadComplete():c.loadComplete()};this.callUpdateComplete=function(){angular.isDefined(c.events)&&c.events.updateComplete?c.events.updateComplete():
c.updateComplete()};c.$on(c.name+"-get-current-page",function(b){g.setTempData(a.currentPageNumber)});c.$on(c.name+"-set-current-page",function(b,c){a.setCurrentPage(c)});c.$on(c.name+"-first-page",function(b){a.firstPage()});c.$on(c.name+"-last-page",function(b){a.lastPage()});c.$on(c.name+"-next-page",function(b){a.nextPage()});c.$on(c.name+"-prev-page",function(b){a.prevPage()});this.setCurrentPage=function(b){a.currentPageNumber!=b&&1<=b&&b<=a.pageList.length&&(a.currentPageNumber=b,a.updateCurrentLayout())};
this.firstPage=function(){1!=a.currentPageNumber&&(a.currentPageNumber=1,a.updateCurrentLayout())};this.lastPage=function(){a.currentPageNumber!=a.pageList.length&&(a.currentPageNumber=a.pageList.length,a.updateCurrentLayout())};this.nextPage=function(){a.currentPageNumber<a.pageList.length&&(a.currentPageNumber++,a.updateCurrentLayout())};this.prevPage=function(){1<a.currentPageNumber&&(a.currentPageNumber--,a.updateCurrentLayout())};c.$on(c.name+"-get-max-scroll-pos",function(b){g.setTempData(a.getMaxScrollPos())});
c.$on(c.name+"-get-scroll-pos",function(b){g.setTempData(a.getScrollPos())});c.$on(c.name+"-set-scroll-pos",function(b,c){a.setScrollPos(c)});c.$on(c.name+"-scroll-to",function(b,c,d){a.scrollTo(c,d)});var va=!1;this.multiSelection=function(a){if(void 0!=a)va=a;else return va};this.columnSelection=function(b,e){if(b){var d=!0;a.options.selectedColumn&&(d=!f.isEqual(a.options.selectedColumn[a.options.columnFields.id],b[a.options.columnFields.id]));var g;g=angular.isDefined(c.events)&&c.events.beforeSelect?
c.events.beforeSelect({object:b}):c.beforeSelect({e:{object:b}});d&&!1!==g&&(a.options.selectedColumn&&(a.options.selectedColumn.selected=!1,a.refresh(a.options.selectedColumn)),a.options.selectedColumn=b,b.selected=!0,angular.isDefined(c.selectedColumn)&&(c.selectedColumn=b),a.refresh(a.options.selectedColumn),a.callAfterSelect(b))}else return a.options.selectedColumn};this.isRowSelected=function(a){return f.isSelected(a)};this.clearPrevSelection=function(b){for(var c=0;c<a.options.selectedRows.length;c++)b&&
!f.isEqual(a.options.selectedRows[c][a.options.rowFields.id],b[a.options.rowFields.id])?a.options.selectedRows[c].selected=!1:b||(a.options.selectedRows[c].selected=!1);a.options.selectedRows.length=0;b&&0!=b[a.options.rowFields.enabled]&&a.options.selectedRows.push(b);a.refreshRows()};this.markSelColumn=function(){for(var b=0;b<a.columnList.length;b++)a.refresh(a.columnList[b])};this.rowSelection=function(b,e,d,g,h){if(b){if("none"!=a.options.selectionMode)if(a.isRowEnabled(b)){var m=a.rowSelection(),
l=!0;m&&(l=!f.isEqual(m[a.options.rowFields.id],b[a.options.rowFields.id]));var r=!0,r=angular.isDefined(c.events)&&c.events.beforeSelect?c.events.beforeSelect({object:b}):c.beforeSelect({e:{object:b}});if(!1!==r)if(l){var x=e||d||g?!0:!1,l=!0;"multi-extended"==a.options.selectionMode&&(l=!a.isObjInSelList(b));l&&("one"==a.options.selectionMode?a.clearPrevSelection():eb&&e?a.clearPrevSelection():va||x||"multi-simple"===a.options.selectionMode||a.clearPrevSelection());a.options.selectedRow=b;if(eb&&
e&&"one"!=a.options.selectionMode){if(e=a.getRowCurrentIndex(m),h=a.getRowCurrentIndex(b),e>h&&(d=e,e=h,h=d),a.isRowIndexInRange(e)&&a.isRowIndexInRange(h))for(;e<=h;e++)a.currentList[e].selected=!0,a.options.selectedRows.push(a.currentList[e])}else eb&&(va||x||"multi-simple"===a.options.selectionMode)?(e=null===b.selected||"undefined"===b.selected?!1:b.selected,b.selected=!e,b.selected?a.isObjInSelList(b)||a.options.selectedRows.push(b):a.options.selectedRows=a.options.selectedRows.filter(function(a){return a!=
b})):(b.selected=!0,a.isObjInSelList(b)||a.options.selectedRows.push(b));angular.isDefined(c.selectedRow)&&(c.selectedRow=b);a.callAfterSelect(b);a.refresh(null,null,!0)}else if(va||x||"multi-simple"===a.options.selectionMode)e=null===b.selected||"undefined"===b.selected?!1:b.selected,h&&"undefined"!==h&&(e=h),b.selected=!e,b.selected?a.isObjInSelList(b)||a.options.selectedRows.push(b):a.options.selectedRows=a.options.selectedRows.filter(function(a){return a!=b}),a.callAfterSelect(b),a.refresh(null,
null,!0)}else a.clearPrevSelection()}else return a.options.selectedRow};this.updateSelection=function(b,c,d){b=b&&(b.shiftKey||b.ctrlKey||b.metaKey)?!0:!1;"multi-extended"==a.options.selectionMode&&0<a.options.selectedRows.length&&!d&&!va&&!b&&(a.clearPrevSelection(c),a.refresh(null,null,!0))};this.isObjInSelList=function(b){var c=!1,d=a.options.selectedRows;if(b&&d)for(var g=0;g<d.length;g++)if(f.isEqual(d[g][a.options.rowFields.id],b[a.options.rowFields.id])){c=!0;break}return c};c.$on(c.name+"-clear-selection",
function(b){a.options.selectedColumn&&(a.options.selectedColumn.selected=!1);a.options.selectedColumn=null;a.clearPrevSelection();a.options.selectedRow=null});c.$on(c.name+"-get-hover-column",function(b,c){a.hoverColumn?g.setTempData(a.hoverColumn):c&&g.setTempData(a.getColumnAt({x:c.x,y:c.y}))});c.$on(c.name+"-get-selected-column",function(b){g.setTempData(a.columnSelection())});c.$on(c.name+"-set-selected-column",function(b,c){a.columnSelection(c)});c.$on(c.name+"-get-selected-row",function(b){g.setTempData(a.rowSelection())});
c.$on(c.name+"-set-selected-row",function(b,c){var d=l(function(){a.rowSelection(c);l.cancel(d)},1)});c.$on(c.name+"-get-selected-rows",function(b){g.setTempData(a.options.selectedRows)});c.$on(c.name+"-set-selected-rows",function(b,c){c&&Array.isArray(c)&&l(function(){for(var b=a.options.selectedRows.length=0;b<c.length;b++)c[b].selected=!0,a.options.selectedRows.push(c[b]);0<c.length?(a.options.selectedRow=c[c.length-1],a.callAfterSelect(a.options.selectedRow)):a.options.selectedRow=null;a.refresh(null,
null,!0)},1)});c.$on(c.name+"-move-column",function(b,c,d){a.moveColumn(c,d)});c.$on(c.name+"-move-row",function(b,c,d,f,g){a.moveRow(c,d,f,g)});c.$watch("options",function(b,c){b!==c&&(a.updateOptions(b),a.updateLayout())},!0);c.$watch("allowCellFocus",function(b,c){b!==c&&(a.options.allowCellFocus=b)});c.$watch("allowColumnReorder",function(b,c){b!==c&&(a.options.allowColumnReorder=b)});c.$watch("allowFilter",function(b,c){b!==c&&(a.options.allowFilter=b)});c.$watch("allowFocus",function(b,c){b!==
c&&(a.options.allowFocus=b)});c.$watch("allowDrag",function(b,c){b!==c&&(a.options.allowDrag=b,a.updateView())});c.$watch("allowDrop",function(b,c){b!==c&&(a.options.allowDrop=b,a.updateView())});c.$watch("autoExpand",function(b,c){b!==c&&(a.options.autoExpand=b)});c.$watch("controlStyle",function(b,c){b!==c&&a.updateControlStyle(b)});c.$watch("editorSettings",function(b,c){b!==c&&a.updateEditorSettings(b)});c.$watch("enabled",function(b,c){b!==c&&(a.options.enabled=b,a.updateView(),a.options.grouping.enabled&&
a.updateGroupPanel(),a.options.paging.enabled&&a.options.paging.showControlPanel&&a.updatePaginationPanel(),a.callEnabledChanged(b))});c.$watch("expandingColumnIndex",function(b,c){b!==c&&(a.options.expandColIndex=b)});c.$watch("fields",function(b,c){b!==c&&(a.updateDataFields(b),a.UpdateData())});c.$watch("fillSpace",function(b,c){b!==c&&(a.options.fillSpace=b)});c.$watch("gridLines",function(b,c){b!==c&&(a.options.gridLines=b,a.updateView())});c.$watch("grouping",function(b,c){b!==c&&(a.updateGrouping(b),
a.updateLayout())},!0);c.$watch("hoverSelection",function(b,c){b!==c&&(a.options.hoverSelection=b)});c.$watch("indent",function(b,c){b!==c&&(a.options.indent=b,a.updateLayout())});c.$watch("rowHeight",function(b,c){b!==c&&(a.options.rowHeight=b,a.updateLayout())});c.$watch("rowIcon",function(b,c){b!==c&&(a.options.rowIcon=b,a.updateLayout())});c.$watch("labelEdit",function(b,c){b!==c&&(a.options.labelEdit=b)});c.$watch("paging",function(b,c){b!==c&&(a.updatePaging(b),a.resetPageNumber(),a.updateCurrentLayout())},
!0);c.$watch("pathSeparator",function(b,c){b!==c&&(a.options.pathSeparator=b)});c.$watch("rtl",function(b,c){b!==c&&(a.options.rtl=b,a.updateLayout())});a.resetSelection=function(){switch(a.options.selectionMode){case "none":a.clearPrevSelection();break;default:a.clearPrevSelection(a.rowSelection())}};c.$watch("selectionMode",function(b,c){b!==c&&(a.options.selectionMode=b,a.resetSelection())});c.$watch("showFooter",function(b,c){b!==c&&(a.options.showFooter=b,a.updateLayout())});c.$watch("showHeader",
function(b,c){b!==c&&(a.options.showHeader=b,a.updateLayout())});c.$watch("showIcons",function(b,c){b!==c&&(a.options.showIcons=b,a.updateLayout())});c.$watch("selectedRow",function(b,c){b!==c&&(c&&(c.selected=!1),a.options.selectedRow=b,a.callAfterSelect(b))});this.sortComparer=this.sortColumn=null;c.$watch("sorting",function(b,c){b!==c&&(a.options.sorting=b)});c.$on(c.name+"-sort",function(b,c,d,f){a.sort(c,d,f)});this.sort=function(b,c,d){a.sortColumn=b;a.sortComparer=d;if("ascending"==c||"descending"==
c||"none"==c)a.options.sorting=c;a.updateCurrentLayout();a.callChange()};this.getCellIndexInCollection=function(b,c,d){var f=-1;if(b)for(var g=0;g<b.length;g++)if(void 0==b[g][a.options.cellFields.cid]){f=c;break}else if(b[g][a.options.cellFields.cid]==d){f=g;break}return f};this.isSortingAllowed=function(){return"ascending"==a.options.sorting||"descending"==a.options.sorting};this.applySorting=function(b){if(b&&(!a.sortColumn||0!=a.sortColumn[a.options.columnFields.visible])){var c=a.getColumnCurrentIndex(a.sortColumn),
d=0<=c?c:a.options.expandColIndex;if(d<a.columnList.length){var g=a.columnList[d][a.options.columnFields.id];a.sortColumn&&a.sortColumn[a.options.columnFields.comparer]?b.sort(a.sortColumn[a.options.columnFields.comparer]):a.sortComparer?b.sort(a.sortComparer):a.isSortingAllowed()&&b.sort(function(b,c){var e=null,h=null;if(b[a.options.rowFields.cells]){var m=a.getCellIndexInCollection(b[a.options.rowFields.cells],d,g);0<=m&&((e=b[a.options.rowFields.cells][m][a.options.cellFields.value])||(e=b[a.options.rowFields.cells][m][a.options.cellFields.text]),
f.isObject(e)&&(e=e.value?e.value:e.text))}c[a.options.rowFields.cells]&&(m=a.getCellIndexInCollection(c[a.options.rowFields.cells],d,g),0<=m&&((h=c[a.options.rowFields.cells][m][a.options.cellFields.value])||(h=c[a.options.rowFields.cells][m][a.options.cellFields.text]),f.isObject(h)&&(h=h.value?h.value:h.text)));e=void 0!=e?e:null;h=void 0!=h?h:null;switch(a.options.sorting){case "ascending":if(e<h)return-1;if(e>h)return 1;break;case "descending":if(e>h)return-1;if(e<h)return 1;break;default:return 0}})}}};
var G=function(b){if(b){var c=f.isFieldAvailable(b.general,"iui-grid-column"),d;d=(d=b.header)?{content:f.isFieldAvailable(d.content,"iui-grid-column-header-cell-content"),disabled:f.isFieldAvailable(d.disabled,"iui-grid-column-header-disabled"),normal:f.isFieldAvailable(d.normal,"iui-grid-column-header"),hovered:f.isFieldAvailable(d.hovered,"iui-grid-column-header-hovered"),selected:f.isFieldAvailable(d.selected,"iui-grid-column-header-selected")}:a.options.controlStyle.column.header;b=(b=b.footer)?
{content:f.isFieldAvailable(b.content,"iui-grid-column-footer-cell-content"),disabled:f.isFieldAvailable(b.disabled,"iui-grid-column-footer-disabled"),normal:f.isFieldAvailable(b.normal,"iui-grid-column-footer"),hovered:f.isFieldAvailable(b.hovered,"iui-grid-column-footer-hovered"),selected:f.isFieldAvailable(b.selected,"iui-grid-column-footer-selected")}:a.options.controlStyle.column.footer;return{general:c,header:d,footer:b}}return a.options.controlStyle.column};this.getExpandBoxStyle=function(b){return b?
{general:f.isFieldAvailable(b.general,"iui-grid-expand-box"),animated:f.isFieldAvailable(b.animated,"iui-grid-expand-box-load"),expanded:f.isFieldAvailable(b.expanded,"iui-grid-expand-box-open"),collapsed:f.isFieldAvailable(b.collapsed,"iui-grid-expand-box-close")}:a.options.controlStyle.row.expandBox};var Ab=function(b){if(b){var c;c=(c=b.general)?{disabled:f.isFieldAvailable(c.disabled,"iui-grid-row-disabled"),focused:f.isFieldAvailable(c.focused,"iui-grid-row-focused"),normal:f.isFieldAvailable(c.normal,
"iui-grid-row"),hovered:f.isFieldAvailable(c.hovered,"iui-grid-row-hovered"),selected:f.isFieldAvailable(c.selected,"iui-grid-row-selected")}:a.options.controlStyle.row.general;var d;var g=b.checkBox;g?(d=f.isFieldAvailable(g.general,"iui-checkbox"),g=(g=g.box)?{general:f.isFieldAvailable(g.general,"iui-checkbox-box"),disabled:f.isFieldAvailable(g.disabled,"iui-checkbox-disabled"),checked:f.isFieldAvailable(g.checked,"iui-checkbox-checked"),indeterminate:f.isFieldAvailable(g.indeterminate,"iui-checkbox-indeterminate"),
unchecked:f.isFieldAvailable(g.unchecked,"iui-checkbox-unchecked")}:a.options.controlStyle.row.checkBox.box,d={general:d,box:g}):d=a.options.controlStyle.row.checkBox;g=a.getExpandBoxStyle(b.expandBox);b=(b=b.cell)?{content:f.isFieldAvailable(b.content,"iui-grid-row-cell-content"),general:f.isFieldAvailable(b.general,"iui-grid-row-cell"),disabled:f.isFieldAvailable(b.disabled,"iui-grid-row-cell-disabled"),focused:f.isFieldAvailable(b.focused,"iui-grid-row-cell-focused"),normal:f.isFieldAvailable(b.normal,
"iui-grid-row-cell"),hovered:f.isFieldAvailable(b.hovered,"iui-grid-row-cell-hovered"),selected:f.isFieldAvailable(b.selected,"iui-grid-row-cell-selected")}:a.options.controlStyle.row.cell;return{general:c,checkBox:d,expandBox:g,cell:b}}return a.options.controlStyle.row},z=function(b){return b?{content:f.isFieldAvailable(b.content,"iui-grid-row-cell-content"),general:f.isFieldAvailable(b.general,"iui-grid-row-cell"),disabled:f.isFieldAvailable(b.disabled,"iui-grid-row-cell-disabled"),focused:f.isFieldAvailable(b.focused,
"iui-grid-row-cell-focused"),normal:f.isFieldAvailable(b.normal,"iui-grid-row-cell"),hovered:f.isFieldAvailable(b.hovered,"iui-grid-row-cell-hovered"),selected:f.isFieldAvailable(b.selected,"iui-grid-row-cell-selected")}:a.options.controlStyle.cell};this.updateControlStyle=function(b){a.options.controlStyle=b?{general:f.isFieldAvailable(b.general,"iui-grid"),column:G(b.column),row:Ab(b.row),cell:z(b.cell)}:{general:f.isFieldAvailable(a.defaultStyle.general,"iui-grid"),column:G(a.defaultStyle.column),
row:Ab(a.defaultStyle.row),cell:z(a.defaultStyle.cell)}};this.getCurrentColumnStyle=function(b,c,d){var g=a.options.controlStyle.column;b&&b.style&&(g=b.style);b=a.options.controlStyle.column.body;var f=g.body;switch(c){case "header":b=a.options.controlStyle.column.header;f=g.header;break;case "footer":b=a.options.controlStyle.column.footer,f=g.footer}if(d)switch(d){case "content":return f&&f.content?f.content:b.content;case "disabled":return f&&f.disabled?f.disabled:b.disabled;case "hovered":return f&&
f.hovered?f.hovered:b.hovered;case "selected":return f&&f.selected?f.selected:b.selected;default:return f&&f.normal?f.normal:b.normal}else return c?f?f:b:g?g:a.options.controlStyle.column};this.getCurrentRowStyle=function(b,c){var d=a.options.controlStyle.row;if(b)switch(b[a.options.rowFields.style]){case "initial":break;case "parent":return a.getCurrentRowStyle(a.getParent(b),c);default:null!=b.style&&(d=b.style)}if(c){if(f.isString(d.general))return d.general;switch(c){case "disabled":return d.general&&
d.general.disabled?d.general.disabled:a.options.controlStyle.row.general.disabled;case "focused":return d.general&&d.general.focused?d.general.focused:a.options.controlStyle.row.general.focused;case "hovered":return d.general&&d.general.hovered?d.general.hovered:a.options.controlStyle.row.general.hovered;case "selected":return d.general&&d.general.selected?d.general.selected:a.options.controlStyle.row.general.selected;default:return d.general&&d.general.normal?d.general.normal:a.options.controlStyle.row.general.normal}}else return d?
d:a.options.controlStyle.row};this.getDefaultCellContentClass=function(){return"iui-grid-row-cell-content"};this.getDefaultCellLabelClass=function(){return"iui-grid-row-cell-label"};this.getDefaultCellBorderClass=function(){return"iui-grid-lines-both"};this.getCurrentCellStyle=function(b,c,d){var f=a.options.controlStyle.row.cell;if(c)switch(c[a.options.cellFields.style]){case "initial":break;case "parent":b&&(f=z(a.getCurrentRowStyle(b)));break;default:c.style&&(f=c.style)}if(d)switch(d){case "content":return f.content?
f.content:a.options.controlStyle.cell.content;case "disabled":return f.disabled?f.disabled:a.options.controlStyle.cell.disabled;case "focused":return f.focused?f.focused:a.options.controlStyle.cell.focused;case "hovered":return f.hovered?f.hovered:a.options.controlStyle.cell.hovered;case "selected":return f.selected?f.selected:a.options.controlStyle.cell.selected;default:return f.normal?f.normal:a.options.controlStyle.cell.normal}else return f?f:a.options.controlStyle.row.cell}}]).directive("iuiGrid",
["$compile","$timeout","$interval","IntegralUIInternalService","IntegralUIDragDrop","$window","IntegralUIListCtrlService",function(c,d,l,m,r,f,na){return{restrict:"EA",controller:"IntegralUIGridController",transclude:!0,replace:!0,template:'<div class="iui-grid" data-element="grid"><div class="iui-grid-block"></div></div>',scope:{allowAnimation:"=",allowCellFocus:"=",allowColumnReorder:"=",allowFilter:"=",allowFocus:"=",allowDrag:"=",allowDrop:"=",animationSpeed:"=",autoExpand:"=",columns:"=",controlStyle:"=",
editorSettings:"=",enabled:"=",expandingColumnIndex:"=",fields:"=",fillSpace:"=",gridLines:"=",grouping:"=",hoverSelection:"=",indent:"=",labelEdit:"=",name:"@",options:"=?",paging:"=?",rowHeight:"=",rowIcon:"=",rows:"=",selectedIndex:"=",selectedRow:"=",selectionMode:"@",showFooter:"=",showHeader:"=",showIcons:"=",sorting:"@",afterEdit:"&",afterLabelEdit:"&",afterSelect:"&",beforeEdit:"&",beforeLabelEdit:"&",beforeSelect:"&",cellClick:"&",cellHover:"&",cellvalueChanged:"&",cellvalueChanging:"&",
change:"&",clearColumns:"&",clearRows:"&",columnAdded:"&",columnAdding:"&",columnClick:"&",columnDblclick:"&",columnHover:"&",columnPoschanging:"&",columnPoschanged:"&",columnRemoved:"&",columnRemoving:"&",columnRightclick:"&",columnSizechanged:"&",dragDrop:"&",dragEnter:"&",dragLeave:"&",dragOver:"&",enabledChanged:"&",events:"=?",gotFocus:"&",keyDown:"&",keyPress:"&",keyUp:"&",loadComplete:"&",lostFocus:"&",rowAdded:"&",rowAdding:"&",rowClick:"&",rowDblclick:"&",rowHover:"&",rowRemoved:"&",rowRemoving:"&",
rowRightclick:"&",scrollposChanged:"&",selectionChanged:"&",updateComplete:"&"},link:function(g,h,fc,a,Ec){var E=this,W=h.children().eq(0),J=angular.element('<div class="iui-scrollbar-vertical"><div class="iui-scroll-button-thumb-vertical"></div></div>'),x=angular.element('<div class="iui-scrollbar-horizontal"><div class="iui-scroll-button-thumb-horizontal"></div></div>'),Ba=angular.element('<div class="iui-scrollbar-corner"></div>'),Ka=null,Ca=null,Da=null,zb=!1,y=angular.element('<input type="text" class="iui-label-editor" draggable="false" />');
a.labelEditStatus=function(a){if(void 0!=a)zb=a;else return zb};var eb=function(){var b="iui-grid-block";a.options.showStatusIcons&&(b+=" "+b+"-shift-left");a.options.rtl&&(b+=" "+b+"-rtl");return b};g.$on("$destroy",function(a){E.s2t();Ea&&(d.cancel(Ea),Ea=null);w&&(w.unbind("mouseenter mouseleave mousemove mouseup"),Fc());oa&&oa.unbind("mousedown");h.unbind("click dblclick dragenter dragleave dragend drop keydown mousedown mouseleave mousemove mousewheel scroll touchstart touchmove touchend");angular.element(f).unbind("dragenter",
Gc);angular.element(f).unbind("dragover",Hc);angular.element(f).unbind("dragend",Ic);angular.element(f).unbind("keyup",Jc);angular.element(f).unbind("mousemove",Kc);angular.element(f).unbind("mousedown",Lc);angular.element(f).unbind("mouseup",Mc);y&&y.unbind("blur focus keydown mousedown");Nc();F&&F.$destroy();v&&v.$destroy()});a.dragIcon=document.createElement("img");a.dragIcon.width=1;h.append(a.getDropMarkWindow());a.dropMark();var va=function(){Ka&&(d.cancel(Ka),Ka=null)};a.addDropMark=function(){var b;
b=h[0];for(var c=null;b;){if(b===document.getElementsByTagName("body")[0]){c=b;break}b=b.offsetParent}if(b=c)angular.element(b).append(a.getDropMarkWindow()),a.dropMark()};a.removeDropMark=function(){a.getDropMarkWindow().remove()};a.isDropInRange=function(b){b=a.getMousePos(b);var c=h[0].getBoundingClientRect();b.x-=angular.element(f)[0].pageXOffset;b.y-=angular.element(f)[0].pageYOffset;var n=c.top+B,c=c.bottom-O;I&&x&&(c-=x[0].offsetHeight);return b.y<n||b.y>c?!1:!0};var G=angular.element('<div style="opacity:0.75;position:absolute;z-index:999"></div>'),
Ab=function(){G&&(G.remove(),G.css("top","-9999999px"),G.css("left","-9999999px"))};a.getCellElemFromRow=function(b){return b&&(b=a.getElemFromRow(b))?a.getChildElement(b,"cell"):null};a.openEditor=function(b,c){if(b)switch(b.type){case "cell":c||(c=a.getColumnById(b[a.options.cellFields.cid]));if(!c){var n=a.getCellColumnIndex(b),t=a.columnsObj.getList();t&&0<=n&&n<t.length&&(c=t[n])}if(c){var n=a.getCellType(b,a.getColumnRealIndex(c)),t=a.getCellRowIndex(b),u=a.getCellColumnIndex(b);if(t=a.getElemFromCell(t,
u,c[a.options.columnFields.fixed]))switch(n){case "checkbox":break;case "combobox":break;case "incell":a.openInCellEditor(t,b,c);break;case "dropdown":a.openDropDownEditor(t,b,c);break;default:0!=b[a.options.cellFields.allowEdit]&&Bb(null,t,0)}}}};a.closeEditor=function(b,c){if(b)switch(b.type){case "cell":if(c||(c=a.getColumnById(b[a.options.cellFields.cid])),c)switch(a.getCellType(b,a.getColumnRealIndex(c))){case "incell":a.closeActiveEditor(b);break;case "dropdown":a.closeActiveEditor(b)}else a.closeActiveEditor()}else a.closeActiveEditor();
e=null};var z=null,b=!1,e=null,ga=null,q=angular.element('<span class="iui-edit-mark"></span>');a.openInCellEditor=function(k,p,n){b&&a.closeActiveEditor(p,!0);Kb();if(p&&n&&(e=p,n='<div ng-include="'+n[a.options.columnFields.editorTemplate]+'"></div>',z=angular.element('<div class="iui-incell-editor"></div>'),z.append(c(n)(g.$parent)),0!=a.callBeforeEdit(p))){k.children().eq(0).append(z);b=!0;ga="incell";yb();z.bind("mousedown",function(a){a.stopPropagation()});z.bind("mouseup",function(a){a.stopPropagation()});
z.bind("click",function(a){a.stopPropagation()});z.bind("keydown",function(b){switch(b.keyCode){case 27:a.closeActiveEditor(e)}b.stopPropagation()});z.bind("keypress",function(a){a.stopPropagation()});z.bind("keyup",function(a){a.stopPropagation()});var t=d(function(){var a=m.getPadding(k[0]),b=parseInt(getComputedStyle(k[0]).width,10)-(a.left+a.right),a=parseInt(getComputedStyle(k[0]).height,10)+2;z.css("width",b+"px");z.css("height",a+"px");z.css("top",k[0].offsetTop+"px");g.$apply();z.children&&
1==z.children().length&&(b=z.children().eq(0),b.children&&1==b.children().length&&b.children().eq(0).css("height",a+"px"));d.cancel(t)},1)}};a.openDropDownEditor=function(k,p,n){b&&a.closeActiveEditor(p,!0);Kb();if(p&&n&&(e=p,n='<div ng-include="'+n[a.options.columnFields.editorTemplate]+'"></div>',z=angular.element('<div class="iui-dropdown-editor"></div>'),z.append(c(n)(g.$parent)),0!=a.callBeforeEdit(p)))var t=d(function(){angular.element(Ua).append(z);z.bind("mousedown",function(a){a.stopPropagation()});
z.bind("mouseup",function(a){a.stopPropagation()});z.bind("click",function(a){a.stopPropagation()});b=!0;ga="dropdown";var a=k[0].getBoundingClientRect(),c=angular.element(f)[0].pageXOffset,p=angular.element(f)[0].pageYOffset,n=d(function(){var b=m.getPadding(k[0]),b=parseInt(getComputedStyle(k[0]).width,10)+(b.left+b.right),t=m.getPadding(z[0]),b=b-(t.left+t.right),t=parseInt(getComputedStyle(z[0]).width,10);b<t&&(b=t);t=a.right-(b+3)+c;z.css("top",a.bottom+p+"px");z.css("left",t+"px");z.css("width",
b+"px");g.$apply();d.cancel(n)},1);d.cancel(t)},1)};a.closeActiveEditor=function(c,p){b=!1;Kb();z&&z.remove();ga=e=null;p||a.callAfterEdit(c)};var Kb=function(){z&&z.unbind("click keydown keypress keyup mousedown mouseup")},Lb=function(a,b){a&&(q.addClass("iui-edit-mark iui-edit-mark-"+b),a.append(q),q.css("left",a[0].offsetLeft+a[0].offsetWidth-q[0].offsetWidth-2+"px"),q.css("top",a[0].offsetTop+(a[0].offsetHeight-q[0].offsetHeight)/2+"px"))},yb=function(){q&&("dropdown"!=ga||"dropdown"==ga&&!b)&&
(q.removeAttr("class"),q.remove())},gc=null,Ja=angular.element('<div class="iui-dropdown-mark"><span></span></div>'),hc=function(a,b){!a||fb&&!b||(a.append(Ja),Ja.css("top",a[0].offsetTop+"px"),Ja.css("left",a[0].offsetLeft+a[0].offsetWidth-Ja[0].offsetWidth+"px"),Ja.css("height",getComputedStyle(a[0]).height))},La=function(a){!Ja||fb&&!a||Ja.remove()};a.getCellType=function(b,c){var n=null,t="label";b&&(n=a.getColumnById(b[a.options.cellFields.cid]));!n&&0<=c&&c<a.columnList.length&&(n=a.columnList[c]);
n&&(t=n[a.options.columnFields.editorType]);return t};var Ua=m.getBodyElem(h[0]),Cb=m.getUniqueId(4),ha=null,fb=!1,Db=0,vd=function(b,p,n){if(Ua&&b.items&&0<b.items.length){b=m.getUniqueId(4);var t=c('<iui-list name="'+b+'" style="position:absolute;top:-99px;height:100px" items="data['+p+"].column."+a.options.columnFields.editorSettings+'.items"></iui-list>')(F);angular.element(Ua).append(t);na.updateLayout(b);var u=d(function(){if(0<t.children().length){var a=t.children().eq(0);0<a.children().length&&
(Db=angular.element(a.children().eq(0))[0].offsetHeight,n&&(n.avgItemHeight=Db))}t.remove();d.cancel(u)},1)}},Va=null,Mb=function(b,p,n,t){var u=a.getCell(n,t);if(u!=gc&&(gc=u,ha&&ha.remove(),Va&&Va.$destroy(),Ua)){Va=g.$new();Va.data=a.columnList[t];e=u;var ma='<iui-list name="'+Cb+'" style="position:absolute;"',ma=ma+(' items="data.'+a.options.columnFields.editorSettings+'.items"'),ma=ma+(' item-icon="data.'+a.options.columnFields.editorSettings+'.itemIcon"'),ma=ma+(' show-icons="data.'+a.options.columnFields.editorSettings+
'.showIcons"'),ma=ma+(' checkbox-settings="data.'+a.options.columnFields.editorSettings+'.checkBoxSettings"'),ma=ma+(' show-check-boxes="data.'+a.options.columnFields.editorSettings+'.checkBoxSettings.showCheckBoxes"');ha=c(ma+(' nav-selection="false" before-select="onCellValueChanging(e, '+n+", "+t+')" after-select="onCellValueChanged(e, '+n+", "+t+')"></iui-list>'))(Va);Db=0;gb&&t<gb.length&&(Db=gb[t].avgItemHeight);var ud=d(function(){angular.element(Ua).append(ha);var c=b[0].getBoundingClientRect(),
t=angular.element(f)[0].pageXOffset,n=angular.element(f)[0].pageYOffset,n=c.bottom+n-1,c=c.left+t,t=b.children().eq(0),e=m.getPadding(t[0]),t=parseInt(getComputedStyle(t[0]).width,10)+(e.left+e.right),e=m.getPadding(ha[0]),t=t-(e.left+e.right);void 0!=p.dropDownWidth&&t<p.dropDownWidth&&(t=p.dropDownWidth);e=void 0!=p.dropDownHeight?p.dropDownHeight:100;void 0!=p.maxDropDownItems&&(e=Db*p.maxDropDownItems);ha.css("top",n+"px");ha.css("left",c+"px");ha.css("width",t+"px");ha.css("height",e+"px");ha.css("z-index",
"999");u&&u[a.options.cellFields.value]&&na.selectedItem(Cb,u[a.options.cellFields.value]);na.updateLayout(Cb);var ma=d(function(){if(u&&u[a.options.cellFields.value]){na.ensureVisible(Cb,u[a.options.cellFields.value]);var b=d(function(){na.focus(Cb,u[a.options.cellFields.value]);d.cancel(b)},1)}d.cancel(ma)},10);Ja&&(La(!0),hc(b,!0));fb=!0;wd();d.cancel(ud)},1)}};a.removeDropDownList=function(a){ha&&(gc=null,ha.remove(),fb=!1,a||La(),ha.unbind("keydown"));Va&&Va.$destroy();e=null};var wd=function(){ha.bind("keydown",
function(b){switch(b.keyCode){case 27:a.removeDropDownList(),La()}})},Bb=function(b,c,n){a.options.labelEdit&&(void 0===n&&(n=500),Ca=d(function(){if(Ca)var a=d(function(){Nb(b,c,!0);d.cancel(a)},n);d.cancel(Ca)},n/3))},Ob=function(){Ca&&(d.cancel(Ca),Ca=null)},hb=null,ib=null,Nb=function(b,c,n){if(a.dragDropStatus())g=y[0].value,a.labelEditStatus(!1),y.unbind("blur focus keydown mousedown"),y.remove(),ib=hb=null;else{var t=a.getRowFromChildElem(c);if(t){var u=a.getRowCurrentIndex(t),e=a.getIndexFromElem(c),
f=a.getCellObject(u,e),g="",g=c.children().eq(0);if(f)if(n){if(0!=a.callBeforeLabelEdit(f)){hb=t;ib=f;a.labelEditStatus(!0);y.unbind("blur focus keydown mousedown");b=parseInt(getComputedStyle(c[0]).width,10)-4;n=parseInt(getComputedStyle(c[0]).height,10)-3;y.css("top",c[0].offsetTop+"px");y.css("left",c[0].offsetLeft+"px");y.css("width",b+"px");y.css("height",n+"px");g.append(y);y[0].value=f[a.options.cellFields.text];y.bind("keydown",function(b){switch(b.keyCode){case 13:f[a.options.cellFields.text]=
y[0].value?y[0].value:"null";Nb(b,c,!1);break;case 27:Nb(b,c,!1)}b.stopPropagation()});y.bind("focus",function(b){var c=angular.element(this);a.callGotFocus(b,hb,ib,!0,c[0].value)});y.bind("blur",function(a){Nb(a)});y.bind("mousedown",function(a){a.stopPropagation()});var h=d(function(){y[0].focus();y[0].select();d.cancel(h)},10)}}else g=y[0].value,a.labelEditStatus(!1),y.unbind("blur focus keydown"),y.remove(),a.updateView(),a.updateFocus(u,e),a.callAfterLabelEdit(f),a.callLostFocus(b,t,f,!0,g),
ib=hb=null}else g=y[0].value,a.labelEditStatus(!1),y.unbind("blur focus keydown mousedown"),y.remove(),a.callAfterLabelEdit(),a.updateView(),a.callLostFocus(b,hb,ib,!0,g),ib=hb=null}};h.bind("mousemove",function(b){if(a.options.enabled&&0===b.button&&ba&&A){a.getColumnCurrentIndex(A);var c=a.getMousePos(b),n=c.y+16,c=c.x+20;X.empty();X.append("<span>"+A[a.options.columnFields.headerText]+"</span>");X.css("top",n+"px");X.css("left",c+"px");X.css("display","block");Oc();b.stopPropagation()}});var Rc=
function(){for(var b=0,c="none";3>b;){if((c=a.getRowElems(c))&&0<c.length)for(var n=0;n<c.length;n++){var t=angular.element(c[n]);Pc(t);for(var t=t.find("td"),u=0;u<t.length;u++){var d=angular.element(t[u]),e=a.getElement(d,"expandbox");e&&e.unbind("click touchend");Qc(d)}}b++;c=1==b?"left":"right"}},Nc=function(){Kb();for(var b=0,c="none";3>b;){var n=a.getRowElems(c);if(n&&0<n.length)for(var t=0;t<n.length;t++){var u=angular.element(n[t]);Pc(u);for(var u=u.find("td"),d=0;d<u.length;d++){var e=angular.element(u[d]),
f=a.getElement(e,"expandbox");f&&f.unbind("click touchend");Qc(e)}}if((n=a.getHeaderElem(c))&&0<n.length)for(t=0;t<n.length;t++)for(u=angular.element(n[t]),u=u.find("td"),d=0;d<u.length;d++)(e=angular.element(u[d]))&&(c=a.getChildElement(e,"column-header-cell"))&&(c=a.getContentElement(c,"filter-button"))&&c.unbind("mousedown");b++;c=1==b?"left":"right"}},Ad=function(){Rc();for(var b=0,c="none";3>b;){if((c=a.getRowElems(c))&&0<c.length)for(var n,t=c.length-1,u=0;u<=t;u++){n=angular.element(c[u]);
xd(n);for(var d=n.find("td"),e=0;e<d.length;e++){var f=angular.element(d[e]);yd(a.getElement(f,"expandbox"));zd(f,a.getRowFromElem(n),e)}}b++;c=1==b?"left":"right"}},ba=!1,A=null,Wa=-1,Pb=function(b,c){if(b){var n=a.getColumnCurrentIndex(b),t=a.getColumnWidth(b);return a.isColumnWithFixedWidth(n)||10<c.x&&c.x<t-10}return!1},kc=function(b){b=b.find("td");for(var c=0;c<b.length;c++)currentElem=angular.element(b[c]),currentElem.bind("click",function(b){if(a.options.enabled&&1===b.which){var c=m.getClientMousePos(b,
this),k=a.getColumnFromElem(this);k&&Pb(k,c)&&a.callColumnClick(k,a.getMousePos(b))}b.stopPropagation()}),currentElem.bind("dblclick",function(b){b.preventDefault();if(a.options.enabled&&1===b.which){var c=m.getClientMousePos(b,this),k=a.getColumnFromElem(this);k&&Pb(k,c)&&a.callColumnDblClick(k,a.getMousePos(b))}b.stopPropagation()}),currentElem.bind("mouseenter",function(b){if(a.options.enabled&&!S&&!ra){var c=a.getColumnFromElem(this);c&&(a.hoverColumn=c,a.refresh(c),a.callColumnHover(c));if(1===
b.which&&ba&&A&&a.hoverColumn&&0!=a.hoverColumn[a.options.columnFields.allowDrop]&&ia&&(ia.remove(),a.hoverColumn!=A)){var k=angular.element(this);k.append(ia);b=parseInt(getComputedStyle(k[0]).height,10);c=parseInt(getComputedStyle(ia[0]).height,10);k=m.getPadding(k[0]);ia.css("top",(b+k.top+k.bottom-c)/2+"px")}}}),currentElem.bind("mouseleave",function(b){!a.options.enabled||S||ra||(a.hoverColumn=null,(b=a.getColumnFromElem(this))&&a.refresh(b),ia&&ia.remove(),S||h.css("cursor","default"))}),currentElem.bind("mousemove",
function(b){if(a.options.enabled){var c=angular.element(this);if(1===b.which&&ba&&A&&a.hoverColumn&&a.hoverColumn!=A&&0!=a.hoverColumn[a.options.columnFields.allowDrop]&&A[a.options.columnFields.fixed]==a.hoverColumn[a.options.columnFields.fixed])c=parseInt(getComputedStyle(c[0]).width,10),ia.empty(),Wa=-1,b.offsetX>c/2?(Wa=2,ia.append('<span class="iui-grid-column-reorder-mark-right"></span>'),ia.css("left","auto"),ia.css("right","0")):(Wa=1,ia.append('<span class="iui-grid-column-reorder-mark-left"></span>'),
ia.css("left","0"),ia.css("right","auto"));else{b=m.getClientMousePos(b,this);var c=parseInt(a.getIndexFromElem(this),10),k=a.getColumnWidth(a.columnList[c]),p=10;a.isFilteringAllowed(a.columnList[c])&&(p=0);10>b.x&&!a.isColumnWithFixedWidth(c-1)&&Sc(c,"left")?(h.css("cursor","ew-resize"),Fa="left"):b.x>k-p&&!a.isColumnWithFixedWidth(c)&&Sc(c,"right")?(h.css("cursor","ew-resize"),Fa="right"):S||(h.css("cursor","default"),Fa="none")}}}),currentElem.bind("mouseup",function(b){if(a.options.enabled){if(1===
b.which&&ba&&A&&a.hoverColumn&&a.hoverColumn!=A&&0!=a.hoverColumn[a.options.columnFields.allowDrop]&&A[a.options.columnFields.fixed]==a.hoverColumn[a.options.columnFields.fixed]&&0!=a.callColumnPosChanging(A,a.hoverColumn)){b=a.columnList[0];0<=a.options.expandColIndex&&a.options.expandColIndex<a.columnList.length&&(b=a.columnList[a.options.expandColIndex]);var c=a.getColumnCurrentIndex(A),c=a.getColumnRealIndex(c),k=a.getColumnCurrentIndex(a.hoverColumn),k=a.getColumnRealIndex(k);c!=k&&(c<k?1==Wa&&
k--:c>k&&2==Wa&&k++,a.columnsObj.moveObject(c,k),a.updateColumnList(),b=a.getColumnCurrentIndex(b),b!=a.options.expandColIndex&&(a.options.expandColIndex=b),a.updateLayout(),a.callColumnPosChanged(A,a.hoverColumn))}A=null;Wa=-1;S=ba=!1;h.css("cursor","default")}}),currentElem.bind("mousedown",function(b){if(a.options.enabled){a.removeDropDownList();a.closeFilterWindow();a.closeEditor();m.getClientMousePos(b,this);var c=parseInt(a.getIndexFromElem(this),10);if(0===b.button&&!S){var k=c,p="none";0<=
c&&c<a.columnList.length&&(p=a.columnList[c][a.options.columnFields.fixed]);switch(Fa){case "left":"right"==p?k=c:(c=ic(k-1,p))?(k=a.getColumnCurrentIndex(c),0<=k&&k<a.columnList.length&&(a.columnList[k][a.options.columnFields.fixed]!=p?(k=-1,S=!1):S=!0)):S=!1;0<=k&&(S=!0);break;case "right":"right"==p?(c=jc(k+1,p))?(k=a.getColumnCurrentIndex(c),0<=k&&k<a.columnList.length&&(a.columnList[k][a.options.columnFields.fixed]!=p?(k=-1,S=!1):S=!0)):S=!1:(k=c,S=!0)}!a.isColumnWithFixedWidth(k)&&S?a.setColumnResizingParams(k,
Fa,a.getMousePos(b).x):S=!1}if(!S&&(k=a.getColumnFromChildElem(this)))switch(p=m.getClientMousePos(b,this),Pb(k,p)&&a.columnSelection(k),b.which){case 1:a.options.allowColumnReorder&&0!=k[a.options.columnFields.allowDrag]&&0==ba&&0!=k[a.options.columnFields.allowGrouping]&&(A=k,a.getMousePos(b),ba=!0,(k=m.getBodyElem(h[0]))&&angular.element(k).append(X));break;case 3:Pb(k,p)&&a.callColumnRightClick(k,a.getMousePos(b))}}b.stopPropagation()}),function(b){b&&(b=a.getChildElement(b,"column-header-cell"))&&
(b=a.getContentElement(b,"filter-button"))&&b.bind("mousedown",function(a){1==a.which&&Bd(this);a.stopPropagation()})}(currentElem)},oa=null,Bd=function(b){a.closeFilterWindow();var p=a.getColumnFromChildElem(b);if(p){var n=angular.element(b),t=n.parent().parent();if(Ua){b='<div ng-include="'+p[a.options.columnFields.filterTemplate]+'"></div>';oa=angular.element('<div class="iui-filter-window"></div>');oa.append(c(b)(g.$parent));var u=d(function(){angular.element(Ua).append(oa);oa.bind("mousedown",
function(a){a.stopPropagation()});n[0].getBoundingClientRect();var a=t[0].getBoundingClientRect(),b=angular.element(f)[0].pageXOffset,c=angular.element(f)[0].pageYOffset,k=d(function(){var t=a.bottom+c,p=a.right-(parseInt(getComputedStyle(oa[0]).width,10)+3)+b;oa.css("top",t+"px");oa.css("left",p+"px");d.cancel(k)},1);d.cancel(u)},1)}}};a.closeFilterWindow=function(){oa&&(oa.unbind("mousedown"),oa.remove())};var Pc=function(a){a&&a.unbind("blur dragover dragend focus keydown keyup keypress mousedown mouseenter mouseleave")},
xd=function(b){b&&(b.bind("dragover",function(b){var c=a.getRowFromElem(this);if(c&&a.isRowEnabled(c)){if(a.isScrollBarVisible("vertical")){var c=a.getMousePos(b),k=h[0].getBoundingClientRect();c.x-=angular.element(f)[0].pageXOffset;c.y-=angular.element(f)[0].pageYOffset;var u=k.top+B+25,k=k.bottom-O-25;I&&x&&(k-=x[0].offsetHeight);c.y<u?Qb(!1):c.y>k?Qb(!0):jb()}else jb();b.stopPropagation()}}),b.bind("dragend",function(b){var c=a.getRowFromElem(this);c&&a.isRowEnabled(c)&&(b.preventDefault(),a.dragDropStatus(!1),
a.dropMark(),r.getData().source||r.clearData())}),b.bind("mouseenter",function(b){if(!ra){var c=a.getRowFromElem(this);c&&a.isRowEnabled(c)&&!ba&&(a.hoverRow=c,a.refresh(c),a.callRowHover(b,c),a.options.hoverSelection&&(Da=d(function(){Da&&a.rowSelection(c,b.shiftKey,b.ctrlKey,b.metaKey)},500)))}}),b.bind("mouseleave",function(b){ra||(a.hoverRow=null,(b=a.getRowFromElem(this))&&a.isRowEnabled(b)&&a.refresh(b),Da&&(d.cancel(Da),Da=null))}),b.bind("keydown",function(b){var c=a.getRowFromElem(this);
if(c&&a.isRowEnabled(c)){var k=!0;a.callKeyDown(b,c);var u=a.getRowCurrentIndex(c);switch(b.keyCode){case 9:Tc(b,c,u);break;case 16:a.updateSelectionStatus("shift");break;case 17:a.updateSelectionStatus("ctrl");break;case 27:k=!1;break;case 33:Uc(b,u);break;case 34:Vc(b,u);break;case 35:Wc(b,u);break;case 36:Xc(b,u);break;case 37:Yc(b,c,u);break;case 32:Zc(b,c);break;case 38:lc(b,u);break;case 39:$c(b,c,u);break;case 40:mc(b,u);break;default:(b.ctrlKey||b.metaKey)&&a.updateSelectionStatus("ctrl"),
b.shiftKey&&a.updateSelectionStatus("shift")}k&&b.stopPropagation()}}),b.bind("keyup",function(b){var c=a.getRowFromElem(this);if(c&&a.isRowEnabled(c)){switch(b.keyCode){case 16:a.multiSelection(!1);break;case 17:a.multiSelection(!1);break;default:b.ctrlKey||b.metaKey||a.multiSelection(!1),b.shiftKey||a.multiSelection(!1)}a.callKeyUp(b,c)}}),b.bind("keypress",function(b){var c=a.getRowFromElem(this);c&&a.isRowEnabled(c)&&a.callKeyPress(b,c)}),b.bind("mousedown",function(b){a.removeDropDownList();
a.closeFilterWindow();a.closeEditor()}),b.bind("focus",function(b){var c=a.getRowFromElem(this);c&&a.isRowEnabled(c)?a.callGotFocus(b,c):a.updateFocus()}),b.bind("blur",function(b){var c=a.getRowFromElem(this);c&&a.isRowEnabled(c)&&a.callLostFocus(b,c)}))},yd=function(b){b&&(b.bind("click",function(b){var c=a.getRowFromChildElem(this);c&&a.isRowEnabled(c)&&(a.toggle(c),a.updateFocus(a.getRowCurrentIndex(c),a.options.expandColIndex),b.stopPropagation())}),b.bind("touchend",function(b){b.preventDefault();
var c=a.getRowFromChildElem(this);c&&a.isRowEnabled(c)&&(a.toggle(c),a.updateFocus(a.getRowCurrentIndex(c),a.options.expandColIndex),b.stopPropagation())}))},Rb={x:0,y:0},kb={x:0,y:0},lb=!1,nc=!1,Ga=null,ad=function(){return{x:angular.element(f)[0].pageXOffset,y:angular.element(f)[0].pageYOffset}},mb=function(a){var b=ad();return{x:a.x-b.x,y:a.y-b.y}},zd=function(c,p,n){c&&(c.bind("dragstart",function(b){if(a.labelEditStatus())b.preventDefault();else{document.activeElement&&document.activeElement.blur();
r.clearData();var c=a.getRowFromChildElem(this);if(c&&a.isRowEnabled(c))if(Ob(),a.isDragAllowed(c)){a.dragDropStatus(!0);a.addDropMark();b.dataTransfer?(b.dataTransfer.effectAllowed="move",b.dataTransfer.setData("text",c[a.options.rowFields.id]?c[a.options.rowFields.id].toString():"")):b.originalEvent&&b.originalEvent.dataTransfer&&(b.originalEvent.dataTransfer.effectAllowed="move",b.originalEvent.dataTransfer.setData("text",c[a.options.rowFields.id]?c[a.options.rowFields.id].toString():""));b={source:c,
sourceCtrl:a,sourceCollection:a.rowsObj};switch(a.options.selectionMode){case "multi-simple":b.source=a.options.selectedRows;break;case "multi-extended":b.source=a.options.selectedRows}r.setData(b)}else b.dataTransfer?b.dataTransfer.effectAllowed="none":b.originalEvent&&b.originalEvent.dataTransfer&&(b.originalEvent.dataTransfer.effectAllowed="none")}}),c.bind("dragover",function(b){var c=a.getRowFromChildElem(this);if(c&&a.isRowEnabled(c)){var k=angular.element(this);b.preventDefault();var p=!0;
b.dataTransfer?p="none"===b.dataTransfer.effectAllowed?!1:!0:b.originalEvent&&b.originalEvent.dataTransfer&&(p="none"===b.originalEvent.dataTransfer.effectAllowed?!1:!0);if(p&&(c=a.getRowFromChildElem(k))){var p=k[0].getBoundingClientRect(),d=angular.element(f)[0].pageXOffset,n=angular.element(f)[0].pageYOffset,e=a.getMousePos(b);e.x-=p.left+d;e.y-=p.top+n;k=r.getDropPos(e,{x:0,y:0,width:k[0].offsetWidth,height:k[0].offsetHeight},!0);d=r.getData();p=a.isDropAllowed(d.source,c,k);n={event:b,sourceCtrl:d.sourceCtrl?
d.sourceCtrl.getGridName():"",dragRow:d.source,targetCtrl:a.getGridName(),targetRow:c,isDropAllowed:p,dropPos:k,mousePos:a.getMousePos(b)};n=a.callDragOver(n);if(p&&!1!==n){n=a.getMousePos(b);b=n.y+16;n=n.x+20;e=a.getDropMarkWindow();e.empty();var g="";switch(k){case 1:g="iui-drop-marker-move-up";break;case 2:g="iui-drop-marker-move-down"}e.append("<span class='"+g+"'></span><span class='iui-drop-marker-title'>"+c[a.options.rowFields.text]+"</span>");a.updateDropMarkElem(a.getDropMarkWindow(),{top:b,
left:n});a.dropMark(p);r.setData({source:d.source,sourceList:d.sourceList,target:c,dropPos:k})}else b.dataTransfer?b.dataTransfer.dropEffect="none":b.originalEvent&&b.originalEvent.dataTransfer&&(b.originalEvent.dataTransfer.dropEffect="none"),a.dropMark()}}}),c.bind("drop",function(b){var c=a.getRowFromChildElem(this);if(c&&a.isRowEnabled(c)){var k=angular.element(this);b.preventDefault();va();a.dropMark();c=!0;b.dataTransfer?c="none"===b.dataTransfer.effectAllowed?!1:!0:b.originalEvent&&b.originalEvent.dataTransfer&&
(c="none"===b.originalEvent.dataTransfer.effectAllowed?!1:!0);if(c){var p=a.getRowFromChildElem(k);if(p){var k=r.getData(),d=k.source;d||(d=a.getDnDSource(b));if(c=a.isDropAllowed(d,p,k.dropPos))a.toggle(p,!0),d&&(c={event:b,sourceCtrl:k.sourceCtrl?k.sourceCtrl.getGridName():"",dragRow:d,targetCtrl:a.getGridName(),targetRow:p,isDropAllowed:c,dropPos:k.dropPos,mousePos:a.getMousePos(b)},!1!==a.callDragDrop(c)&&(a.drop(k),g.$$phase||g.$apply()))}}r.clearData();b.stopPropagation()}}),c.bind("dragenter",
function(b){var c=a.getRowFromChildElem(this);if(c&&a.isRowEnabled(c)){b.preventDefault();if(a.options.autoExpand)var k=d(function(){Ka||(Ka=d(function(){Ka&&a.toggle(c,!0)},750));d.cancel(k)},1);var p=r.getData();p.source||(p.source=a.getDnDSource(b));p={event:b,sourceCtrl:p.sourceCtrl?p.sourceCtrl.getGridName():"",dragRow:p.source,targetCtrl:a.getGridName(),targetRow:p.target,mousePos:a.getMousePos(b)};a.callDragEnter(p);b.stopPropagation()}}),c.bind("dragleave",function(b){a.hoverRow=null;var c=
a.getRowFromChildElem(this);c&&a.isRowEnabled(c)&&(b.preventDefault(),va(),c=r.getData(),c.source||(c.source=a.getDnDSource(b)),c={event:b,sourceCtrl:c.sourceCtrl?c.sourceCtrl.getGridName():"",dragRow:c.source,targetCtrl:a.getGridName(),targetRow:c.target,mousePos:a.getMousePos(b)},a.callDragLeave(c),b.stopPropagation())}),c.bind("touchstart",function(c){var k=a.getRowFromChildElem(this);if(k&&a.isRowEnabled(k)&&(c.preventDefault(),(k=a.getTouchData(c))&&0<k.length)){nc=!0;var p=d(function(){nc=!1;
d.cancel(p)},750);Rb=mb({x:k[0].pageX,y:k[0].pageY});a.closeFilterWindow();k=Rb;if((k=a.getRowAt(k.x,k.y))&&a.isRowEnabled(k)){var n=angular.element(this);a.mouseButtonStatus(!0);Ga=k;var f=a.getRowCurrentIndex(k),g=parseInt(a.getIndexFromElem(this),10),h=a.getCell(f,g),m=a.getCellType(h,g),l=null,q=a.options.editorSettings;n[0].focus();a.updateFocus(f,g);h&&(l=a.getColumnById(h[a.options.cellFields.cid]));!l&&0<=g&&g<a.columnList.length&&(l=a.columnList[g]);var r="click"==a.options.editorSettings.activate;
l&&l[a.options.columnFields.editorSettings]&&(q=l[a.options.columnFields.editorSettings],r=void 0!=q.activate?"click"==q.activate:r);h&&h!=e?a.closeEditor(e):a.closeEditor();switch(m){case "checkbox":break;case "combobox":a.rowSelection(k,c.shiftKey,c.ctrlKey,c.metaKey);h&&0!=h[a.options.cellFields.allowEdit]&&l&&r?Mb(angular.element(this),q,f,g):a.removeDropDownList();break;case "incell":a.rowSelection(k,c.shiftKey,c.ctrlKey,c.metaKey);!b&&h&&0!=h[a.options.cellFields.allowEdit]&&r&&a.openInCellEditor(n,
h,l);break;case "dropdown":a.rowSelection(k,c.shiftKey,c.ctrlKey,c.metaKey);!b&&h&&0!=h[a.options.cellFields.allowEdit]&&r&&a.openDropDownEditor(n,h,l);break;default:a.rowSelection(k,c.shiftKey,c.ctrlKey,c.metaKey),a.removeDropDownList(),h&&0!=h[a.options.cellFields.allowEdit]&&r&&Bb(c,angular.element(this))}}}}),c.bind("touchmove",function(b){var c,k,p=a.getRowFromChildElem(this);if(p&&a.isRowEnabled(p)&&(p=a.getTouchData(b))&&0<p.length){kb=mb({x:p[0].pageX,y:p[0].pageY});var p=Math.abs(kb.x-Rb.x),
d=Math.abs(kb.y-Rb.y),n=h[0].getBoundingClientRect();if(r.hitTest(kb.x,kb.y,n)){if(b.preventDefault(),G&&G.css("display","block"),!nc)if(!lb&&(2<p||2<d)&&Ga&&a.isRowEnabled(Ga))if(angular.element(this),a.labelEditStatus())b.preventDefault();else{lb=!0;r.clearData();if((p=a.getTouchData(b))&&0<p.length&&(mb({x:p[0].pageX,y:p[0].pageY}),Ga&&a.isRowEnabled(Ga)&&(Ob(),a.isDragAllowed(Ga)))){a.dragDropStatus(!0);a.addDropMark();p={source:Ga,sourceCtrl:a,sourceCollection:a.rowsObj};switch(a.options.selectionMode){case "multi-simple":p.source=
a.options.selectedRows;break;case "multi-extended":p.source=a.options.selectedRows}r.setData(p);if(p=a.getCellElemFromRow(Ga))if(p=a.getContentElement(p))G.empty(),G.append(p.clone()),G.css("display","none"),h.append(G)}b.stopPropagation()}else if(lb&&(angular.element(this),b.preventDefault(),(d=a.getTouchData(b))&&0<d.length)){var p=ad(),e=mb({x:d[0].pageX,y:d[0].pageY});if(d=a.getRowAt(e.x,e.y)){var f=a.getCellElemFromRow(d);if(f){var n=f[0].getBoundingClientRect(),f=r.getDropPos({x:e.x-n.left,
y:e.y-n.top},{x:0,y:0,width:f[0].offsetWidth,height:f[0].offsetHeight},!0),n=r.getData(),m=a.isDropAllowed(n.source,d,f);b={event:b,sourceCtrl:n.sourceCtrl?n.sourceCtrl.getGridName():"",dragRow:n.source,targetCtrl:a.getGridName(),targetRow:d,isDropAllowed:m,dropPos:f,mousePos:e};k=h[0].getBoundingClientRect();c=e.x-k.left;k=e.y-k.top;G.css("top",k-16+"px");G.css("left",c+"px");G.css("display","block");b=a.callDragOver(b);if(m&&0!=b){b=e.y+p.y+16;p=e.x+p.x+20;e=a.getDropMarkWindow();e.empty();c="iui-drop-marker-move-in";
switch(f){case 1:c="iui-drop-marker-move-up";break;case 2:c="iui-drop-marker-move-down"}e.append("<span class='"+c+"'></span><span class='iui-drop-marker-title'>"+d[a.options.rowFields.text]+"</span>");a.updateDropMarkElem(a.getDropMarkWindow(),{top:b,left:p});a.dropMark(m);r.setData({source:n.source,sourceList:n.sourceList,target:d,dropPos:f})}else a.dropMark(),G&&G.css("display","none")}}else n=h[0].getBoundingClientRect(),d=n.top+B,n=n.bottom-O,I&&x&&(n-=x[0].offsetHeight),!a.options.allowDrop||
e.y<d||e.y>n?(a.dropMark(),G&&G.css("display","none")):(k=h[0].getBoundingClientRect(),c=e.x-k.left,k=e.y-k.top,G.css("top",k-16+"px"),G.css("left",c+"px"),G.css("display","block"),d=r.getData(),n={source:d.source,sourceCtrl:d.sourceCtrl,target:null,dropPos:-1},r.setData(n),b={event:b,sourceCtrl:d.sourceCtrl?d.sourceCtrl.getGridName():"",dragRow:d.source,targetCtrl:a.getGridName(),targetRow:null,isDropAllowed:a.options.allowDrop,dropPos:-1,mousePos:e},b=a.callDragOver(b),0==b?a.dropMark():(b=e.y+
p.y+16,p=e.x+p.x+20,e=a.getDropMarkWindow(),e.empty(),e.append("<span class='iui-drop-marker-move-end'></span><span class='iui-drop-marker-title'>"+(g.name?g.name:"Grid")+"</span>"),a.updateDropMarkElem(a.getDropMarkWindow(),{top:b,left:p}),a.dropMark(!0)))}}else b.preventDefault(),a.dropMark(),a.cancelScrollTimer(),G&&G.css("display","none")}}),c.bind("touchend",function(b){var c=a.getRowFromChildElem(this);if(c&&a.isRowEnabled(c)){if((c=a.getTouchData(b))&&0<c.length){var c=mb({x:c[0].pageX,y:c[0].pageY}),
k=h[0].getBoundingClientRect();if(r.hitTest(c.x,c.y,k))if(lb){angular.element(this);b.preventDefault();va();a.dropMark();Ab();if((c=a.getTouchData(b))&&0<c.length){var c=mb({x:c[0].pageX,y:c[0].pageY}),p=a.getRowAt(c.x,c.y);if(p){var k=r.getData(),d=k.source,n=a.isDropAllowed(d,p,k.dropPos);n&&(a.toggle(p,!0),d&&(c={event:b,sourceCtrl:k.sourceCtrl?k.sourceCtrl.getGridName():"",dragRow:d,targetCtrl:a.getGridName(),targetRow:p,isDropAllowed:n,dropPos:k.dropPos,mousePos:c},c=a.callDragDrop(c),!1!==c&&
(a.drop(k),g.$$phase||g.$apply())))}else a.dropMark(),p=h[0].getBoundingClientRect(),k=p.top+B,p=p.bottom-O,I&&x&&(p-=x[0].offsetHeight),c.y>=k&&c.y<=p&&(k=r.getData(),k.source&&(c={event:b,sourceCtrl:k.sourceCtrl?k.sourceCtrl.getGridName():"",dragRow:k.source,targetCtrl:a.getGridName(),targetRow:null,isDropAllowed:a.options.allowDrop,dropPos:-1,mousePos:c},c=a.callDragDrop(c),!1!==c&&(a.drop(k),g.$$phase||g.$apply())))}r.clearData();a.dragDropStatus(!1);b.stopPropagation()}else a.mouseButtonStatus(!1),
(c=a.getRowFromChildElem(this))&&a.isRowEnabled(c)&&a.updateSelection(b,c,b.shiftKey),Ob()}c=lb;a.removeDropMark();Ab();kb={x:0,y:0};lb=!1;Ga=null;c&&b.stopPropagation()}}),c.bind("dblclick",function(c){var k=a.getRowFromChildElem(this);if(k&&a.isRowEnabled(k)){var p=angular.element(this);c.preventDefault();if(1===c.which){var d=a.getRowCurrentIndex(k),n=parseInt(a.getIndexFromElem(this),10),e=a.getCell(d,n),f=a.getCellType(e,n),g=null,h=a.options.editorSettings;e&&(g=a.getColumnById(e[a.options.cellFields.cid]));
!g&&0<=n&&n<a.columnList.length&&(g=a.columnList[n]);var m="dblclick"==a.options.editorSettings.activate;g&&g[a.options.columnFields.editorSettings]&&(h=g[a.options.columnFields.editorSettings],m=void 0!=h.activate?"dblclick"==h.activate:m);switch(f){case "checkbox":break;case "combobox":e&&0!=e[a.options.cellFields.allowEdit]&&g&&m?Mb(angular.element(this),h,d,n):a.removeDropDownList();break;case "incell":!b&&e&&0!=e[a.options.cellFields.allowEdit]&&m&&a.openInCellEditor(p,e,g);break;case "dropdown":!b&&
e&&0!=e[a.options.cellFields.allowEdit]&&m&&a.openDropDownEditor(p,e,g);break;default:a.removeDropDownList(),e&&0!=e[a.options.cellFields.allowEdit]&&m&&Bb(c,angular.element(this),0)}0!=a.callRowDblClick(k,a.getMousePos(c))&&"checkbox"!=f&&"checkbox"!=f&&e&&!m&&(a.toggle(k),a.updateFocus(d,n))}c.stopPropagation()}}),c.bind("mouseenter",function(c){if(!ra){var k=a.getRowFromChildElem(this);if(k&&a.isRowEnabled(k)&&!ba){var p=a.getRowCurrentIndex(k),d=parseInt(a.getIndexFromElem(this),10);if(p=a.getCell(p,
d))if(a.hoverCell=p,a.refresh(k),a.callCellHover(c,p),c=angular.element(this),p&&0!=p[a.options.cellFields.allowEdit])switch(d=a.getCellType(p,d),d){case "combobox":fb||hc(c);break;case "incell":b&&p==e||Lb(c,d);break;case "dropdown":b&&p!=e||Lb(c,d);break;default:La(),yb()}else La()}}}),c.bind("mouseleave",function(b){if(!ra&&(a.hoverCell=null,(b=a.getRowFromChildElem(this))&&a.isRowEnabled(b))){b=a.getRowCurrentIndex(b);var c=parseInt(a.getIndexFromElem(this),10);a.getCell(b,c)&&(La(),yb())}}),
c.bind("keydown",function(c){var k=a.getRowFromChildElem(this);if(k&&a.isRowEnabled(k)){var p=!0,d=angular.element(this);a.callKeyDown(c,k);var n=a.getRowCurrentIndex(k),e=parseInt(a.getIndexFromElem(this),10),f=a.getCell(n,e),g=a.getCellType(f,e),h=a.getColumnById(f[a.options.cellFields.cid]);!h&&0<=e&&e<a.columnList.length&&(h=a.columnList[e]);switch(c.keyCode){case 9:Tc(c,k,n,e);break;case 13:switch(g){case "checkbox":bd(f,e);break;case "combobox":f&&0!=f[a.options.cellFields.allowEdit]?h&&Mb(angular.element(this),
h[a.options.columnFields.editorSettings],n,e):a.removeDropDownList();break;case "incell":!b&&f&&0!=f[a.options.cellFields.allowEdit]&&a.openInCellEditor(d,f,h);break;case "dropdown":!b&&f&&0!=f[a.options.cellFields.allowEdit]&&a.openDropDownEditor(d,f,h);break;default:f&&0!=f[a.options.cellFields.allowEdit]&&Bb(c,angular.element(this),0)}break;case 16:a.updateSelectionStatus("shift");break;case 17:a.updateSelectionStatus("ctrl");break;case 27:p=!1;break;case 33:Uc(c,n,e);break;case 34:Vc(c,n,e);break;
case 35:Wc(c,n,e);break;case 36:Xc(c,n,e);break;case 37:Yc(c,k,n,e);break;case 32:Zc(c,k,f,e);break;case 38:lc(c,n,e);break;case 39:$c(c,k,n,e);break;case 40:mc(c,n,e);break;default:(c.ctrlKey||c.metaKey)&&a.updateSelectionStatus("ctrl"),c.shiftKey&&a.updateSelectionStatus("shift")}p&&c.stopPropagation()}}),c.bind("keyup",function(b){var c=a.getRowFromChildElem(this);if(c&&a.isRowEnabled(c)){switch(b.keyCode){case 16:a.multiSelection(!1);break;case 17:a.multiSelection(!1);break;default:b.ctrlKey||
b.metaKey||a.multiSelection(!1),b.shiftKey||a.multiSelection(!1)}a.callKeyUp(b,c);b.stopPropagation()}}),c.bind("keypress",function(b){var c=a.getRowFromChildElem(this);c&&a.isRowEnabled(c)&&(a.callKeyPress(b,c),b.stopPropagation())}),c.bind("click",function(b){var c=a.getRowFromChildElem(this);if(c&&a.isRowEnabled(c)){if(1===b.which){var k=a.getRowCurrentIndex(c),p=parseInt(a.getIndexFromElem(this),10),k=a.getCell(k,p);a.callCellClick(b,c,k,a.getMousePos(b));a.callRowClick(b,c,a.getMousePos(b))}b.stopPropagation()}}),
c.bind("mousedown",function(c){a.closeFilterWindow();var k=a.getRowFromChildElem(this);if(k&&a.isRowEnabled(k)){var p=angular.element(this);a.mouseButtonStatus(!0);switch(c.which){case 1:var d=a.getRowCurrentIndex(k),n=parseInt(a.getIndexFromElem(this),10),f=a.getCell(d,n),g=a.getCellType(f,n),h=null,m=a.options.editorSettings;f&&(h=a.getColumnById(f[a.options.cellFields.cid]));!h&&0<=n&&n<a.columnList.length&&(h=a.columnList[n]);var l="click"==a.options.editorSettings.activate;h&&h[a.options.columnFields.editorSettings]&&
(m=h[a.options.columnFields.editorSettings],l=void 0!=m.activate?"click"==m.activate:l);f&&f!=e?a.closeEditor(e):a.closeEditor();switch(g){case "checkbox":break;case "combobox":a.rowSelection(k,c.shiftKey,c.ctrlKey,c.metaKey);f&&0!=f[a.options.cellFields.allowEdit]&&h&&l?Mb(angular.element(this),m,d,n):a.removeDropDownList();break;case "dropdown":a.rowSelection(k,c.shiftKey,c.ctrlKey,c.metaKey);!b&&f&&0!=f[a.options.cellFields.allowEdit]&&l&&a.openDropDownEditor(p,f,h);break;case "incell":a.rowSelection(k,
c.shiftKey,c.ctrlKey,c.metaKey);!b&&f&&0!=f[a.options.cellFields.allowEdit]&&l&&a.openInCellEditor(p,f,h);break;default:if("image"==g?0!=m.allowSelection:1)a.rowSelection(k,c.shiftKey,c.ctrlKey,c.metaKey),a.removeDropDownList(),f&&0!=f[a.options.cellFields.allowEdit]&&l&&Bb(c,angular.element(this))}break;case 3:a.rowSelection(k,c.shiftKey,c.ctrlKey,c.metaKey),a.callRowRightClick(k,a.getMousePos(c))}c.stopPropagation()}}),c.bind("mouseup",function(b){a.mouseButtonStatus(!1);if(1==b.which){var c=a.getRowFromChildElem(this);
if(c&&a.isRowEnabled(c)){var k=a.getRowCurrentIndex(c),p=parseInt(a.getIndexFromElem(this),10),k=a.getCell(k,p),n=a.getCellType(k,p),d=null,e=a.options.editorSettings;k&&(d=a.getColumnById(k[a.options.cellFields.cid]));!d&&0<=p&&p<a.columnList.length&&(d=a.columnList[p]);d&&d[a.options.columnFields.editorSettings]&&(e=d[a.options.columnFields.editorSettings]);("image"==n?0!=e.allowSelection:1)&&a.updateSelection(b,c,b.shiftKey)}Ob()}}),c.bind("focus",function(c){var k=a.getRowFromChildElem(this);
if(k&&a.isRowEnabled(k)){var p=a.getRowCurrentIndex(k),d=parseInt(a.getIndexFromElem(this),10),p=a.getCell(p,d);a.callGotFocus(c,k,p);if(p&&0!=p[a.options.cellFields.allowEdit])switch(c=angular.element(this),d=a.getCellType(p,d),d){case "combobox":fb||hc(c);break;case "incell":b||Lb(c,d);break;case "dropdown":b||Lb(c,d);break;default:La()}else La()}}),c.bind("blur",function(b){var c=a.getRowFromChildElem(this);if(c&&a.isRowEnabled(c)){var k=a.getRowCurrentIndex(c),p=parseInt(a.getIndexFromElem(this),
10),k=a.getCell(k,p);a.callLostFocus(b,c,k)}}))},Qc=function(a){a&&a.unbind("blur click dragstart dragover drop dragenter dragleave dblclick focus keydown keypress keyup mouseenter mouseleave mousemove mousedown mouseup touchstart touchmove touchend")};a.getTopRow=function(){return a.isRowIndexInRange(D-1)?a.currentList[D]:0<a.currentList.length?a.currentList[0]:null};a.getFooterElem=function(a){switch(a){case "left":return pa;case "right":return ca}return wa};a.getHeaderElem=function(a){switch(a){case "left":return da;
case "right":return T}return ja};a.getRowElems=function(a){switch(a){case "left":return Ma?Ma.find("tr"):null;case "right":return Na?Na.find("tr"):null}return ka?ka.find("tr"):null};var Tc=function(b,c,d,t){var e=a.currentList.length;0<e&&(b.shiftKey?m.isEqual(c[a.options.rowFields.id],a.currentList[0][a.options.rowFields.id])||lc(b,d,t):m.isEqual(c[a.options.rowFields.id],a.currentList[e-1][a.options.rowFields.id])||mc(b,d,t))},mc=function(b,c,n){b.preventDefault();focusDelayTime=0;var t=c,e=D+la-
2,e=e<a.currentList.length-1?e:a.currentList.length-1;t>=e&&K&&(a.setScrollPos({x:a.scrollPos.x,y:a.scrollPos.y+Math.floor(h[0].clientHeight/4)}),focusDelayTime=1);if(t=a.getNextRow(t)){c=a.getRowCurrentIndex(t);c>e&&K&&(a.ensureVisible(t,"bottom"),focusDelayTime=100);a.rowSelection(t,b.shiftKey,b.ctrlKey,b.metaKey);var f=d(function(){a.updateFocus(c,n);d.cancel(f)},focusDelayTime)}},lc=function(b,c,n){b.preventDefault();focusDelayTime=0;var e=D,e=0<e?e:0;c==e&&K&&(a.setScrollPos({x:a.scrollPos.x,
y:a.scrollPos.y-Math.floor(h[0].clientHeight/4)}),focusDelayTime=1);var f=a.getPrevRow(c);if(f){c=a.getRowCurrentIndex(f);c<e&&K&&(a.ensureVisible(f,"bottom"),focusDelayTime=100);a.rowSelection(f,b.shiftKey,b.ctrlKey,b.metaKey);var g=d(function(){a.updateFocus(c,n);d.cancel(g)},focusDelayTime)}},$c=function(b,c,n,e){b.preventDefault();if((void 0===e||0<=e&&e==a.options.expandColIndex)&&!a.isRowExpanded(c)&&c[a.options.rowFields.rows]&&0<c[a.options.rowFields.rows].length)a.toggle(c,!0),a.updateFocus(n,
e);else if(0<=e){focusDelayTime=0;var f=e+1;b=a.columnList.length-1;f===b&&(focusDelayTime=1);if(0<=f&&f<=b){b=m.getPageRect(h);c=a.getElemFromCell(n,f);c=m.getPageRect(c);c.left+c.width>b.left+b.width&&(b=a.scrollPos,b.x+=c.width,a.setScrollPos(b));var g=d(function(){a.updateFocus(n,f);d.cancel(g)},focusDelayTime)}}},Yc=function(b,c,n,e){b.preventDefault();if((void 0===e||0<=e&&e==a.options.expandColIndex)&&a.isRowExpanded(c)&&c[a.options.rowFields.rows]&&0<c[a.options.rowFields.rows].length)a.toggle(c,
!1),a.updateFocus(n,e);else if(0<=e){focusDelayTime=0;var f=1<e?e-1:0;if(0<=f){b=m.getPageRect(h);c=a.getElemFromCell(n,f);c=m.getPageRect(c);c.left<b.left&&(b=a.scrollPos,b.x-=c.width,a.setScrollPos(b));var g=d(function(){a.updateFocus(n,f);d.cancel(g)},focusDelayTime)}}},Uc=function(b,c,n){b.preventDefault();var e=c-la,e=0<e?e:0;if(e!==c){focusDelayTime=1;var f=a.getPrevRow(e+1);if(f){a.scrollTo(f);a.rowSelection(f,b.shiftKey,b.ctrlKey,b.metaKey);g.$apply();var h=d(function(){a.updateFocus(a.getRowCurrentIndex(f),
n);d.cancel(h)},focusDelayTime)}}},Vc=function(b,c,n){b.preventDefault();var e=c+la;a.options.showHeader&&e--;a.options.showFooter&&e--;e=e<a.currentList.length-1?e:a.currentList.length-1;if(e!==c){focusDelayTime=1;var f=a.getNextRow(e-1);if(f){a.scrollTo(f,"bottom");a.rowSelection(f,b.shiftKey,b.ctrlKey,b.metaKey);g.$apply();var h=d(function(){a.updateFocus(a.getRowCurrentIndex(f),n);d.cancel(h)},focusDelayTime)}}},Wc=function(b,c,n){b.preventDefault();a.setScrollPos({x:a.scrollPos.x,y:L.y});var e=
a.getLastRow();if(e){a.rowSelection(e,b.shiftKey,b.ctrlKey,b.metaKey);var f=d(function(){a.updateFocus(a.getRowCurrentIndex(e),n);d.cancel(f)},1)}},Xc=function(b,c,n){b.preventDefault();a.setScrollPos({x:a.scrollPos.x,y:0});var e=a.getFirstRow();if(e){a.rowSelection(e,b.shiftKey,b.ctrlKey,b.metaKey);var f=d(function(){a.updateFocus(a.getRowCurrentIndex(e),n);d.cancel(f)},1)}},bd=function(b,c){if(b&&0!=b[a.options.cellFields.allowEdit]){var d=a.getColumnById(b[a.options.cellFields.cid]);!d&&0<=c&&
c<a.columnList.length&&(d=a.columnList[c]);if(d){var e=b[a.options.cellFields.value];if((d=d[a.options.columnFields.editorSettings])&&1==d.threeState)switch(m.isString(e)||(e="unchecked"),e){case "checked":e="unchecked";break;case "indeterminate":e="checked";break;default:e="indeterminate"}else e=m.isBoolean(e)?!e:!0;b[a.options.cellFields.value]=e;g.$apply()}}},Zc=function(b,c,d,e){b.preventDefault();bd(d,e);a.rowSelection(c,b.shiftKey,b.ctrlKey,b.metaKey,c.selected);g.$apply()},ka=null,sa=angular.element('<div class="iui-grid-block iui-grid-block-top"></div>'),
ja=null,Ha=angular.element('<div class="iui-grid-block iui-grid-block-left"></div>'),Q=0,nb=0,da=null,pa=null,Ma=null,xa=angular.element('<div class="iui-grid-block iui-grid-block-right"></div>'),ya=0,ob=0,T=null,ca=null,Na=null,ta=angular.element('<div class="iui-grid-block iui-grid-block-bottom"></div>'),wa=null,D=0,F=null,v=null,H=100,U=0,la=0,Xa=0,Sb=0,B=0,O=0,pb=0,Tb=!1,ra=!1,Eb=9,Fb=9,Ub=0,za=0,Oa=0,Ya=1,Vb=0,Wb=0,Pa=0,qb=0,Xb=1,N=null,V=null,I=!1,K=!1;this.scrollMousePos=null;var L={x:0,y:0},
gb=[];g.verScrollVisibility=!1;g.$watch("verScrollVisibility",function(b,c){b!=c&&a.updateCurrentLayout()});a.getColumnWidth=function(b){var c=100;b&&b[a.options.columnFields.width]&&(c=b[a.options.columnFields.width],m.isPercent(c)?(b=h[0].clientWidth-2*a.columnList.length,K&&J&&(b-=J[0].offsetWidth),c=Math.floor(parseInt(c,10)/100*b)):m.isString&&(c=parseInt(c,10)));return c};var Gb=function(b){var c=0;if((b=a.getRowElems(b))&&0<b.length&&(b=angular.element(b[0]))&&(b=b.find("td"))&&0<b.length)for(var d=
0;d<b.length;d++)var e=angular.element(b[d]),c=c+e[0].offsetWidth;return c},Cd=function(){var b=0;if(a.options.showHeader||a.options.showFooter){var c=a.options.showHeader?a.getHeaderElem():a.getFooterElem();if(c&&(c=c.find("td"))&&0<c.length)for(var d=0;d<c.length;d++)var e=angular.element(c[d]),b=b+e[0].offsetWidth;a.isThereLeftFixedColumns&&(da?Q=da[0].offsetWidth:pa&&(Q=pa[0].offsetWidth),b+=Q);a.isThereRightFixedColumns&&(T?ya=T[0].offsetWidth:ca&&(ya=ca[0].offsetWidth),b+=ya)}else 0<a.currentList.length&&
(ka&&(b+=Gb()),a.isThereLeftFixedColumns&&(b+=Gb("left")),a.isThereRightFixedColumns&&(b+=Gb("right")));return b};a.updateScrollVisibility=function(){var a=d(function(){I||(x.css("display","none"),L.x=0);K||(J.css("display","none"),L.y=0);I&&K||Ba.css("display","none");d.cancel(a)},1)};h.append(x);h.append(J);h.append(Ba);a.updateScrollVisibility();a.updateViewSize=function(){var b=d(function(){var c=0;a.options.grouping.enabled&&w&&(c=w[0].offsetHeight);pb=0;var n=h[0].clientWidth;K&&J&&(n-=J[0].offsetWidth);
I=!1;0<a.columnList.length&&(pb+=Cd(),pb>n&&(x.unbind("mousedown"),x.css("display","block"),x.bind("mousedown",function(b){if(a.options.enabled){a.removeDropDownList();a.closeFilterWindow();a.closeEditor();b=m.getClientMousePos(b,this);var c=Math.floor(h[0].clientWidth);N&&(b.x<N[0].offsetLeft?a.setScrollPos({x:a.scrollPos.x-c,y:a.scrollPos.y}):b.x>N[0].offsetLeft+N[0].offsetWidth&&a.setScrollPos({x:a.scrollPos.x+c,y:a.scrollPos.y}))}}),N=angular.element(x.children().eq(0)),I=!0,N.bind("mousedown",
function(b){a.options.enabled&&(a.removeDropDownList(),a.closeFilterWindow(),a.closeEditor(),1===b.which&&(E.scrollMousePos=a.getMousePos(b),Tb=!0));b.stopPropagation()})));K=!1;g.verScrollVisibility=!1;0<a.currentList.length&&(n=0,a.options.paging.enabled&&R&&(n=R[0].offsetHeight),c=h[0].clientHeight-c-n-(B+O),I&&x&&(c-=x[0].offsetHeight),H=0<U?Math.floor(c/U)+1:0<B?Math.floor(c/B):100,H<a.currentList.length+1&&(J.unbind("mousedown"),J.css("display","block"),J.bind("mousedown",function(b){if(a.options.enabled){a.removeDropDownList();
a.closeFilterWindow();a.closeEditor();b=m.getClientMousePos(b,this);var c=Math.floor(h[0].clientHeight);V&&(b.y<V[0].offsetTop?(a.setScrollPos({x:a.scrollPos.x,y:a.scrollPos.y-c}),Qb(!1,c)):b.y>V[0].offsetTop+V[0].offsetHeight&&(a.setScrollPos({x:a.scrollPos.x,y:a.scrollPos.y+c}),Qb(!0,c)))}}),V=angular.element(J.children().eq(0)),K=!0,g.verScrollVisibility=!0,V.bind("mousedown",function(b){a.options.enabled&&(a.removeDropDownList(),a.closeFilterWindow(),a.closeEditor(),1===b.which&&(E.scrollMousePos=
a.getMousePos(b),ra=!0));b.stopPropagation()})));I||(x.unbind("mousedown"),L.x=0);K||(J.unbind("mousedown"),L.y=0);I&&K&&x.css("display","block");d.cancel(b);!I&&0<a.scrollPos.x&&a.setScrollPos({x:0,y:a.scrollPos.y});!K&&0<a.scrollPos.y&&a.setScrollPos({x:a.scrollPos.x,y:0})},1)};a.updateScrollView=function(){oc()};var oc=function(){var b=d(function(){var c=0;a.options.grouping.enabled&&w&&(c=w[0].offsetHeight);var n=0;a.options.paging.enabled&&R&&(n=R[0].offsetHeight);Xa=h[0].offsetWidth-2;Sb=h[0].offsetHeight-
2-c-n;I&&(Sb-=x[0].offsetHeight);K&&(Xa-=J[0].offsetWidth);W.css("margin-top",c+"px");W.css("width",Xa+"px");W.css("height",Sb+"px");I&&(x.css("left","0px"),x.css("bottom",n+"px"),x.css("width",Xa-2+"px"));var e=2;a.options.paging.enabled&&R&&(e=4);K&&(J.css("top",c+"px"),J.css("right","0px"),J.css("height",Sb-e+"px"));I&&K&&(Ba.css("left","auto"),Ba.css("right","0px"));var f=d(function(){I&&Xa<pb&&(za=2,Oa=x[0].clientWidth-4,Ub=0,Oa>za&&(Ub=Oa-za),Eb=Math.floor(Ub*Xa/pb),9>Eb&&(Eb=9),N.css("width",
Eb+"px"),L.x=pb-Xa,Ya=L.x/(Ub-Eb-2));var b=a.currentList.length+1;K&&0<a.currentList.length&&H<b&&(Pa=2,qb=J[0].clientHeight-4,Vb=0,qb>Pa&&(Vb=qb-Pa),Fb=Math.floor(Vb*H/b),9>Fb&&(Fb=9),V.css("height",Fb+"px"),Xb=(b-H+1)/(Vb-Fb-2),L.y=Math.floor((b-H+1)*U),0>L.y&&(L.y=0),0==D?V.css("top",Pa+"px"):D+H-1==a.currentList.length&&V.css("top",qb-V[0].offsetHeight+"px"));a.isThereLeftFixedColumns&&(da?Q=da[0].offsetWidth:pa?Q=pa[0].offsetWidth:0<a.currentList.length&&(Q=Gb("left")),nb=h[0].clientHeight-c-
n-B-O,I&&(nb-=x[0].offsetHeight),Ha.css("top",c+B+"px"),Ha.css("width",Q+"px"),Ha.css("height",nb+"px"),ja&&ja.css("left",Q+"px"),ka&&ka.css("left",Q+"px"),wa&&wa.css("left",Q+"px"));a.isThereRightFixedColumns&&(T?ya=T[0].offsetWidth:ca?ya=ca[0].offsetWidth:0<a.currentList.length&&(ya=Gb("right")),ob=h[0].clientHeight-c-n-B-O,I&&(ob-=x[0].offsetHeight),b=0,K&&(b=J[0].offsetWidth),T&&T.css("right",b+"px"),xa.css("top",c+B+"px"),xa.css("right",b+"px"),xa.css("width",ya+"px"),xa.css("height",ob+"px"),
ca&&ca.css("right",b+"px"));b=n;I&&x&&(b+=x[0].offsetHeight);ta.css("bottom",b+"px");b=a.scrollPos.x;void 0!=b&&(0>b&&(b=0),b>L.x&&(b=L.x),a.scrollPos.x=b,b=!1!==a.options.rtl?Math.floor(a.scrollPos.x/Ya)-(Oa-N[0].offsetWidth-za):Math.floor(a.scrollPos.x/Ya)+za,I&&N&&N.css("left",b+"px"),pc());d.cancel(f)},1);d.cancel(b)},5)};a.updateColumnWidth=function(){if(a.options.fillSpace){for(var b=0,c=0;c<a.columnList.length;c++)b+=a.getColumnWidth(a.columnList[c])+4;if(b<h[0].clientWidth){for(var b=(h[0].clientWidth-
b)/a.columnList.length,d,c=0;c<a.columnList.length;c++)d=a.getColumnWidth(a.columnList[c])+b,a.columnList[c][a.options.columnFields.width]=d;return!0}}return!1};g.onCellValueChanging=function(b,c,d){var e=c+D,f=a.getCell(e,d);if(f&&0==f[a.options.cellFields.allowEdit])return!1;var f=!0,g=a.getColumnObject(d),h="label",m=null;g&&(h=g[a.options.columnFields.editorType],m=g[a.options.columnFields.editorSettings]);switch(h){case "checkbox":b=m&&1==m.threeState?b.checkState:b.checked;f=a.callCellValueChanging(a.getRowObject(e),
a.getCellObject(e,d),b);break;case "combobox":f=a.callCellValueChanging(a.getRowObject(c),a.getCellObject(c,d),b.item)}return f};g.onCellValueChanged=function(b,c,d){var e=c+D,f=a.getColumnObject(d),h="label",m=null;f&&(h=f[a.options.columnFields.editorType],m=f[a.options.columnFields.editorSettings]);switch(h){case "checkbox":b=m&&1==m.threeState?b.checkState:b.checked;a.callCellValueChanged(a.getRowObject(e),a.getCellObject(e,d),b);break;case "combobox":if(e=a.getCell(c,d))e[a.options.cellFields.value]=
b.item,g.$apply();a.removeDropDownList(!0);a.updateFocus(c,d);a.callCellValueChanged(a.getRowObject(c),a.getCellObject(c,d),b.item)}};g.onEditorClick=function(b,c,d){c+=D;var e=a.getColumnObject(d),f="label";e&&(f=e[a.options.columnFields.editorType]);switch(f){case "checkbox":a.callCellClick(b,a.getRowObject(c),a.getCellObject(c,d),a.getMousePos(b))}};a.setDefaultCellValue=function(b,c,d){if(void 0==b[a.options.cellFields.value]){var e=void 0;switch(c){case "checkbox":e=d&&1==d.threeState?"unchecked":
!1;break;case "image":e=""}void 0!=e&&(b[a.options.cellFields.value]=e)}};a.getColumnTemplateUrl=function(b,c){return c?b[a.options.columnFields.templateSettings].footer?b[a.options.columnFields.templateSettings].footer.url:null:b[a.options.columnFields.templateSettings].header?b[a.options.columnFields.templateSettings].header.url:null};var rb=function(b,c){c=void 0==c?"none":c;for(var d='<table cellpadding="0" cellspacing="0" style="position:absolute;',d=(b?d+'bottom:0;">':d+'top:0;">')+"<tr>",e,
f=0;f<a.columnList.length;f++)e=a.columnList[f][a.options.columnFields.fixed],e=void 0==e?"none":e,e==c&&(b?(d+='<td iui-class="{{data['+f+'].style.footer.general}}" data-index="'+f+'" data-element="column-footer">',d+='<div iui-class="{{data['+f+'].style.footer.cell}}" data-element="column-footer-cell"'):(d+='<td iui-class="{{data['+f+'].style.header.general}}" data-index="'+f+'" data-element="column-header">',d+='<div iui-class="{{data['+f+'].style.header.cell}}" data-element="column-header-cell"'),
d+=' iui-contextmenu menu-items="data['+f+"].column."+a.options.columnFields.contextMenu+'"',b?(d+=' iui-style="overflow:hidden;width:{{data['+f+"].width}}px;text-align:{{data["+f+"].footerAlignment}};",d=f==a.options.expandColIndex?d+("padding-left:{{data["+f+'].indent}}px;">'):d+'">',a.columnList[f][a.options.columnFields.templateSettings]&&a.getColumnTemplateUrl(a.columnList[f],!0)?(d+='<iui-item-content obj="data['+f+"].column."+a.options.columnFields.templateSettings+'.footer.templateObj" template-url="{{data['+
f+"].column."+a.options.columnFields.templateSettings+'.footer.url}}"',d+=' data-element="footer-template-content" ng-cloak></iui-item-content>'):a.columnList[f][a.options.columnFields.footerContent]?d+=a.columnList[f][a.options.columnFields.footerContent]:a.columnList[f][a.options.columnFields.footerTemplate]?d+='<div ng-include="'+a.columnList[f][a.options.columnFields.footerTemplate]+'" style="margin:0;padding:0"></div>':(d+='<span iui-class="{{data['+f+'].style.footer.content}}" data-element="cell-content"',
d+=' iui-tooltip="data['+f+"].column."+a.options.columnFields.footerTooltip+'">',d+="{{data["+f+"].column."+a.options.columnFields.footerText+"}}</span>")):(d+=' iui-style="overflow:hidden;width:{{data['+f+"].width}}px;text-align:{{data["+f+"].headerAlignment}};",d=f==a.options.expandColIndex?d+("padding-left:{{data["+f+'].indent}}px;">'):d+'">',d+='<span iui-class="{{data['+f+'].style.header.content}}" data-element="cell-content"',d+=' iui-tooltip="data['+f+"].column."+a.options.columnFields.headerTooltip+
'">',d+="{{data["+f+"].column."+a.options.columnFields.headerText+"}}</span>",d+='<span iui-class="{{data['+f+'].style.filtering}}" data-index="'+f+'" data-element="filter-button" ng-show="data['+f+'].showFiltering"></span>',d+='<span iui-class="{{data['+f+'].style.sorting}}" data-index="'+f+'" data-element="sort-button" ng-show="data['+f+'].showSorting"></span>'),d+="</div>",d+="</td>");return d+"</tr></table>"},sb=function(b,c,d){c=void 0==c?"none":c;var e,f='<tr iui-class="{{data['+b+'].style}}" data-index="{{data['+
b+'].index}}" tabindex="{{data['+b+'].tabindex}}"';d&&(f+=' style="position:absolute;top:-9999px"');f+=">";for(d=0;d<a.columnList.length;d++)if(e=a.columnList[d][a.options.columnFields.fixed],e=void 0==e?"none":e,e==c){f+='<td iui-class="{{data['+b+"].cells["+d+'].style.cell}}" data-element="cell" data-index="'+d+'" draggable="{{data['+b+'].draggable}}" tabindex="{{data['+b+"].cells["+d+'].tabindex}}">';f+='<div ng-show="data['+b+'].visible"';f+=' iui-class="{{data['+b+"].cells["+d+'].style.content}}" data-element="cell-content"';
f+=' iui-contextmenu menu-items="data['+b+"].row."+a.options.rowFields.contextMenu+'" menu-update="{{data['+b+'].updateContextMenu}}"';f+=' iui-style="width:{{data['+b+"].cells["+d+"].width}}px;text-align:{{data["+b+"].cells["+d+"].alignment}};";0<a.options.rowHeight&&(f+="height:"+a.options.rowHeight+"px;");f=d==a.options.expandColIndex?f+("padding-left:{{data["+b+"].cells["+d+'].indent}}px;">'):f+'">';e=b;var g=d,h="";g===a.options.expandColIndex&&(h=h+('<span iui-class="{{data['+e+'].expandBox}}" data-element="expandbox"></span>')+
('<span iui-class="{{data['+e+'].icon}}" data-element="icon" ng-show="data['+e+'].iconVisible"></span>'));var l=a.columnList[g][a.options.columnFields.editorSettings],q=Yb(g);switch(a.columnList[g][a.options.columnFields.editorType]){case "checkbox":h+='<iui-checkbox name="cb-'+m.getUniqueId(4)+'"';l&&1==l.threeState?(h+=' check-state="data['+e+"].cells["+g+"].related."+a.options.cellFields.value+'"',h=h+(' checkstate-changing="onCellValueChanging(e, '+e+", "+g+')"')+(' checkstate-changed="onCellValueChanged(e, '+
e+", "+g+')"')+' three-state="true"'):(h+=' checked="data['+e+"].cells["+g+"].related."+a.options.cellFields.value+'"',h=h+(' checked-changing="onCellValueChanging(e, '+e+", "+g+')"')+(' checked-changed="onCellValueChanged(e, '+e+", "+g+')"'));h+=' click="onEditorClick(e, '+e+", "+g+')"';l&&l.style&&(h+=' control-style="data['+e+"].cells["+g+'].editorStyle"');h=h+(' enabled="data['+e+"].cells["+g+'].enabled"')+(' style="vertical-align:middle;" iui-show="{{data['+e+"].cells["+g+'].visible}}"')+(' iui-tooltip="data['+
e+"].cells["+g+"].related."+a.options.cellFields.tooltip+'">');h+="</iui-checkbox>";break;case "combobox":h=h+('<span iui-class="{{data['+e+"].cells["+g+'].style.label}}" data-element="content"')+(' iui-tooltip="data['+e+"].cells["+g+"].related."+a.options.cellFields.tooltip+'">');h+="{{data["+e+"].cells["+g+"].related."+a.options.cellFields.value+".text}}";h+="</span>";break;case "image":h+='<img data-element="image" style="vertical-align:middle" ng-src="{{data['+e+"].cells["+g+"].related."+a.options.cellFields.value+
'}}"  iui-show="{{data['+e+"].cells["+g+'].visible}}" show-default="true"';h+=' iui-tooltip="data['+e+"].cells["+g+"].related."+a.options.cellFields.tooltip+'">';break;default:q&&""!=q?h+='<iui-item-content obj="data['+e+"].cells["+g+"].related."+a.options.cellFields.templateObj+'" template-url="{{data['+e+"].cells["+g+'].templateUrl}}" iui-show="{{data['+e+"].cells["+g+'].templateVisible}}" data-element="template-content"></iui-item-content>':(h=h+('<span iui-class="{{data['+e+"].cells["+g+'].style.label}}" data-element="content"')+
(' iui-tooltip="data['+e+"].cells["+g+"].related."+a.options.cellFields.tooltip+'">'),h+="{{data["+e+"].cells["+g+"].related."+a.options.cellFields.text+"}}",h+="</span>")}f+=h;f+="</div>";f+="</td>"}return f+"</tr>"},w=angular.element('<div class="iui-grid-grouping-panel"></div>'),Y=null,Hb=null,Za=-1,Qa=!1,P=angular.element('<div style="opacity:0.75;position:absolute;top:-9999px;z-index:999;pointer-events:none;"></div>'),qc=0,ea=angular.element('<div style="display:inline-block;"></div>'),Ra=[],
rc=function(b){var c=b[a.options.columnFields.groupText];c&&""!=c||(c=b[a.options.columnFields.headerText]);return c},Ed=function(){Fc();w.unbind("mouseenter mouseleave mousemove mouseup");w.empty();w.remove();Ra.length=0;if(a.options.grouping.enabled){var b="",c=0;if(0<a.groups.length)for(var d=0;d<a.groups.length;d++){var e="iui-grid-grouping-panel-item";d<a.groups.length-1&&(e+=" iui-grid-grouping-marker");var g=rc(a.groups[d]),b=b+('<div class="'+e+'" data-index="'+d+'">'),b=b+('<p class="iui-grid-grouping-panel-item-label">'+
g+"</p>"),b=b+'<span class="iui-grid-grouping-panel-item-button"></span></div>'}else d=angular.element('<span class="iui-grid-grouping-panel-item" style="position:absolute;top:-999px;">Temp</span>'),h.append(d),c=d[0].offsetHeight,d.remove();if(""!=b){var l=angular.element(b);w.append(l)}Z&&w.css("opacity",aa.opacity);h.append(w);e=0;g=w.find("div");for(d=0;d<g.length;d++){var q=angular.element(g[d]),r=m.getMargin(q[0]);Ra.push({x:e,width:q[0].offsetWidth});e+=q[0].offsetWidth+r.left+r.right}d=m.getPadding(w[0]);
w.bind("mouseenter",function(b){a.options.enabled&&1==b.which&&ba&&A&&(P.empty(),P.append('<div class="iui-grid-grouping-panel-item">'+A[a.options.columnFields.headerText]+"</div>"),w.append(P),qc=P[0].offsetWidth,P.css("display","none"),Qa=!0,Y=null);b.stopPropagation()});w.bind("mousemove",function(b){if(a.options.enabled&&1==b.which&&(ba&&A||Qa&&Y)){var c=w[0].getBoundingClientRect(),k=angular.element(f)[0].pageXOffset,d=angular.element(f)[0].pageYOffset,e=a.getMousePos(b);e.x-=c.left+k;e.y-=c.top+
d;c="";A?c=rc(A):Y&&(c=rc(Y));cd(b,c);X&&X.css("display","none");h.css("cursor","default");document.body.style.cursor="default";Hb=null;c=-1;Y&&(c=a.groups.indexOf(Y));for(k=Ra.length-1;0<=k;k--)if(e.x>=Ra[k].x){e.x<=Ra[k].x+Ra[k].width&&(Hb=a.groups[k]);if(d=a.getElemFromGroup(a.groups[k]))Za=k,ea.css("display","inline-block"),A&&ea.css("width",d[0].offsetWidth+"px"),A?e.x<=Ra[k].x+Ra[k].width?(e=dd(Hb))?(e=a.getElemFromGroup(e))&&e.after(ea):w.prepend(ea):d.after(ea):0==k?w.prepend(ea):c>k?(e=dd(Hb))&&
(e=a.getElemFromGroup(e))&&e.after(ea):d.after(ea);Za=0>Za?0:Za>a.groups.length-1?a.groups.length-1:Za;break}}b.stopPropagation()});w.bind("mouseup",function(b){if(a.options.enabled&&1==b.which&&(ba&&A||Qa&&Y)){if(Qa&&Y){var c=a.groups.indexOf(Y),k=Za;c!=k?(a.moveObject(c,k,a.groups),a.updateLayout()):(c=a.getElemFromGroup(Y))&&c.css("display","inline-block")}else Hb?(k=Za,0>a.groups.indexOf(A)&&(a.groups.splice(k,0,A),a.updateLayout())):0>a.groups.indexOf(A)&&(a.groups.push(A),a.updateLayout());
P&&P.remove();ea&&ea.remove();A=null;Wa=-1;Qa=ba=!1;Y=null;X&&X.remove();h.css("cursor","default");document.body.style.cursor="default";b.stopPropagation()}});w.bind("mouseleave",function(b){a.options.enabled&&(ea&&ea.remove(),P&&P.css("display","none"))});w.css("width",h[0].clientWidth+"px");""==b?w.css("height",c+(d.top+d.bottom)-2+"px"):l&&w.css("height",l[0].offsetHeight+(d.top+d.bottom)-2+"px");Dd();a.updateGroupPanel()}};a.updateGroupPanel=function(){var b=1;a.options.enabled||(b=.5);if(w){var c=
w.find("span"),d;if(c&&0<c.length)for(var e=0;e<c.length;e++)d=angular.element(c[e]),d.css("opacity",b);if((c=w.find("p"))&&0<c.length)for(e=0;e<c.length;e++)d=angular.element(c[e]),a.options.enabled?d.removeClass("iui-grid-grouping-panel-item-disabled"):d.addClass("iui-grid-grouping-panel-item-disabled")}};var cd=function(b,c){P.empty();P.append('<div class="iui-grid-grouping-panel-item"><p class="iui-grid-grouping-panel-item-label">'+c+"</p></div>");w.append(P);var d=m.getPadding(w[0]),e=w[0].getBoundingClientRect(),
g=angular.element(f)[0].pageXOffset,h=angular.element(f)[0].pageYOffset,l=a.getMousePos(b);l.x-=e.left+g;l.y-=e.top+h;qc=P[0].offsetWidth;e=l.x-qc/2;P.css("top",d.top+"px");P.css("left",e+"px");P.css("display","block")};a.getGroupFromElem=function(b){return b&&(b=angular.element(b))&&(b=b.parent(),b[0].attributes["data-index"]&&(b=b[0].attributes["data-index"].value,a.isGroupIndexinRange(b,a.groups)))?a.groups[b]:null};a.getElemFromGroup=function(b){var c=null;if(b){b=a.groups.indexOf(b);for(var d=
w.find("div"),e=0;e<d.length;e++){var f=angular.element(d[e]);if(f[0].attributes&&f[0].attributes["data-index"]&&f[0].attributes["data-index"].value==b){c=f;break}}}return c};var dd=function(b){return b&&(b=a.groups.indexOf(b)-1,a.isGroupIndexinRange(b,a.groups))?a.groups[b]:null},Fc=function(){for(var a=w.find("p"),b=0;b<a.length;b++){var c=angular.element(a[b]);c.unbind("mousedown")}a=w.find("span");for(b=0;b<a.length;b++)c=angular.element(a[b]),c.unbind("mousedown")},Dd=function(){for(var b=w.find("p"),
c=0;c<b.length;c++){var d=angular.element(b[c]);d.bind("mousedown",function(b){if(a.options.enabled&&1==b.which){var c=angular.element(this),d=c.parent();Qa=!0;Y=a.getGroupFromElem(c);ea.css("width",d[0].offsetWidth+6+"px");ea.css("display","inline-block");d.after(ea);d.css("display","none");cd(b,Y[a.options.columnFields.headerText])}b.stopPropagation()})}b=w.find("span");for(c=0;c<b.length;c++)d=angular.element(b[c]),d.bind("mousedown",function(b){if(a.options.enabled){var c=a.getGroupFromElem(this);
c&&(c=a.groups.indexOf(c),0<=c&&(a.groups.splice(c,1),a.updateLayout()))}b.stopPropagation()})};a.isGroupIndexinRange=function(a,b){return 0<=a&&a<b.length?!0:!1};a.moveObject=function(b,c,d){a.isGroupIndexinRange(b,d)&&a.isGroupIndexinRange(c,d)&&d.splice(c,0,d.splice(b,1)[0])};var Fd=function(){U=0;if(0<a.options.rowHeight){var b={top:0,bottom:0};if(a.options.controlStyle&&a.options.controlStyle.row&&a.options.controlStyle.row.cell&&a.options.controlStyle.row.cell.content){var e=angular.element('<div class="'+
a.options.controlStyle.row.cell.content+'" style="position:absolute;top:-9999999px;">Temp</div>');h.append(e);b=m.getPadding(e[0]);e.remove()}U=a.options.rowHeight+b.top+b.bottom+3}else if(0<a.currentList.length&&v){for(var b=[],f=[],e=[],g=[],u=[],l=[],q=0,r=0;r<a.currentList.length&&10>r;r++)b.push(sb(r,"none",!0)),f.push(c(b[r])(v)),h.append(f[r]),a.isThereLeftFixedColumns&&(e.push(sb(r,"left",!0)),g.push(c(e[r])(v)),h.append(g[r])),a.isThereRightFixedColumns&&(u.push(sb(r,"right",!0)),l.push(c(u[r])(v)),
h.append(l[r])),q++;if(0<q)var w=d(function(){for(var b=0,c=0,k=0,e=0;e<q;e++)b+=f[e][0].offsetHeight,f[e].remove(),a.isThereLeftFixedColumns&&(c+=g[e][0].offsetHeight,g[e].remove()),a.isThereRightFixedColumns&&(k+=l[e][0].offsetHeight,l[e].remove());U=Math.floor(Math.max(Math.max(b,c),k)/q);d.cancel(w)},1)}},C=null,sc=0,tc=0,R=angular.element('<div class="iui-pagination-panel"></div>'),Gd=function(){C&&C.$destroy();R.empty();R.remove();tc=sc=0;if(a.options.paging.showControlPanel){C=g.$new();C.currentPage=
0;C.minPages=0;C.numPages=a.pageList.length;0<C.numPages&&0==C.currentPage&&(C.currentPage=1);C.onFirstPage=function(){a.options.enabled&&(a.firstPage(),C.currentPage=a.currentPageNumber)};C.onLastPage=function(){a.options.enabled&&(a.lastPage(),C.currentPage=a.currentPageNumber)};C.onNextPage=function(){a.options.enabled&&(a.nextPage(),C.currentPage=a.currentPageNumber)};C.onPrevPage=function(){a.options.enabled&&(a.prevPage(),C.currentPage=a.currentPageNumber)};C.$watch("currentPage",function(b,
c){a.options.enabled&&b!=c&&1<=b&&b<=a.pageList.length&&a.setCurrentPage(b)});sc=h[0].clientWidth;for(var b="",d=0;6>d;d++)switch(d){case 0:b+='<span class="iui-pagination-panel-button iui-pagination-first" ng-click="onFirstPage()"></span>';break;case 1:b+='<span class="iui-pagination-panel-button iui-pagination-prev" ng-click="onPrevPage()"></span>';break;case 2:b+='<input class="iui-pagination-panel-input" ng-model="currentPage" type="number" ng-attr-min="{{minPages}}" ng-attr-max="{{numPages}}" />';
break;case 3:b+='<span class="iui-pagination-panel-label"> / {{numPages}}</span>';break;case 4:b+='<span class="iui-pagination-panel-button iui-pagination-next" ng-click="onNextPage()"></span>';break;case 5:b+='<span class="iui-pagination-panel-button iui-pagination-last" ng-click="onLastPage()"></span>'}b=c(b)(C);R.append(b);h.append(R);R.css("width",sc+"px");b&&(m.getMargin(b[0]),d=m.getPadding(R[0]),tc=b[0].offsetHeight+(d.top+d.bottom)-2,R.css("height",tc+"px"));a.updatePaginationPanel()}};a.updatePaginationPanel=
function(){var b=1;a.options.enabled||(b=.5);if(R){var c=R.find("span"),d;if(c&&0<c.length)for(var e=0;e<c.length;e++)d=angular.element(c[e]),d.css("opacity",b);(c=R.find("input"))&&0<c.length&&(d=angular.element(c[0]),a.options.enabled?d.removeAttr("disabled"):d.attr("disabled","true"))}};a.resetPageNumber=function(){a.currentPageNumber=1;C&&(C.currentPage=0<C.numPages?1:0)};a.updatePageNumber=function(){a.currentPageNumber>a.pageList.length&&(0==a.pageList.length?a.resetPageNumber():(a.currentPageNumber=
a.pageList.length,C&&(C.currentPage=a.currentPageNumber)))};var $a=angular.element('<div class="iui-grid-block" style="position:absolute;top:-9999999px"></div>'),fa=angular.element('<div class="iui-grid-block iui-grid-block-top" style="position:absolute;top:-9999999px"></div>'),qa=angular.element('<div class="iui-grid-block iui-grid-block-bottom" style="position:absolute;top:-9999999px"></div>'),ab=angular.element('<div class="iui-grid-block iui-grid-block-left" style="position:absolute;top:-9999999px"></div>'),
bb=angular.element('<div class="iui-grid-block iui-grid-block-right" style="position:absolute;top:-9999999px"></div>'),ed=function(){$a&&($a.empty(),$a.remove());fa&&(fa.empty(),fa.remove());qa&&(qa.empty(),qa.remove());ab&&(ab.empty(),ab.remove());bb&&(bb.empty(),bb.remove())},Hd=function(){if(1<a.updateStatus)M("end");else var b=d(function(){if(0<a.columnList.length&&1==a.updateStatus){var e=0;a.options.grouping.enabled&&w&&(e=w[0].offsetHeight);F=g.$new();F.data=fd();a.refreshColumns();F.$apply();
for(var f=O=B=0;f<a.columnList.length;f++){var t={columnID:void 0!=a.columnList[f][a.options.columnFields.id]?a.columnList[f][a.options.columnFields.id]:f,avgItemHeight:0};switch(a.columnList[f][a.options.columnFields.editorType]){case "combobox":vd(a.columnList[f].editorSettings,f,t);gb.push(t);break;default:gb.push(t)}}a.options.showHeader&&(h.append(fa),Z&&(sa.css("opacity",aa.opacity),fa.css("opacity",aa.opacity)),fa.css("top",e+"px"),e=rb(),ja=angular.element(c(e)(F)),fa.append(ja),a.isThereLeftFixedColumns&&
(e=rb(!1,"left"),da=c(e)(F),fa.append(da),da.css("z-index","2"),da.addClass("iui-grid-column-header-left")),a.isThereRightFixedColumns&&(e=rb(!1,"right"),T=c(e)(F),fa.append(T),T.css("right","0"),T.css("z-index","1"),T.addClass("iui-grid-column-header-right")));a.options.showFooter&&(h.append(qa),Z&&(ta.css("opacity",aa.opacity),qa.css("opacity",aa.opacity)),e=rb(!0),wa=c(e)(F),qa.append(wa),a.isThereLeftFixedColumns&&(e=rb(!0,"left"),pa=c(e)(F),qa.append(pa),pa.css("z-index","2"),pa.addClass("iui-grid-column-footer-left")),
a.isThereRightFixedColumns&&(e=rb(!0,"right"),ca=c(e)(F),qa.append(ca),ca.css("right","0"),ca.css("z-index","1"),ca.addClass("iui-grid-column-footer-right")));for(var u,e=-1,f=0;f<a.columnList.length;f++)if(u=t=null,a.columnList[f][a.options.columnFields.templateSettings]&&a.getColumnTemplateUrl(a.columnList[f])?(t=a.columnList[f][a.options.columnFields.templateSettings].header,e=1):a.columnList[f][a.options.columnFields.headerContent]?(t=a.columnList[f][a.options.columnFields.headerContent],e=2):
a.columnList[f][a.options.columnFields.headerTemplate]&&(t=a.columnList[f][a.options.columnFields.headerTemplate],e=3),a.columnList[f][a.options.columnFields.templateSettings]&&a.getColumnTemplateUrl(a.columnList[f],!0)?u=a.columnList[f][a.options.columnFields.templateSettings].footer:a.columnList[f][a.options.columnFields.footerContent]?u=a.columnList[f][a.options.columnFields.footerContent]:a.columnList[f][a.options.columnFields.footerTemplate]&&(u=a.columnList[f][a.options.columnFields.footerTemplate]),
(t||u)&&(u=a.getElemFromColumn(a.columnList[f],a.columnList[f][a.options.columnFields.fixed]))&&t&&t&&(u=a.getChildElement(u,"column-header-cell")))switch(u.empty(),e){case 1:F&&(t='<iui-item-content obj="data['+f+"].column."+a.options.columnFields.templateSettings+'.header.templateObj" template-url="{{data['+f+"].column."+a.options.columnFields.templateSettings+'.header.url}}" draggable="{{data['+f+'].draggable}}"',t+=' data-element="header-template-content" ng-cloak></iui-item-content>',u.append(c(t)(F)));
break;case 2:u.append(c(t)(g.$parent));break;case 3:t='<div ng-include="'+t+'"',a.columnList[f][a.options.columnFields.headerTemplateModel]&&(t+=' onload="'+a.columnList[f][a.options.columnFields.headerTemplateModel]+'"'),t+=' style="margin:0;padding:0"></div>',u.append(c(t)(g.$parent))}ua(40);M("rows")}else ua(70),M("scroll");d.cancel(b)},1)},Id=function(){if(1<a.updateStatus)M("end");else var b=d(function(){if(0<a.columnList.length){var e=0;a.options.grouping.enabled&&w&&(e=w[0].offsetHeight);var f=
0;a.options.paging.enabled&&R&&(f=R[0].offsetHeight);var t=0;if(a.options.showHeader&&ja){B=ja[0].offsetHeight;a.isThereLeftFixedColumns&&da?B=da[0].offsetHeight:a.isThereRightFixedColumns&&T&&(B=T[0].offsetHeight);var u=0,m=ja.find("td");if(m&&0<m.length)for(var l=0;l<m.length;l++)var q=angular.element(m[l]),u=u+q[0].offsetWidth;u>h[0].clientWidth&&(u=angular.element('<div class="iui-scrollbar-horizontal"><div class="iui-scroll-button-thumb-horizontal"></div></div>'),u.css("bottom","-9999px"),h.append(u),
t=u[0].offsetHeight,u.remove());fa.css("width",h[0].clientWidth+"px");fa.css("height",B+"px");a.isThereLeftFixedColumns&&(Q=da[0].offsetWidth,nb=h[0].clientHeight-B-O,ja.css("left",Q+"px"));a.isThereRightFixedColumns&&(ya=T[0].offsetWidth,ob=h[0].clientHeight-B-O)}a.options.showFooter&&(O=wa[0].offsetHeight,a.isThereLeftFixedColumns&&pa?O=pa[0].offsetHeight:a.isThereRightFixedColumns&&ca&&(O=ca[0].offsetHeight),qa.css("width",h[0].clientWidth+"px"),qa.css("height",O+"px"),a.isThereLeftFixedColumns&&
(Q=pa[0].offsetWidth,nb=h[0].clientHeight-B-O,wa.css("left",Q+"px")),a.isThereRightFixedColumns&&(ya=ca[0].offsetWidth,ob=h[0].clientHeight-B-O));gd();if(0<a.currentList.length){v=g.$new();v.data=hd();a.refreshRows();v.$apply();Fd();var r=d(function(){Rc();ka&&ka.remove();Ma&&Ma.remove();Na&&Na.remove();var b=h[0].clientHeight-e-f-(B+O)-t;H=0<U?Math.floor(b/U)+1:0<B?Math.floor(b/B)+1:100;la=0;for(var b="",k=0;k<H;k++)b+=sb(k),la++;if(0<la){ka=angular.element('<table cellpadding="0" cellspacing="0" style="position:absolute;top:'+
B+'px;"></table>');ka.append(c(b)(v));$a.append(ka);if(a.isThereLeftFixedColumns){ka.css("left",Q+"px");b="";for(k=la=0;k<H;k++)b+=sb(k,"left"),la++;0<la&&(Ma=angular.element('<table class="iui-grid-rows-left" cellpadding="0" cellspacing="0" style="position:absolute;"></table>'),Ma.append(c(b)(v)),ab.append(Ma),h.append(ab),Z&&Ha.css("opacity",aa.opacity))}if(a.isThereRightFixedColumns){b="";for(k=la=0;k<H;k++)b+=sb(k,"right"),la++;0<la&&(Na=angular.element('<table class="iui-grid-rows-right" cellpadding="0" cellspacing="0" style="position:absolute;"></table>'),
Na.append(c(b)(v)),bb.append(Na),h.append(bb),Z&&xa.css("opacity",aa.opacity))}}ua(70);M("scroll");d.cancel(r)},1)}else ua(70),M("scroll")}else ua(70),M("scroll");d.cancel(b)},1)},Jd=function(){if(1<a.updateStatus)M("end");else{if(1==a.updateStatus){$a&&(W.empty(),W.append($a.children()));if(fa){var b=0;a.options.grouping.enabled&&w&&(b=w[0].offsetHeight);sa.css("top",b+"px");sa.empty();sa.append(fa.children());a.options.showHeader&&(sa.css("width",h[0].clientWidth+"px"),sa.css("height",B+"px"));
h.append(sa)}qa&&(ta.empty(),ta.append(qa.children()),a.options.showFooter&&(ta.css("width",h[0].clientWidth+"px"),ta.css("height",O+"px")),h.append(ta));ab&&(Ha.empty(),Ha.append(ab.children()),h.append(Ha));bb&&(xa.empty(),xa.append(bb.children()),h.append(xa));a.updateViewSize();a.updateViewSize();a.updateScrollVisibility();a.updateScrollView()}ua(80,"complete");M("complete")}},Kd=function(){switch(aa.type){case "circular":1==a.updateStatus&&(id(),tb=0,Sa=!0,a.callLoadComplete());break;case "linear":jd(!1);
break;default:tb=0,Sa=!0,1==a.updateStatus&&a.callLoadComplete()}a.updateActive=!1;a.updateStatus--;if(0<a.updateStatus)ub=a.updateActive=!0,1==a.updateStatus?M("start"):M("end");else if(kd())var b=d(function(){a.updateView();a.callUpdateComplete();d.cancel(b)},1);else a.callUpdateComplete()},M=function(b){if(ub&&!cb)switch(b){case "start":1<a.updateStatus?M("end"):(a.updateColumnList(),a.updateGroupList(),a.options.paging.enabled&&a.updatePageList(),a.updateCurrentList(),ua(10),M("init"));break;
case "init":1<a.updateStatus?M("end"):(gb.length=0,Nc(),a.options.grouping.enabled&&Ed(),Tb||ra||oc(),ed(),wa=ja=ka=null,nb=Q=0,Ma=da=null,ob=ya=0,Na=T=null,F&&F.$destroy(),v&&v.$destroy(),a.options.paging.enabled&&Gd(),h.append($a),ua(20),M("columns"));break;case "columns":Hd();break;case "rows":fa?a.options.showHeader&&fa.find("td").length<a.columnList.length?d(function(){M(b)},1):Id():d(function(){M(b)},1);break;case "scroll":Jd();break;case "complete":1<a.updateStatus?M("end"):(ed(),ua(90),M("events"));
break;case "events":1<a.updateStatus||(a.allowEvents=!0,a.options.showHeader&&(ja&&kc(ja),a.isThereLeftFixedColumns&&da&&kc(da),a.isThereRightFixedColumns&&T&&kc(T)),0<a.currentList.length&&Ad(),ua(100));M("end");break;case "end":Kd()}else d(function(){M(b)},1)},ld=5,Zb=0,db=0,$b=0,md=0,cb=!1,ac=!1,aa={type:"none",speed:"normal",opacity:0},uc=null,Z=!1,Sa=!1,jd=function(b){var c=l(function(){b?db++:db--;$b=(h[0].clientHeight-db)/2+2;Ib.css("height",db+"px");Ia.css("top",$b+"px");b&&db>=ld?(Z=!0,ua(0),
Sa=cb=!1,l.cancel(c)):!b&&0>=db&&(Ia&&Ia.remove(),tb=0,Sa=!0,a.callLoadComplete(),l.cancel(c))},20)},id=function(){uc&&l.cancel(uc);Aa&&Aa.remove()};a.beginLoad=function(a){if(!cb)switch(cb=!0,aa=a?{type:void 0!=a.type?a.type:"none",speed:void 0!=a.speed?a.speed:"normal",opacity:void 0!=a.opacity?a.opacity:0}:{type:"none",speed:"normal",opacity:0},vc(aa.opacity),aa.type){case "circular":id();h.append(Aa);Aa.css("top",(h[0].clientHeight-Aa[0].offsetHeight)/2+"px");Aa.css("left",(h[0].clientWidth-Aa[0].offsetWidth)/
2+"px");Z=!0;Sa=cb=!1;var b=0,c=3;switch(aa.speed){case "veryfast":c=7;break;case "fast":c=5;break;case "slow":c=2;break;case "veryslow":c=1}uc=l(function(){b+=c;360<b&&(b=0);var a="rotate("+b+"deg)";Aa.css("-ms-transform",a);Aa.css("-webkit-transform",a);Aa.css("transform",a)},1);break;case "linear":a=angular.element('<div class="iui-load-block-progress" style="position:absolute;left:-9999px"></div>');h.append(a);ld=parseInt(getComputedStyle(a[0]).height,10);a.remove();Ib.css("width","0px");Ib.css("height",
"0px");h.append(Ia);tb=0;Zb=Math.floor(.5*h[0].clientWidth);db=0;$b=h[0].clientHeight/2+2;md=(h[0].clientWidth-Zb)/2;Ia.css("width",Zb+"px");Ia.css("top",$b+"px");Ia.css("left",md+"px");Ia.css("opacity","1");jd(!0);break;default:Z=!0,Sa=cb=!1}};a.endLoad=function(){if(!ac)if(ac=!0,Z){Z=!1;var a=3,b=aa.opacity,c=l(function(){Sa&&(10<a||1<=b?(vc(1),ac=cb=Sa=!1,aa={type:"none",speed:"normal"},l.cancel(c)):(b+=a/10,vc(b),a+=3))},1)}else ac=!1};var vc=function(a){w&&w.css("opacity",a);sa&&sa.css("opacity",
a);Ha&&Ha.css("opacity",a);W&&W.css("opacity",a);xa&&xa.css("opacity",a);ta&&ta.css("opacity",a);R&&R.css("opacity",a);x&&x.css("opacity",a);J&&J.css("opacity",a);Ba&&Ba.css("opacity",a)},Ib=angular.element('<div class="iui-load-block-progress"></div>'),Ia=angular.element('<div class="iui-load-block"></div>');Ia.append(Ib);var tb=0,ub=!1,Aa=angular.element('<div class="iui-load-circular"></div>'),ua=function(a){if(Z&&"linear"==aa.type){ub=!1;var b=Math.floor(Zb*a/100),c=tb;a=10;switch(aa.speed){case "veryfast":a=
2;break;case "fast":a=5;break;case "slow":a=15;break;case "veryslow":a=20}var d=b>c?Math.floor((b-c)/a):1,d=0<d?d:1,e=l(function(){c+=d;Ib.css("width",c+"px");c>=b&&(tb=b,ub=!0,l.cancel(e))},1)}else ub=!0};a.updateStatus=0;a.updateActive=!1;a.updateLayout=function(b){h.append(E.$tw);E.s1t(E.twp);b=!0;for(var c=h.parent();"body"!=c[0].tagName.toLowerCase();){if("none"==getComputedStyle(c[0]).display){b=!1;break}c=c.parent()}b&&a.allowUpdate&&(a.updateStatus++,a.updateActive||(a.updateActive=!0,a.allowEvents=
!1,h.removeClass("iui-grid-block-rtl"),a.options.rtl&&h.addClass("iui-grid-block-rtl"),W.removeClass("iui-grid-block-shift-left iui-grid-block-rtl"),W.addClass(eb()),U=0,H=100,O=B=0,ub=!0,M("start")))};a.updateCurrentLayout=function(b){if(a.allowUpdate)if(0==a.currentList.length)a.updateLayout();else{a.updateGroupList();a.options.paging.enabled&&(a.updatePageList(),C&&(C.minPages=0<a.pageList.length?1:0,C.numPages=a.pageList.length),a.updatePageNumber());a.updateCurrentList();a.updateView();var c=
d(function(){a.updateViewSize();a.updateViewSize();b&&a.updateScrollVisibility();a.updateScrollView();d.cancel(c)},1)}};var Ld=function(b,c){var d=a.options.enabled&&a.options.allowColumnReorder&&b[a.options.columnFields.allowDrag],e=b[a.options.columnFields.headerAlignment],f=b[a.options.columnFields.footerAlignment],g=a.isFilteringAllowed(b),h=a.isSortingAllowed()&&b==a.sortColumn,m=a.getColumnWidth(b),m=0<=m?m:0,l=wc(b);m<l.min&&(m=l.min);m>l.max&&(m=l.max);return{draggable:d,headerAlignment:e,
footerAlignment:f,index:c,indent:0,column:b,showFiltering:g,showSorting:h,style:{header:{},footer:{}},width:m}},nd=function(b,c){if(0<=c){var d=a.currentList[b][a.options.rowFields.cells];if(c<d.length)return d[c]}return{}},Yb=function(b){return a.columnList[b][a.options.columnFields.cellTemplateUrl]?a.columnList[b][a.options.columnFields.cellTemplateUrl]:""},Md=function(b,c,d){for(var e=[],f=0;f<a.columnList.length;f++){var g,h=f;if(d){var l=a.columnList[f][a.options.columnFields.id];l&&(h=a.getCellIndexById(a.currentList[c][a.options.rowFields.cells],
f,l))}g=h;var h=d?nd(c,g):{},l=a.columnList[f][a.options.columnFields.contentAlignment]?a.columnList[f][a.options.columnFields.contentAlignment]:"left",q;q=(q=a.columnList[f][a.options.columnFields.editorSettings])&&q.style?q.style:null;var r;if(d)a:{if(0<=g&&(r=a.currentList[c][a.options.rowFields.cells],g<r.length)){r=1==a.options.enabled&&r[g][a.options.cellFields.enabled];break a}r=1==a.options.enabled}else r=!1;var w;if(d){if(w=0,f==a.options.expandColIndex){var v=c,x=a.columnList[a.options.expandColIndex];
w=a.getColumnWidth(x);var z=w-a.indentList[v],z=0<=z?z:0,A={top:0,right:0,bottom:0,left:0};(x=a.getElemFromColumn(x,x[a.options.columnFields.fixed]))&&(x=a.getChildElement(x,"column-header-cell"))&&(A=m.getPadding(x[0]));v=A.left+a.indentList[v];0==z&&(v=w);w=v}}else w=0;z=g;d?(v=c,A=f,v=1==a.options.allowFocus&&1==a.options.allowCellFocus&&a.isRowEnabled(a.currentList[v])&&0<=A?a.getTabIndex().toString()+(v+1).toString()+A.toString():""):v="";A=Yb(f);if(d)var y=c,x=g,B=Yb(f),y=nd(y,x),x=0<=x&&B&&
""!=B&&y&&void 0!=y[a.options.cellFields.templateObj]&&null!=y[a.options.cellFields.templateObj]?!0:!1;else x=!1;if(d)a:{if(0<=g&&(B=a.currentList[c][a.options.rowFields.cells],g<B.length)){B=B[g][a.options.cellFields.text];break a}B=""}else B="";if(d)a:{if(0<=g&&(y=a.currentList[c][a.options.rowFields.cells],g<y.length)){y=y[g][a.options.cellFields.value];break a}y=null}else y=null;g=d?0<=g?!0:!1:!1;var E;if(d){E=c;var F=f,C=a.columnList[F],D=a.getColumnWidth(C),C=wc(C);D<C.min&&(D=C.min);D>C.max&&
(D=C.max);F==a.options.expandColIndex&&(D-=a.indentList[E]);E=0<=D?D:0}else E=0;e.push({related:h,alignment:l,editorStyle:q,enabled:r,indent:w,index:z,style:{},tabindex:v,templateUrl:A,templateVisible:x,text:B,value:y,visible:g,width:E})}if(d){f="";h=a.defaultStyle.row.expandBox.general;b[a.options.rowFields.style]&&b[a.options.rowFields.style].expandBox&&b[a.options.rowFields.style].expandBox.general!=h?h+=" "+b[a.options.rowFields.style].expandBox.general:a.options.controlStyle.row.expandBox.general!=
h&&(h+=" "+a.options.controlStyle.row.expandBox.general);l=a.getCurrentRowStyle(b);l=a.getExpandBoxStyle(l.expandBox);if(a.isThereChildRows||b&&b[a.options.rowFields.hasChildren])f=h;b&&(b[a.options.rowFields.hasChildren]||b[a.options.rowFields.rows]&&0<b[a.options.rowFields.rows].length&&a.isThereVisibleChildren(b))&&(f=b[a.options.rowFields.hasChildren]&&void 0===b[a.options.rowFields.expanded]?f+(" "+l.expanded):!1!==b[a.options.rowFields.expanded]?f+(" "+l.collapsed):f+(" "+l.expanded),!0===a.options.rtl&&
(f+="-rtl"),a.options.enabled&&a.isRowEnabled(b)||(f+="-disabled"))}else f="";h=d?a.isRowEnabled(b)&&a.isDragAllowed(b):!1;d?(l="",b.icon?l=b.icon:a.options.rowIcon&&(l=a.options.rowIcon)):l="";q=d?0!=a.options.showIcons&&(b.icon||a.options.rowIcon):!1;r=d?1==a.options.allowFocus&&0==a.options.allowCellFocus&&a.isRowEnabled(a.currentList[c])?a.getTabIndex().toString()+(c+1).toString():"":"";return{cells:e,expandBox:f,draggable:h,icon:l,iconVisible:q,index:c,row:d?b:{},style:{},tabindex:r,updateContextMenu:d?
null!=b[a.options.rowFields.contextMenu]:!1,visible:d}},fd=function(){for(var b=[],c=0;c<a.columnList.length;c++)b.push(Ld(a.columnList[c],c));return b},hd=function(){for(var b=[],c=D;c<D+H;c++)b.push(Md(a.currentList[c],c,c<a.currentList.length));return b},gd=function(){for(var b=0;b<a.columnList.length;b++)if(a.isFilteringAllowed(a.columnList[b])){var c=a.getElemFromColumn(a.columnList[b],a.columnList[b][a.options.columnFields.fixed]);c&&(c=a.getChildElement(c,"column-header-cell"))&&(c=a.getContentElement(c,
"filter-button"))&&(c.css("top",(B-parseInt(getComputedStyle(c[0]).height,10))/2-1+"px"),c.css("right","2px"))}a.isSortingAllowed()&&a.sortColumn&&(b=a.getElemFromColumn(a.sortColumn,a.sortColumn[a.options.columnFields.fixed]))&&(c=a.getChildElement(b,"column-header-cell"))&&(c=a.getContentElement(c,"sort-button"))&&(c.css("top",(B-parseInt(getComputedStyle(c[0]).height,10))/2-1+"px"),a.isFilteringAllowed(a.sortColumn)?c.css("right","22px"):c.css("right","2px"))};a.getRowScope=function(){return v};
var pd=function(){if(F&&v&&(a.allowEvents=!1,od(!1),0<a.columnList.length&&(F.data=fd(),v.data=hd(),a.options.selectedRow&&!a.isRowEnabled(a.options.selectedRow)&&(a.options.selectedRow[a.options.rowFields.selected]=!1,a.options.selectedRow=null,a.updateSelectionList()),a.refresh(null,null,!1),F.$apply(),v.$apply(),gd(),a.allowEvents=!0,0>=a.options.rowHeight&&kd())))for(var b=D;0<=b&&b<D+H&&b<a.currentList.length;b++){var c=a.currentList[b];xc(c,"none");xc(c,"left");xc(c,"right");var d=yc(c),e=yc(c,
"left"),f=yc(c,"right"),g=Math.max(Math.max(d,e),f);d<g&&zc(c,"none",g);e<g&&zc(c,"left",g);f<g&&zc(c,"right",g)}},yc=function(b,c){var d=0;if(b&&v){var e=a.getElemFromRow(b,c);e&&(d=e[0].offsetHeight)}return d},kd=function(){for(var b=!1,c=0;c<a.columnList.length;c++){var d=Yb(c);if(d&&""!=d){b=!0;break}}return b},zc=function(b,c,d){if((b=a.getElemFromRow(b,c))&&(b=b.find("td"))&&0<b.length)for(c=0;c<b.length;c++){var e=angular.element(b[c]),e=a.getContentElement(e),f=m.getBorderWidth(e[0]),g=m.getPadding(e[0]);
e&&e.css("height",d-(f.top+f.bottom)-(g.top+g.bottom)-2.85+"px")}},xc=function(b,c){var d=a.getElemFromRow(b,c);if(d&&(d=d.find("td"))&&0<d.length)for(var e=0;e<d.length;e++){var f=angular.element(d[e]);(f=a.getContentElement(f))&&f.css("height","auto")}};a.updateView=function(a){if(a)pd();else var b=d(function(){pd();d.cancel(b)},1)};var Ac=function(b,c,d){var e={cell:"",content:"",general:"",label:""};switch(c){case "column":d?(c=a.defaultStyle.column.footer.normal,a.options.controlStyle.column.footer.normal!=
c&&(c+=" "+a.options.controlStyle.column.footer.normal),e.general=c,e.cell="iui-grid-column-footer-cell",c=a.defaultStyle.column.footer.content,a.options.controlStyle.column.footer.content!=c&&(c+=" "+a.options.controlStyle.column.footer.content)):(c=a.defaultStyle.column.header.normal,a.options.controlStyle.column.header.normal!=c&&(c+=" "+a.options.controlStyle.column.header.normal),e.general=c,e.cell="iui-grid-column-header-cell",c=a.defaultStyle.column.header.content,a.options.controlStyle.column.header.content!=
c&&(c+=" "+a.options.controlStyle.column.header.content));e.content=c;break;case "row":c=a.defaultStyle.row.general.normal;a.options.controlStyle.row.general.normal!=c&&(c+=" "+a.options.controlStyle.row.general.normal);e.general=c;break;case "cell":c=a.defaultStyle.row.cell.normal;a.options.controlStyle.row.cell.normal!=c&&(c+=" "+a.options.controlStyle.row.cell.normal);switch(a.options.gridLines){case "none":c=b==D+H-1||b==a.currentList.length-1?c+" iui-grid-lines-horizontal":c+" iui-grid-lines-none";
break;case "horizontal":c+=" iui-grid-lines-horizontal";break;case "vertical":c=b==D+H-1||b==a.currentList.length-1?c+" iui-grid-lines-both":c+" iui-grid-lines-vertical";break;default:c+=" iui-grid-lines-both"}e.general=c;c=a.defaultStyle.row.cell.content;a.options.controlStyle.row.cell.content!=c&&(c+=" "+a.options.controlStyle.row.cell.content);e.content=c;e.label=a.getDefaultCellLabelClass()}return e},vb=function(b,c,d,e){var f=a.getObjState(b);d=Ac(d,b.type,e);switch(b.type){case "column":e?(c=
a.getCurrentColumnStyle(b,"footer",f),c!=a.options.controlStyle.column.footer.normal&&(d.general+=" "+c),b=a.getCurrentColumnStyle(b,"footer","content"),b!=a.options.controlStyle.column.footer.content&&(d.content+=" "+b)):(c=a.getCurrentColumnStyle(b,"header",f),c!=a.options.controlStyle.column.header.normal&&(d.general+=" "+c),b=a.getCurrentColumnStyle(b,"header","content"),b!=a.options.controlStyle.column.header.content&&(d.content+=" "+b));break;case "group":b=a.getCurrentRowStyle(b,f);b!=a.options.controlStyle.row.general.normal&&
(d.general+=" "+b);break;case "row":b=a.getCurrentRowStyle(b,f);b!=a.options.controlStyle.row.general.normal&&(d.general+=" "+b);break;case "cell":e=a.getCurrentCellStyle(c,b,f),e!=a.options.controlStyle.row.cell.normal&&(d.general+=" "+e),b=a.getCurrentCellStyle(c,b,"content"),b!=a.options.controlStyle.row.cell.content&&(d.content+=" "+b)}return d},wb=function(a,b,c){v.data[a].cells[b].style.cell=c.general;v.data[a].cells[b].style.content=c.content;v.data[a].cells[b].style.label=c.label},qd=function(b){if(v&&
(b-=D,0<=b&&b<v.data.length&&v.data[b].visible)){v.data[b].style=a.defaultStyle.row.general.normal;for(var c=0;c<a.columnList.length;c++)v.data[b].cells[c].style.cell=a.defaultStyle.row.cell.normal+" iui-grid-cell-empty"}};a.refreshColumns=function(){for(var b=0;b<a.columnList.length;b++)a.refresh(a.columnList[b],null,!1)};a.refreshRows=function(){for(var b=D;b<D+H;b++)b<a.currentList.length?a.refresh(a.currentList[b],null,!1):qd(b)};a.refresh=function(b,c,d){if(b)switch(b.type){case "column":if(F&&
(c=a.getColumnCurrentIndex(b),0<=c&&c<F.data.length)){1==a.options.showHeader&&(F.data[c].style.header=vb(b));1==a.options.showFooter&&(F.data[c].style.footer=vb(b,null,-1,!0));var e=F.data[c].style,f="";if(a.isFilteringAllowed(b)){var g=a.getObjState(b),f="iui-filtering";"selected"==g?f+=" iui-filtering-selected":"hovered"==g&&(f+=" iui-filtering-hovered")}e.filtering=f;c=F.data[c].style;e="";a.isSortingAllowed()&&b==a.sortColumn&&(b=a.getObjState(b),"ascending"==a.options.sorting?(e="iui-sort-ascending",
"selected"==b?e+=" iui-sort-ascending-selected":"hovered"==b&&(e+=" iui-sort-ascending-hovered")):(e="iui-sort-descending","selected"==b?e+=" iui-sort-descending-selected":"hovered"==b&&(e+=" iui-sort-descending-hovered")));c.sorting=e;void 0==d&&F&&F.$apply()}break;case "group":if(v&&(c=a.getRowCurrentIndex(b),e=c-D,0<=e&&e<v.data.length&&v.data[e].visible)){v.data[e].style=vb(b).general;f=Ac(c,"cell");for(g=0;g<a.columnList.length&&g<v.data[e].cells.length;g++){var h=v.data[e].cells[g].index;if(0<=
h){var l=b[a.options.rowFields.cells];h<l.length?(h=vb(l[h],b,c),wb(e,g,h)):wb(e,g,f)}else wb(e,g,f)}void 0==d&&v&&v.$apply()}break;case "row":if(v&&(c=a.getRowCurrentIndex(b),e=c-D,0<=e&&e<v.data.length&&v.data[e].visible)){v.data[e].style=vb(b).general;f=Ac(c,"cell");for(g=0;g<a.columnList.length&&g<v.data[e].cells.length;g++)h=v.data[e].cells[g].index,0<=h?(l=b[a.options.rowFields.cells],h<l.length?(h=vb(l[h],b,c),wb(e,g,h)):wb(e,g,f)):wb(e,g,f);void 0==d&&v&&v.$apply()}}else{for(g=0;g<a.columnList.length;g++)a.refresh(a.columnList[g],
null,!1);for(b=D;b<D+H;b++)b<a.currentList.length?a.refresh(a.currentList[b],null,!1):qd(b);1==d&&v&&v.$apply()}};a.moveColumn=function(b,c){if(b&&0!=a.callColumnPosChanging(b)){var d=a.columnList[0];0<=a.options.expandColIndex&&a.options.expandColIndex<a.columnList.length&&(d=a.columnList[a.options.expandColIndex]);var e=a.getColumnCurrentIndex(b),f=a.getColumnRealIndex(e),g=-1,h=a.getFullColumnList();switch(c){case "first":g=0;break;case "left":(e=ic(e-1,b[a.options.columnFields.fixed],!0))&&(g=
a.getColumnRealIndex(a.getColumnCurrentIndex(e)));break;case "right":(e=jc(e+1,b[a.options.columnFields.fixed],!0))&&(g=a.getColumnRealIndex(a.getColumnCurrentIndex(e)));break;case "last":g=h.length-1}0<=g&&g<h.length&&f!=g&&(f<g?"first"!=c&&"left"!=c||g--:f>g&&("last"!=c&&"right"!=c||g++),a.columnsObj.moveObject(f,g),a.updateColumnList(),d=a.getColumnCurrentIndex(d),d!=a.options.expandColIndex?(a.options.expandColIndex=d,a.updateLayout()):a.updateView(),a.callColumnPosChanged(A,a.hoverColumn))}};
a.moveRow=function(b,c,d,e){if(b){a.allowUpdate=!1;var f=-1;switch(d){case "first":f=0;break;case "at":f=e}if(Array.isArray(b)){e=[];for(var g=0;g<b.length;g++){for(var h=!1,l=a.getParent(b[g]);l;){if(0<=b.indexOf(l)){h=!0;break}l=a.getParent(l)}h||e.push(b[g])}if(0<e.length)if(b=a.getObjCurrentIndex(e[0]),g=a.getObjCurrentIndex(e[e.length-1]),b<=g)for(g=0;g<e.length;g++)Bc(e[g],c,f,d);else for(g=e.length-1;0<=g;g--)Bc(e[g],c,f,d)}else Bc(b,c,f,d);a.allowUpdate=!0;a.updateCurrentLayout();a.callChange()}};
var Bc=function(b,c,d,e){a.rowsObj.removeAt(b,-1,null,a.objIsRemoved)&&("first"==e||"last"==e||"at"==e?a.rowsObj.insertAt(b,d,c,a.rowIsAdded):"before"==e?a.rowsObj.insertByRef(b,c,!1,a.rowIsAdded):"after"==e&&a.rowsObj.insertByRef(b,c,!0,a.rowIsAdded))},Fa="none",S=!1,bc=-1,Fa="none",cc=0,dc=0;g.$watch(function(){return h[0].offsetWidth},function(b,c){100==H?a.updateLayout():b!=c&&(sa&&sa.css("width",h[0].clientWidth+"px"),ta&&ta.css("width",h[0].clientWidth+"px"),a.updateCurrentLayout())});var Ea=
null;g.$watch(function(){return h[0].offsetHeight},function(b,c){b!=c&&(Ea&&(d.cancel(Ea),Ea=null),Ea=d(function(){a.updateLayout();d.cancel(Ea);Ea=null},250))});a.isColumnWithFixedWidth=function(b){var c=a.columnList;return c&&0<=b&&b<c.length?c[b][a.options.columnFields.fixedWidth]?c[b][a.options.columnFields.fixedWidth]:!1:!1};a.setColumnResizingParams=function(b,c,d){0<=b&&b<a.columnList.length&&(bc=b,Fa=c,dc=d,cc=a.getColumnWidth(a.columnList[b]))};var rd=function(b){return b&&0!=b[a.options.columnFields.visible]?
!0:!1},ic=function(b,c,d){var e=null;c=void 0==c?"none":c;for(var f=b;0<=f;f--)if(!d||d&&rd(a.columnList[f]))if(b=a.columnList[f][a.options.columnFields.fixed],b=void 0==b?"none":b,b==c){e=a.columnList[f];break}return e},jc=function(b,c,d){var e=null;c=void 0==c?"none":c;for(var f=b;f<a.columnList.length;f++)if(!d||d&&rd(a.columnList[f]))if(b=a.columnList[f][a.options.columnFields.fixed],b=void 0==b?"none":b,b==c){e=a.columnList[f];break}return e},Sc=function(b,c){if(0<=b&&b<a.columnList.length){var d=
a.columnList[b];if(d)switch(columnFixedType=d[a.options.columnFields.fixed],c){case "left":if("right"!=columnFixedType){if(!ic(b-1,d[a.options.columnFields.fixed]))return!1}else if(!columnFixedType||"none"==columnFixedType)return 0<b;break;case "right":if("right"==columnFixedType&&!jc(b+1,d[a.options.columnFields.fixed]))return!1}}return!0};a.resizeColumn=function(b,c,d){0>c&&(c=0);var e;if(e=a.getHeaderElem(d))e=angular.element(e.find("tr")),a.resizeColumnCells(e,b,c,1,d);if(e=a.getRowElems(d)){var f=
{top:0,right:0,bottom:0,left:0},g=a.getElemFromColumn(a.columnList[b],a.columnList[b][a.options.columnFields.fixed]);g&&(g=a.getChildElement(g,"column-header-cell"))&&(f=m.getPadding(g[0]));for(g=0;g<e.length;g++)angular.element(e[g]),a.resizeColumnCells(angular.element(e[g]),b,c,0,d,!0,f)}if(e=a.getFooterElem(d))e=angular.element(e.find("tr")),a.resizeColumnCells(e,b,c,2,d);0<=b&&b<a.columnList.length&&a.callColumnSizeChanged(a.columnList[b])};a.resizeColumnCells=function(b,c,d,e,f,g,h){if(b){var l=
-1;g&&(l=a.getRowCurrentIndex(a.getRowFromElem(b)));b=0;0<=l&&(b=a.indentList[l]);switch(e){case 1:e=a.getElemFromColumnCell(c,f);break;case 2:e=a.getElemFromColumnCell(c,f,!0);break;default:e=a.getElemFromCell(l,c,f)}e&&0<e.children().length&&(e=e.children().eq(0))&&(h=h?h.left+b:b,f=d,0<=l&&c==a.options.expandColIndex&&(f-=h),f=0<=f?f:0,e.css("width",f+"px"),c==a.options.expandColIndex&&(0==f?e.css("padding-left",d+"px"):e.css("padding-left",h+"px")))}};var Gc=function(b){a.dropMark()},Hc=function(a){jb()},
Ic=function(b){a.removeDropMark();a.dragIcon&&angular.element(a.dragIcon).remove();a.cancelScrollTimer();a.dragDropStatus(!1)};angular.element(f).bind("dragenter",Gc);angular.element(f).bind("dragover",Hc);angular.element(f).bind("dragend",Ic);var ia=angular.element('<div class="iui-grid-column-reorder-mark"><span></span></div>'),X=angular.element('<div class="iui-grid-column-reorder-tooltip"><span></span></div>'),Oc=function(b){var c="initial";ba&&A&&(!a.hoverColumn||A==a.hoverColumn||a.hoverColumn&&
0==a.hoverColumn.allowDrop||a.hoverColumn&&A[a.options.columnFields.fixed]!=a.hoverColumn[a.options.columnFields.fixed])&&(c="not-allowed",b&&X&&X.css("display","none"));h.css("cursor",c);document.body.style.cursor=c},wc=function(b){return b?{min:m.isFieldAvailable(b[a.options.columnFields.minWidth],0),max:m.isFieldAvailable(b[a.options.columnFields.maxWidth],9999999)}:{min:0,max:9999999}},Kc=function(b){if(0===b.button&&0<=bc&&"none"!=Fa){var c=a.getMousePos(b),d=bc,e=a.columnList;if(0<=d&&d<e.length){var f=
cc+c.x-dc;"right"==e[d][a.options.columnFields.fixed]&&(f=cc-(c.x-dc));f=0<=f?f:0;c=wc(e[d]);f>=c.min&&f<=c.max&&(e[d][a.options.columnFields.width]=f,a.resizeColumn(d,f,e[d][a.options.columnFields.fixed]),a.updateViewSize(),a.updateScrollVisibility(),oc())}}P&&P.css("display","none");X&&X.css("display","none");Tb?Z||1!==b.which||(N[0].getBoundingClientRect(),b=a.getMousePos(b),E.scrollMousePos||(E.scrollMousePos=b),d=N[0].offsetLeft+(b.x-E.scrollMousePos.x),d<za?d=za:d+N[0].offsetWidth>Oa&&(d=Oa-
N[0].offsetWidth),N.css("left",d+"px"),E.scrollMousePos=b,a.prevScrollPos={x:a.scrollPos.x,y:a.scrollPos.y},a.scrollPos.x=!1!==a.options.rtl?parseInt((Oa-N[0].offsetLeft-N[0].offsetWidth)*Ya,10):parseInt((N[0].offsetLeft-za)*Ya,10),pc(),(Cc(a.scrollPos)||a.scrollPos.x!=a.prevScrollPos.x)&&a.callScrollPosChanged()):ra&&(Z||1!==b.which||(V[0].getBoundingClientRect(),b=a.getMousePos(b),E.scrollMousePos||(E.scrollMousePos=b),d=V[0].offsetTop+(b.y-E.scrollMousePos.y),d<Pa?d=Pa:d+V[0].offsetHeight>qb&&
(d=qb-V[0].offsetHeight),V.css("top",d+"px"),E.scrollMousePos=b,Wb=d-Pa,a.prevScrollPos={x:a.scrollPos.x,y:a.scrollPos.y},a.scrollPos.y=Math.floor(Wb*Xb*U),(Cc(a.scrollPos)||a.scrollPos.y!=a.prevScrollPos.y)&&a.callScrollPosChanged(),newIndex=0<U?Math.floor(a.scrollPos.y/U):0,newIndex+H-1>a.currentList.length&&(newIndex=a.currentList.length-H+1,newIndex+=5),0>newIndex&&(newIndex=0),newIndex!==D&&(D=newIndex,a.updateView(!0))))},Lc=function(b){a.removeDropDownList();a.closeEditor(e);a.closeFilterWindow();
yb()},Mc=function(b){Oc(!0);P&&P.remove();1==b.which&&Qa&&Y&&(b=a.getElemFromGroup(Y))&&b.css("display","inline-block");X&&X.remove();Qa=ba=!1;Y=null;bc=-1;Fa="none";dc=cc=0;S=!1;h.css("cursor","default");a.dropMark();ra&&a.updateView();jb();E.scrollMousePos=null;ra=Tb=!1;h.css("cursor","default");document.body.style.cursor="default"},Jc=function(b){switch(b.keyCode){case 16:a.multiSelection(!1);break;case 17:a.multiSelection(!1);break;default:b.ctrlKey||b.metaKey||a.multiSelection(!1),b.shiftKey||
a.multiSelection(!1)}};angular.element(f).bind("mousemove",Kc);angular.element(f).bind("mousedown",Lc);angular.element(f).bind("mouseup",Mc);angular.element(f).bind("keyup",Jc);var Dc=!1,xb=0,ec=null,sd=.5;a.isScrollBarVisible=function(a){switch(a){case "horizontal":return I;case "vertical":return K}return I&&K};a.prevScrollPos={x:0,y:0};a.scrollPos={x:0,y:0};a.getMaxScrollPos=function(){return L};a.getScrollPos=function(){return a.scrollPos};a.setScrollPos=function(b,c){if(!Z&&b){var d=!0;0>b.x&&
(b.x=0,d=!1);b.x>L.x&&(b.x=L.x,d=!1);0>b.y&&(b.y=0,d=!1);b.y>L.y&&(b.y=L.y,d=!1);a.scrollPos=b;Wb=Math.floor(a.scrollPos.y/(U*Xb));var e,f=Pa+Wb;e=!1!==a.options.rtl?Math.floor(a.scrollPos.x/Ya)-(Oa-N[0].offsetWidth-za):Math.floor(a.scrollPos.x/Ya)+za;I&&N&&N.css("left",e+"px");K&&V&&V.css("top",f+"px");pc();od(!0,c);d&&a.callScrollPosChanged()}};var Cc=function(a){return 0<a.x&&a.x<L.x||0<a.y&&a.y<L.y},Qb=function(b,c,d){Dc||(a.updateFocus(),xb=0,Dc=!0,ec=l(function(){var d=c,e=a.getScrollPos();
d||(0===xb&&(xb=5),xb+=5+Xb,sd+=.5,d=xb+=Math.floor(sd));e.y=b?e.y+d:e.y-d;a.setScrollPos(e);(0>=e.y||a.getScrollPos().y<e.y)&&jb()},d?d:100))},jb=function(){ec&&(l.cancel(ec),ec=null);Dc=!1;xb=0};a.cancelScrollTimer=function(){jb()};a.scrollTo=function(b,c){if(b){var d=a.getRowCurrentIndex(b);if(a.isRowIndexInRange(d)){var e;e=d;switch(c){case "center":e=Math.floor(la/2)-1;e=d>e?d-e:0;break;case "bottom":e=la-2,a.options.showHeader&&e--,a.options.showFooter&&e--,e=d>e?d-e:0}a.setScrollPos({x:a.scrollPos.x,
y:e*U})}}};var pc=function(){var b=a.scrollPos.x;0>b&&(b=0);b>L.x&&(b=L.x);b*=-1;ja&&ja.css("left",b+Q+"px");wa&&wa.css("left",b+Q+"px");ka&&ka.css("left",b+Q+"px")},od=function(b,c){if(!(0==b&&0>=U)){newIndex=0<U?Math.floor(a.scrollPos.y/U):0;a.scrollPos.y==L.y&&newIndex--;if(a.currentList.length>=H&&newIndex+H-1>a.currentList.length){newIndex=a.currentList.length-H+1;var d=a.getRowElems();d||(d=a.getRowElems("left"));d||(d=a.getRowElems("right"));d&&0<d.length&&(d=angular.element(d[d.length-1]),
d[0].offsetTop+d[0].offsetHeight>h[0].clientHeight-(B+O)&&newIndex++)}0>newIndex&&(newIndex=0);newIndex!=D&&(D=newIndex,0!=b&&a.updateView(c))}};h.bind("scroll",function(a){h[0].scrollTop=0;h[0].scrollLeft=0});var td=function(b,c){if(K){document.activeElement&&document.activeElement.blur();a.removeDropDownList();a.closeEditor(e);a.closeFilterWindow();yb();var d=a.hoverRow;a.hoverRow=null;a.refresh(d);d=Math.floor(h[0].clientHeight/4);a.prevScrollPos={x:a.scrollPos.x,y:a.scrollPos.y};a.setScrollPos({x:a.scrollPos.x,
y:a.scrollPos.y+d*c*-1},!0);Cc(a.scrollPos)||a.scrollPos.y==a.prevScrollPos.y||a.callScrollPosChanged()}};h.bind("mousewheel",function(b){b.preventDefault();if(!Z&&a.options.enabled){var c=0;b.wheelDelta?c=Math.max(-1,Math.min(1,b.wheelDelta||-b.detail)):b.originalEvent&&(c=Math.max(-1,Math.min(1,b.originalEvent.wheelDelta||-b.originalEvent.detail)));td(b,c)}});h.bind("DOMMouseScroll",function(b){b.preventDefault();if(!Z&&a.options.enabled){var c=0;b.detail?c=Math.max(-1,Math.min(1,-b.detail)):b.originalEvent&&
(c=Math.max(-1,Math.min(1,-b.originalEvent.detail)));td(b,c)}});var Jb={x:0,y:0},Ta={x:0,y:0};h.bind("touchstart",function(b){b.preventDefault();a.options.enabled&&(b=a.getTouchData(b))&&0<b.length&&(Jb={x:b[0].pageX,y:b[0].pageY})});h.bind("touchend",function(b){if(a.options.enabled){(b=a.getTouchData(b))&&0<b.length&&(Ta={x:b[0].pageX,y:b[0].pageY});var c=Ta.x-Jb.x,d=Ta.y-Jb.y;(20<Math.abs(c)||20<Math.abs(d))&&document.activeElement&&document.activeElement.blur();var e=!1,f=!1,g=Jb,h=a.scrollPos.x,
m=a.scrollPos.y,q=l(function(){var b=a.scrollPos;-20>c?(g.x-=10,g.x>Ta.x?b.x+=10:(b.x=h-c,e=!0)):20<c?(g.x+=10,g.x<Ta.x?b.x-=10:(b.x=h-c,e=!0)):e=!0;-20>d?(g.y-=10,g.y>Ta.y?b.y+=10:(b.y=m-d,f=!0)):20<d?(g.y+=10,g.y<Ta.y?b.y-=10:(b.y=m-d,f=!0)):f=!0;a.setScrollPos(b);e&&f&&l.cancel(q)},5);Jb=Ta}});E=this;this.crpar=function(){return["si","tri","ver","on","al "]};this.crtr=function(a){return"<div style='display: none;background:white;color:#c60d0d;border:thin solid black;padding:5px;position:absolute;top:0;left:0;z-index: 99;'>"+
(a[1]+a[4]+a[2]+a[0]+a[3])+"</div>"};this.tpar=this.crpar();this.$tw=angular.element(this.crtr(E.tpar));this.tmp=300;this.twp=200*this.tmp;this.trActive=!1;this.trCount=0;this.trlTime=this.trId=null;this.trShowCount=0;this.animTr=function(){this.trCount++;3>this.trShowCount?(this.trCount=1,this.$tw.css("display","block"),this.$tw.css("top",h[0].scrollTop+"px"),this.$tw.css("left",h[0].scrollLeft+"px"),this.trShowCount++):(0===this.trCount%49&&(this.trShowCount=0),this.$tw.css("display","none"),this.$tw.css("top",
h[0].scrollTop+"px"),this.$tw.css("left",h[0].scrollLeft+"px"))};this.s1t=function(a){E.s3t();this.trlTime=d(function(){E.trActive||(E.trCount=0,E.trActive=!0,E.trId=l(function(){E.animTr()},1E3))},a)};this.s3t=function(){this.trId&&(l.cancel(this.trId),this.trId=null);this.trlTime&&(d.cancel(this.trlTime),this.trlTime=null);this.trActive=!1};this.s2t=function(){this.s3t();this.trActive=!1;this.$tw.remove()};h.append(this.$tw);this.s1t(this.twp);angular.isDefined(g.options)?a.updateOptions(g.options):
(0==g.allowAnimation&&(a.options.allowAnimation=g.allowAnimation),0==g.allowCellFocus&&(a.options.allowCellFocus=g.allowCellFocus),1==g.allowColumnReorder&&(a.options.allowColumnReorder=g.allowColumnReorder),angular.isDefined(g.controlStyle)&&a.updateControlStyle(g.controlStyle),1==g.allowDrag&&(a.options.allowDrag=g.allowDrag),0==g.allowDrop&&(a.options.allowDrop=g.allowDrop),1==g.allowFilter&&(a.options.allowFilter=g.allowFilter),0==g.allowFocus&&(a.options.allowFocus=g.allowFocus),0==g.autoExpand&&
(a.options.autoExpand=g.autoExpand),angular.isDefined(g.animationSpeed)&&200!==g.animationSpeed&&(a.options.animationSpeed=g.animationSpeed),angular.isDefined(g.editorSettings)&&a.updateEditorSettings(g.editorSettings),0==g.enabled&&(a.options.enabled=g.enabled),angular.isDefined(g.expandingColumnIndex)&&(a.options.expandColIndex=g.expandingColumnIndex),angular.isDefined(g.fields)&&(a.updateDataFields(g.fields),a.updateData()),1==g.fillSpace&&(a.options.fillSpace=g.fillSpace),angular.isDefined(g.gridLines)&&
(a.options.gridLines=g.gridLines),angular.isDefined(g.grouping)&&a.updateGrouping(g.grouping),1==g.hoverSelection&&(a.options.hoverSelection=g.hoverSelection),angular.isDefined(g.indent)&&(a.options.indent=g.indent),angular.isDefined(g.labelEdit)&&(a.options.labelEdit=g.labelEdit),angular.isDefined(g.paging)&&a.updatePaging(g.paging),angular.isDefined(g.rowHeight)&&(a.options.rowHeight=g.rowHeight),angular.isDefined(g.rowIcon)&&(a.options.rowIcon=g.rowIcon),1==g.rtl&&(a.options.rtl=g.rtl),angular.isDefined(g.selectedIndex)&&
(a.options.selectedIndex=g.selectedIndex),angular.isDefined(g.selectedRow)&&(a.options.selectedRow=g.selectedRow),angular.isDefined(g.selectionMode)&&(a.options.selectionMode=g.selectionMode),0==g.showFooter&&(a.options.showFooter=g.showFooter),0==g.showHeader&&(a.options.showHeader=g.showHeader),0==g.showIcons&&(a.options.showIcons=g.showIcons),angular.isDefined(g.sorting)&&(a.options.sorting=g.sorting));a.updateLayout()}}}]);